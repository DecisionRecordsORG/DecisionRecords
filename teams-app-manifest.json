{
    "$schema": "https://developer.microsoft.com/json-schemas/teams/v1.24/MicrosoftTeams.schema.json",
    "manifestVersion": "1.24",
    "version": "1.0.0",
    "id": "a140ddfe-c8cc-4378-9d43-936d619e4423",
    "developer": {
        "name": "Decision Records",
        "websiteUrl": "https://decisionrecords.org",
        "privacyUrl": "https://decisionrecords.org/privacy",
        "termsOfUseUrl": "https://decisionrecords.org/terms"
    },
    "name": {
        "short": "Decision Records",
        "full": "Decision Records - Architecture Decision Management"
    },
    "description": {
        "short": "Capture and manage architecture decisions in Teams",
        "full": "Decision Records integrates your team's decision-making process with Microsoft Teams. Create, search, and manage Architecture Decision Records (ADRs) directly from where your team collaborates. Track decisions from proposed to accepted, and keep your entire team informed with automatic notifications."
    },
    "icons": {
        "color": "color.png",
        "outline": "outline.png"
    },
    "accentColor": "#1a1a2e",
    "bots": [
        {
            "botId": "a140ddfe-c8cc-4378-9d43-936d619e4423",
            "scopes": ["personal", "team", "groupChat"],
            "supportsFiles": false,
            "isNotificationOnly": false,
            "commandLists": [
                {
                    "scopes": ["personal", "team", "groupChat"],
                    "commands": [
                        {
                            "title": "create",
                            "description": "Create a new architecture decision"
                        },
                        {
                            "title": "list",
                            "description": "List recent decisions"
                        },
                        {
                            "title": "list [status]",
                            "description": "List decisions by status (proposed, accepted, archived, superseded)"
                        },
                        {
                            "title": "search [query]",
                            "description": "Search for decisions"
                        },
                        {
                            "title": "view [id]",
                            "description": "View a specific decision by ID"
                        },
                        {
                            "title": "help",
                            "description": "Show available commands"
                        }
                    ]
                }
            ]
        }
    ],
    "composeExtensions": [
        {
            "botId": "a140ddfe-c8cc-4378-9d43-936d619e4423",
            "commands": [
                {
                    "id": "createDecision",
                    "type": "action",
                    "title": "Create Decision",
                    "description": "Create a new architecture decision record",
                    "initialRun": false,
                    "fetchTask": true,
                    "context": ["compose", "commandBox", "message"],
                    "parameters": []
                },
                {
                    "id": "searchDecisions",
                    "type": "query",
                    "title": "Search Decisions",
                    "description": "Search for architecture decisions",
                    "initialRun": true,
                    "parameters": [
                        {
                            "name": "query",
                            "title": "Search query",
                            "description": "Enter keywords to search",
                            "inputType": "text"
                        }
                    ]
                }
            ],
            "messageHandlers": [
                {
                    "type": "link",
                    "value": {
                        "domains": ["decisionrecords.org"]
                    }
                }
            ]
        }
    ],
    "staticTabs": [
        {
            "entityId": "about",
            "name": "About",
            "contentUrl": "https://decisionrecords.org/teams/tab/about?context={context}",
            "websiteUrl": "https://decisionrecords.org",
            "scopes": ["personal"]
        }
    ],
    "configurableTabs": [
        {
            "configurationUrl": "https://decisionrecords.org/teams/tab/config",
            "canUpdateConfiguration": true,
            "scopes": ["team", "groupChat"],
            "context": ["channelTab", "privateChatTab", "meetingChatTab", "meetingDetailsTab"]
        }
    ],
    "permissions": [
        "identity",
        "messageTeamMembers"
    ],
    "validDomains": [
        "decisionrecords.org",
        "*.decisionrecords.org"
    ],
    "webApplicationInfo": {
        "id": "a140ddfe-c8cc-4378-9d43-936d619e4423",
        "resource": "api://decisionrecords.org/a140ddfe-c8cc-4378-9d43-936d619e4423"
    },
    "authorization": {
        "permissions": {
            "resourceSpecific": [
                {
                    "name": "ChannelMessage.Read.Group",
                    "type": "Application"
                },
                {
                    "name": "TeamSettings.Read.Group",
                    "type": "Application"
                }
            ]
        }
    }
}
