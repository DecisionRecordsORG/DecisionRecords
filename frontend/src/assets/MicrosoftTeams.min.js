!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("microsoftTeams",[],t):"object"==typeof exports?exports.microsoftTeams=t():e.microsoftTeams=t()}("undefined"!=typeof self?self:this,(()=>(()=>{var e={933:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=s(e),a=i[0],u=i[1],l=new o(c(e,a,u)),d=0,f=u>0?a-4:a;for(n=0;n<f;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;2===u&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[d++]=255&t);1===u&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t);return l},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],a=16383,s=0,c=r-o;s<c;s+=a)i.push(l(e,s,s+a>c?c:s+a));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=i[a],r[i.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){return 3*(t+n)/4-n}function u(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function l(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(u(r));return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},815:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(530)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},530:(e,t,n)=>{e.exports=function(e){function t(e){let n,o,i,a=null;function s(...e){if(!s.enabled)return;const r=s,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=t.formatters[o];if("function"==typeof i){const t=e[a];n=i.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(821),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},821:e=>{var t=1e3,n=60*t,r=60*n,o=24*r,i=7*o;function a(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return s*i;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function s(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=r?Math.round(e/r)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}function c(e){var i=Math.abs(e);return i>=o?u(e,i,o,"day"):i>=r?u(e,i,r,"hour"):i>=n?u(e,i,n,"minute"):i>=t?u(e,i,t,"second"):e+" ms"}function u(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return a(e);if("number"===n&&isFinite(e))return t.long?c(e):s(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"==typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"==typeof r.then)return r}var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>r[e]));return a.default=()=>r,n.d(i,a),i}})(),(()=>{n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})();var r={};return(()=>{"use strict";n.r(r),n.d(r,{ActionObjectType:()=>De,AppId:()=>ro,ChannelType:()=>hn,ChildAppWindow:()=>Rm,DialogDimension:()=>gn,EduType:()=>We,EmailAddress:()=>Bg,ErrorCode:()=>Le,FileOpenPreference:()=>Ne,FrameContexts:()=>ln,HostClientType:()=>cn,HostName:()=>un,LiveShareHost:()=>ry,NotificationTypes:()=>tu,ParentAppWindow:()=>Fm,RenderingSurfaces:()=>dn,SecondaryM365ContentIdName:()=>Ue,TaskModuleDimension:()=>gn,TeamType:()=>fn,UUID:()=>Gn,UserAuthenticationState:()=>sl,UserSettingTypes:()=>ru,UserTeamRole:()=>pn,ValidatedSafeString:()=>no,ViewerActionTypes:()=>nu,activateChildProxyingCommunication:()=>Pr,app:()=>i,appEntity:()=>W,appInitialization:()=>Oe,appInstallDialog:()=>ee,appPerformanceMetrics:()=>Y,authentication:()=>X,barCode:()=>ne,calendar:()=>pe,call:()=>Te,chat:()=>re,clipboard:()=>oe,conversations:()=>b,copilot:()=>O,dialog:()=>f,enablePrintCapability:()=>hC,executeDeepLink:()=>kC,externalAppAuthentication:()=>R,externalAppAuthenticationForCEA:()=>F,externalAppCardActions:()=>k,externalAppCardActionsForCEA:()=>M,externalAppCardActionsForDA:()=>x,externalAppCommands:()=>N,files:()=>D,geoLocation:()=>se,getAdaptiveCardSchemaVersion:()=>Tm,getContext:()=>vC,getCurrentFeatureFlagsState:()=>Rr,getMruTabInstances:()=>RC,getTabInstances:()=>OC,hostEntity:()=>K,initialize:()=>gC,initializeWithFrameContext:()=>xC,liveShare:()=>Me,location:()=>ue,logs:()=>S,mail:()=>he,marketplace:()=>xe,media:()=>te,meeting:()=>de,meetingRoom:()=>U,menus:()=>p,messageChannels:()=>L,monetization:()=>fe,navigateBack:()=>HC,navigateCrossDomain:()=>LC,navigateToTab:()=>UC,nestedAppAuth:()=>ie,nestedAppAuthBridge:()=>H,notifications:()=>_,openFilePreview:()=>lu,otherAppStateChange:()=>V,overwriteFeatureFlagsState:()=>kr,pages:()=>y,people:()=>ve,print:()=>mC,profile:()=>we,registerAppButtonClickHandler:()=>yC,registerAppButtonHoverEnterHandler:()=>SC,registerAppButtonHoverLeaveHandler:()=>bC,registerBackButtonHandler:()=>AC,registerBeforeUnloadHandler:()=>IC,registerChangeSettingsHandler:()=>TC,registerCustomHandler:()=>cu,registerFocusEnterHandler:()=>PC,registerFullScreenHandler:()=>CC,registerOnLoadHandler:()=>EC,registerOnThemeChangeHandler:()=>wC,registerUserSettingsChangeHandler:()=>uu,remoteCamera:()=>B,returnFocus:()=>DC,search:()=>Ce,secondaryBrowser:()=>ce,sendCustomEvent:()=>su,sendCustomMessage:()=>au,setFeatureFlagsState:()=>Fr,setFrameContext:()=>MC,settings:()=>Fe,shareDeepLink:()=>FC,sharing:()=>Se,shortcutRelay:()=>ze,sidePanelInterfaces:()=>I,stageView:()=>Ae,store:()=>Q,tasks:()=>ke,teams:()=>q,teamsCore:()=>me,thirdPartyCloudStorage:()=>Re,uploadCustomApp:()=>iu,version:()=>Er,videoEffects:()=>$,videoEffectsEx:()=>G,visualMedia:()=>Ie,webStorage:()=>Pe,widgetHosting:()=>Z});var e={};n.r(e),n.d(e,{_clearTelemetryPort:()=>fo,getTelemetryPort:()=>uo,isSupported:()=>lo});var t={};n.r(t),n.d(t,{_clearDataLayerPort:()=>Co,getDataLayerPort:()=>vo,isSupported:()=>wo});var o={};n.r(o),n.d(o,{registerBeforeSuspendOrTerminateHandler:()=>yo,registerOnResumeHandler:()=>So});var i={};n.r(i),n.d(i,{ExpectedFailureReason:()=>Po,FailedReason:()=>Io,Messages:()=>Eo,_initialize:()=>Fo,_uninitialize:()=>ko,getContext:()=>Mo,getFrameContext:()=>Oo,initialize:()=>Ro,isInitialized:()=>To,lifecycle:()=>o,notifyAppLoaded:()=>xo,notifyExpectedFailure:()=>Uo,notifyFailure:()=>Do,notifySuccess:()=>No,openLink:()=>Vo,registerHostToAppPerformanceMetricsHandler:()=>_o,registerOnContextChangeHandler:()=>Ho,registerOnThemeChangeHandler:()=>Lo});var a={};n.r(a),n.d(a,{isSupported:()=>jo,resize:()=>Wo});var s={};n.r(s),n.d(s,{isSupported:()=>qo,open:()=>zo});var c={};n.r(c),n.d(c,{isSupported:()=>Ko,registerOnMessageFromParent:()=>Jo,sendMessageToDialog:()=>Go,sendMessageToParentFromDialog:()=>$o});var u={};n.r(u),n.d(u,{bot:()=>s,getDialogInfoFromBotUrlDialogInfo:()=>ei,getDialogInfoFromUrlDialogInfo:()=>Yo,isSupported:()=>Xo,open:()=>Qo,parentCommunication:()=>c,submit:()=>Zo});var l={};n.r(l),n.d(l,{isSupported:()=>fi,open:()=>di});var d={};n.r(d),n.d(d,{bot:()=>l,isSupported:()=>gi,open:()=>pi});var f={};n.r(f),n.d(f,{adaptiveCard:()=>d,initialize:()=>hi,isSupported:()=>mi,update:()=>a,url:()=>u});var p={};n.r(p),n.d(p,{DisplayMode:()=>wi,MenuItem:()=>yi,MenuListType:()=>Ci,initialize:()=>Pi,isSupported:()=>xi,setNavBarMenu:()=>Ri,setUpViews:()=>Ti,showActionMenu:()=>ki});var g={};n.r(g),n.d(g,{initialize:()=>Ni,isSupported:()=>$i,registerChangeConfigHandler:()=>Wi,registerOnRemoveHandler:()=>_i,registerOnRemoveHandlerHelper:()=>Vi,registerOnSaveHandler:()=>Li,registerOnSaveHandlerHelper:()=>Hi,setConfig:()=>Ui,setValidityState:()=>Di});var h={};n.r(h),n.d(h,{isSupported:()=>Ea,onClick:()=>Sa,onHoverEnter:()=>ba,onHoverLeave:()=>Aa});var m={};n.r(m),n.d(m,{_initialize:()=>Ia,isSupported:()=>Ra,navigateBack:()=>Pa,registerBackButtonHandler:()=>Ta,registerBackButtonHandlerHelper:()=>Oa});var v={};n.r(v),n.d(v,{isSupported:()=>Ma,navigateTo:()=>Fa,navigateToDefaultPage:()=>ka});var w={};n.r(w),n.d(w,{enterFullscreen:()=>xa,exitFullscreen:()=>Na,isSupported:()=>Da});var C={};n.r(C),n.d(C,{getMruTabInstances:()=>Ha,getTabInstances:()=>La,isSupported:()=>_a,navigateToTab:()=>Ua});var y={};n.r(y),n.d(y,{EnterFocusType:()=>Va,ReturnFocusType:()=>Ba,appButton:()=>h,backStack:()=>m,config:()=>g,currentApp:()=>v,fullTrust:()=>w,getConfig:()=>$a,initializeWithFrameContext:()=>qa,isSupported:()=>Za,navigateCrossDomain:()=>Ga,navigateToApp:()=>Ja,registerFocusEnterHandler:()=>ja,registerFullScreenHandler:()=>Qa,returnFocus:()=>Wa,setCurrentFrame:()=>za,shareDeepLink:()=>Ka,tabs:()=>C});var S={};n.r(S),n.d(S,{isSupported:()=>eu,registerGetLogHandler:()=>Yc});var b={};n.r(b),n.d(b,{closeConversation:()=>pu,getChatMembers:()=>gu,isSupported:()=>hu,openConversation:()=>fu});var A={};n.r(A),n.d(A,{isSupported:()=>Cu,sendCustomTelemetryData:()=>yu});var E={};n.r(E),n.d(E,{getEligibilityInfo:()=>Iu,isSupported:()=>Eu});var I={};n.r(I),n.d(I,{ContentItemType:()=>Tu,CopilotMode:()=>ku,MediaSelectionType:()=>Ou,SidePanelErrorCode:()=>Du,SidePanelErrorImpl:()=>Uu,TeamsContextType:()=>xu,TeamsDimensionName:()=>Fu,TeamsSessionType:()=>Ru,TranscriptState:()=>Mu,UserConsent:()=>Nu});var P={};n.r(P),n.d(P,{copilotSidePanelNotSupportedOnPlatformError:()=>zu,getContent:()=>Bu,isResponseAReportableError:()=>Vu,isSupported:()=>_u,preCheckUserConsent:()=>Wu,registerUserActionContentSelect:()=>ju});var T={};n.r(T),n.d(T,{closeSidePanel:()=>Xu,isSupported:()=>Zu});var O={};n.r(O),n.d(O,{customTelemetry:()=>A,eligibility:()=>E,sidePanel:()=>P,view:()=>T});var R={};n.r(R),n.d(R,{ActionExecuteInvokeRequestType:()=>rl,ActionExecuteResponseHandler:()=>cl,InvokeErrorCode:()=>al,InvokeResponseType:()=>il,OriginalRequestType:()=>ol,SerializableActionExecuteInvokeRequest:()=>tl,SerializableConnectorParameters:()=>wl,UserAuthenticationState:()=>sl,authenticateAndResendRequest:()=>pl,authenticateWithConnector:()=>Cl,authenticateWithOauth2:()=>ml,authenticateWithPowerPlatformConnectorPlugins:()=>vl,authenticateWithSSO:()=>gl,authenticateWithSSOAndResendRequest:()=>hl,disconnectConnector:()=>bl,getUserAuthenticationStateForConnector:()=>Sl,isActionExecuteResponse:()=>nl,isInvokeError:()=>ul,isSupported:()=>Al,validateActionExecuteInvokeRequest:()=>dl});var F={};n.r(F),n.d(F,{authenticateAndResendRequest:()=>Ol,authenticateWithOauth:()=>Tl,authenticateWithSSO:()=>Pl,authenticateWithSSOAndResendRequest:()=>Rl,isSupported:()=>Fl,validateInput:()=>kl});var k={};n.r(k),n.d(k,{ActionOpenUrlErrorCode:()=>Nl,ActionOpenUrlType:()=>xl,isSupported:()=>Ll,processActionOpenUrl:()=>Ul,processActionSubmit:()=>Dl});var M={};n.r(M),n.d(M,{isSupported:()=>Wl,processActionOpenUrl:()=>Vl,processActionSubmit:()=>Bl});var x={};n.r(x),n.d(x,{SerializableActionOpenUrlDialogInfo:()=>Ql,isSupported:()=>Jl,processActionOpenUrlDialog:()=>Gl});var N={};n.r(N),n.d(N,{isSupported:()=>ed,processActionCommand:()=>Yl});var D={};n.r(D),n.d(D,{CloudStorageProvider:()=>nd,CloudStorageProviderFileAction:()=>sd,CloudStorageProviderType:()=>rd,DocumentLibraryAccessType:()=>id,FileDownloadStatus:()=>ad,SpecialDocumentLibraryType:()=>od,addCloudStorageFolder:()=>ud,addCloudStorageProvider:()=>vd,addCloudStorageProviderFile:()=>Cd,copyMoveFiles:()=>gd,deleteCloudStorageFolder:()=>ld,deleteCloudStorageProviderFile:()=>Sd,downloadCloudStorageProviderFile:()=>bd,getCloudStorageFolderContents:()=>dd,getCloudStorageFolders:()=>cd,getExternalProviders:()=>pd,getFileDownloads:()=>hd,openCloudStorageFile:()=>fd,openDownloadFolder:()=>md,registerCloudStorageProviderContentChangeHandler:()=>Id,registerCloudStorageProviderListChangeHandler:()=>Ed,removeCloudStorageProvider:()=>wd,renameCloudStorageProviderFile:()=>yd,uploadCloudStorageProviderFile:()=>Ad});var U={};n.r(U),n.d(U,{getPairedMeetingRoomInfo:()=>Od,isSupported:()=>Md,registerMeetingRoomCapabilitiesUpdateHandler:()=>Fd,registerMeetingRoomStatesUpdateHandler:()=>kd,sendCommandToPairedMeetingRoom:()=>Rd});var L={};n.r(L),n.d(L,{dataLayer:()=>t,isSupported:()=>xd,telemetry:()=>e});var H={};n.r(H),n.d(H,{initialize:()=>Hd,version:()=>Nd});var _={};n.r(_),n.d(_,{isSupported:()=>Gd,showNotification:()=>$d});var V={};n.r(V),n.d(V,{isSupported:()=>Xd,notifyInstallCompleted:()=>Zd,registerAppInstallationHandler:()=>Kd,unregisterAppInstallationHandler:()=>Qd});var B={};n.r(B),n.d(B,{ControlCommand:()=>ef,ErrorReason:()=>tf,SessionTerminatedReason:()=>nf,getCapableParticipants:()=>rf,isSupported:()=>ff,registerOnCapableParticipantsChangeHandler:()=>cf,registerOnDeviceStateChangeHandler:()=>lf,registerOnErrorHandler:()=>uf,registerOnSessionStatusChangeHandler:()=>df,requestControl:()=>of,sendControlCommand:()=>af,terminateSession:()=>sf});var W={};n.r(W),n.d(W,{isSupported:()=>hf,selectAppEntity:()=>gf});var j={};n.r(j),n.d(j,{getUserJoinedTeams:()=>vf,isSupported:()=>wf});var z={};n.r(z),n.d(z,{getConfigSetting:()=>Sf,isSupported:()=>bf,joinedTeams:()=>j});var q={};n.r(q),n.d(q,{ChannelType:()=>Ef,fullTrust:()=>z,getTeamChannels:()=>If,isSupported:()=>Tf,refreshSiteUrl:()=>Pf});var $={};n.r($),n.d($,{EffectChangeType:()=>Lf,EffectFailureReason:()=>Hf,VideoFrameFormat:()=>Uf,isSupported:()=>zf,notifySelectedVideoEffectChanged:()=>Vf,registerForVideoEffect:()=>Bf,registerForVideoFrame:()=>_f});var G={};n.r(G),n.d(G,{ErrorLevel:()=>gp,frameProcessingTimeoutInMs:()=>fp,isSupported:()=>bp,notifyFatalError:()=>Ip,notifySelectedVideoEffectChanged:()=>Cp,registerForVideoEffect:()=>yp,registerForVideoFrame:()=>hp,updatePersonalizedEffects:()=>Sp});var J={};n.r(J),n.d(J,{addAndConfigure:()=>xp,getAll:()=>Np,isSupported:()=>Hp,reconfigure:()=>Dp,remove:()=>Lp,rename:()=>Up});var K={};n.r(K),n.d(K,{AppTypes:()=>Bp,isSupported:()=>Wp,tab:()=>J});var Q={};n.r(Q),n.d(Q,{isSupported:()=>Xp,openAppDetail:()=>Kp,openFullStore:()=>Jp,openInContextStore:()=>Qp,openSpecificStore:()=>Zp});var Z={};n.r(Z),n.d(Z,{callTool:()=>ig,contentSizeChanged:()=>lg,isSupported:()=>og,notifyIntrinsicHeight:()=>ug,openExternal:()=>fg,registerModalCloseHandler:()=>pg,requestDisplayMode:()=>sg,requestModal:()=>cg,sendFollowUpMessage:()=>ag,setWidgetState:()=>dg});var X={};n.r(X),n.d(X,{DataResidency:()=>Lg,authenticate:()=>Rg,getAuthToken:()=>kg,getUser:()=>xg,notifyFailure:()=>Ug,notifySuccess:()=>Dg,registerAuthenticationHandlers:()=>Og});var Y={};n.r(Y),n.d(Y,{isSupported:()=>Hg,registerHostMemoryMetricsHandler:()=>_g});var ee={};n.r(ee),n.d(ee,{isSupported:()=>ch,openAppInstallDialog:()=>sh});var te={};n.r(te),n.d(te,{CameraStartMode:()=>ph,File:()=>wh,FileFormat:()=>dh,ImageOutputFormats:()=>vh,ImageUriType:()=>mh,Media:()=>Ah,MediaControllerEvent:()=>fh,MediaType:()=>hh,Source:()=>gh,VideoController:()=>Ih,captureImage:()=>Ch,hasPermission:()=>yh,requestPermission:()=>Sh,scanBarCode:()=>Oh,selectMedia:()=>Ph,viewImages:()=>Th});var ne={};n.r(ne),n.d(ne,{hasPermission:()=>jh,isSupported:()=>qh,requestPermission:()=>zh,scanBarCode:()=>Wh});var re={};n.r(re),n.d(re,{isSupported:()=>Qh,openChat:()=>Gh,openGroupChat:()=>Kh});var oe={};n.r(oe),n.d(oe,{isSupported:()=>tm,read:()=>em,write:()=>Yh});var ie={};n.r(ie),n.d(ie,{addNAATrustedOrigins:()=>pm,canParentManageNAATrustedOrigins:()=>cm,deleteNAATrustedOrigins:()=>gm,getParentOrigin:()=>sm,isDeeplyNestedAuthSupported:()=>um,isNAAChannelRecommended:()=>am});var ae={};n.r(ae),n.d(ae,{chooseLocation:()=>Cm,isSupported:()=>Sm,showLocation:()=>ym});var se={};n.r(se),n.d(se,{getCurrentLocation:()=>Am,hasPermission:()=>Em,isSupported:()=>Pm,map:()=>ae,requestPermission:()=>Im});var ce={};n.r(ce),n.d(ce,{isSupported:()=>xm,open:()=>Mm});var ue={};n.r(ue),n.d(ue,{getLocation:()=>Dm,isSupported:()=>Lm,showLocation:()=>Um});var le={};n.r(le),n.d(le,{setOptions:()=>_m});var de={};n.r(de),n.d(de,{CallType:()=>qm,EventActionSource:()=>Gm,MeetingReactionType:()=>jm,MeetingType:()=>zm,SharingProtocol:()=>$m,appShareButton:()=>le,getAppContentStageSharingCapabilities:()=>ov,getAppContentStageSharingState:()=>av,getAuthenticationTokenForAnonymousUser:()=>Xm,getIncomingClientAudioState:()=>Jm,getLiveStreamState:()=>Ym,getMeetingDetails:()=>Qm,getMeetingDetailsVerbose:()=>Zm,joinMeeting:()=>lv,registerLiveStreamChangedHandler:()=>nv,registerMeetingReactionReceivedHandler:()=>uv,registerRaiseHandStateChangedHandler:()=>cv,registerSpeakingStateChangeHandler:()=>sv,requestAppAudioHandling:()=>dv,requestStartLiveStreaming:()=>ev,requestStopLiveStreaming:()=>tv,shareAppContentToStage:()=>rv,stopSharingAppContentToStage:()=>iv,toggleIncomingClientAudio:()=>Km,updateMicState:()=>gv});var fe={};n.r(fe),n.d(fe,{isSupported:()=>Cv,openPurchaseExperience:()=>wv});var pe={};n.r(pe),n.d(pe,{composeMeeting:()=>bv,isSupported:()=>Av,openCalendarItem:()=>Sv});var ge={};n.r(ge),n.d(ge,{composeMailWithHandoff:()=>Tv,isSupported:()=>Ov});var he={};n.r(he),n.d(he,{ComposeMailType:()=>Nv,composeMail:()=>Mv,handoff:()=>ge,isSupported:()=>xv,openMailItem:()=>kv});var me={};n.r(me),n.d(me,{enablePrintCapability:()=>Uv,isSupported:()=>Wv,print:()=>Lv,registerBeforeUnloadHandler:()=>Vv,registerBeforeUnloadHandlerHelper:()=>Bv,registerOnLoadHandler:()=>Hv,registerOnLoadHandlerHelper:()=>_v});var ve={};n.r(ve),n.d(ve,{isSupported:()=>Gv,selectPeople:()=>qv});var we={};n.r(we),n.d(we,{isSupported:()=>Xv,showProfile:()=>Zv});var Ce={};n.r(Ce),n.d(Ce,{closeSearch:()=>aw,isSupported:()=>iw,registerHandlers:()=>rw,unregisterHandlers:()=>ow});var ye={};n.r(ye),n.d(ye,{getContent:()=>uw,isSupported:()=>lw});var Se={};n.r(Se),n.d(Se,{SharingAPIMessages:()=>pw,history:()=>ye,isSupported:()=>Cw,shareWebContent:()=>gw});var be={};n.r(be),n.d(be,{close:()=>Sw,isSupported:()=>bw});var Ae={};n.r(Ae),n.d(Ae,{StageViewOpenMode:()=>Ew,isSupported:()=>Pw,open:()=>Iw,self:()=>be});var Ee={};n.r(Ee),n.d(Ee,{captureImages:()=>Fw,isSupported:()=>Mw,retrieveImages:()=>kw});var Ie={};n.r(Ie),n.d(Ie,{CameraRestriction:()=>Lw,Source:()=>Hw,hasPermission:()=>_w,image:()=>Ee,requestPermission:()=>Vw});var Pe={};n.r(Pe),n.d(Pe,{isSupported:()=>Gw,isWebStorageClearedOnUserLogOut:()=>qw});var Te={};n.r(Te),n.d(Te,{CallModalities:()=>Kw,isSupported:()=>Zw,startCall:()=>Qw});var Oe={};n.r(Oe),n.d(Oe,{ExpectedFailureReason:()=>Po,FailedReason:()=>Io,Messages:()=>Eo,notifyAppLoaded:()=>Yw,notifyExpectedFailure:()=>nC,notifyFailure:()=>tC,notifySuccess:()=>eC});var Re={};n.r(Re),n.d(Re,{getDragAndDropFiles:()=>lC,isSupported:()=>fC});var Fe={};n.r(Fe),n.d(Fe,{getSettings:()=>BC,registerOnRemoveHandler:()=>zC,registerOnSaveHandler:()=>jC,setSettings:()=>WC,setValidityState:()=>VC});var ke={};n.r(ke),n.d(ke,{getDefaultSizeIfNotProvided:()=>XC,startTask:()=>GC,submitTask:()=>KC,updateTask:()=>JC});var Me={};n.r(Me),n.d(Me,{ContainerState:()=>ty,LiveShareHost:()=>ry,UserMeetingRole:()=>ey,isSupported:()=>ny});var xe={};n.r(xe),n.d(xe,{CartStatus:()=>Cy,Intent:()=>wy,addOrUpdateCartItems:()=>Sy,cartVersion:()=>vy,getCart:()=>yy,isSupported:()=>Ey,removeCartItems:()=>by,updateCartStatus:()=>Ay});var Ne,De,Ue,Le,He,_e,Ve,Be,We,je,ze={};function qe(e){return void 0!==(null==e?void 0:e.errorCode)}n.r(ze),n.d(ze,{DISABLE_SHORTCUT_FORWARDING_ATTRIBUTE:()=>jy,enableShortcutRelayCapability:()=>By,isSupported:()=>Wy,resetIsShortcutRelayCapabilityEnabled:()=>Vy,setOverridableShortcutHandler:()=>_y}),function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(Ne||(Ne={})),function(e){e.M365Content="m365content"}(De||(De={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(Ue||(Ue={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(Le||(Le={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(He||(He={})),function(e){e.BCAIS="bcais",e.BCWAF="bcwaf",e.BCWBF="bcwbf"}(_e||(_e={})),function(e){e.Faculty="faculty",e.Student="student",e.Other="other"}(Ve||(Ve={})),function(e){e.Adult="adult",e.MinorNoParentalConsentRequired="minorNoParentalConsentRequired",e.MinorWithoutParentalConsent="minorWithoutParentalConsent",e.MinorWithParentalConsent="minorWithParentalConsent",e.NotAdult="notAdult",e.NonAdult="notAdult"}(Be||(Be={})),function(e){e.HigherEducation="higherEducation",e.K12="k12",e.Other="other"}(We||(We={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(je||(je={}));const $e=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.office365.us","outlook-dod.office365.us","webmail.apps.mil","outlook.live.com","outlook-sdf.live.com","teams.live.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","devspaces.skype.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","work.bing.com","www.bing.com","www.staging-bing-int.com","*.cloud.microsoft","*.m365.cloud.microsoft","*.outlook.cloud.microsoft","chatuxmanager.svc.cloud.microsoft","copilot.microsoft.com","windows.msn.com","fa000000125.resources.office.net","fa000000129.resources.office.net","fa000000124.resources.office.net","fa000000128.resources.office.net","fa000000136.resources.office.net","fa000000125.officeapps.live.com","fa000000129.officeapps.live.com","fa000000124.officeapps.live.com","fa000000128.officeapps.live.com","fa000000136.mro1cdnstorage.public.cdn.office.net","fa000000136.mro1cdnstorage.public.onecdn.static.microsoft","substrate-msb-bizchatvnext-service.sdf01.substrate-msb-bingatwork.eastus2-sdf.cosmic-ppe.office.net","office-home-m365copilotapp.wus2sdf1.office-home-m365copilotapp.westus2-sdf.cosmic-ppe.office.net","office-home-m365copilotapp.wus2test1.office-home-m365copilotapp.westus2-test.cosmic-int.office.net","m365copilotapp.svc.cloud.microsoft","m365copilotapp.svc.cloud.dev.microsoft","ffc-copilot.officeapps.live.com","m365.cloud.dev.microsoft","m365.cloud.dev.microsoft:3001"]}');const Ge="2.0.1",Je="2.0.2",Ke="2.0.3",Qe="2.0.4",Ze="2.0.1",Xe="1.9.0",Ye="2.0.0",et="1.7.0",tt="1.8.0",nt="1.9.0",rt=n.t($e,2).validOrigins,ot=1500,it=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),at=/^https:\/\//,st="https",ct="teams.microsoft.com",ut="The library has not yet been initialized",lt="The runtime has not yet been initialized",dt="The runtime version is not supported",ft="The call was not properly started";var pt=n(933);const gt=mt,ht=2147483647;function mt(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return wt(e)}return vt(e,t,n)}function vt(e,t,n){if("string"==typeof e)return bt(e,t);if(ArrayBuffer.isView(e))return Rt(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Et(e,ArrayBuffer)||e&&Et(e.buffer,ArrayBuffer))return Ft(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(Et(e,SharedArrayBuffer)||e&&Et(e.buffer,SharedArrayBuffer)))return Ft(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return mt.from(r,t,n);const o=Zt(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return mt.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function wt(e){return Ct(e),yt(e<0?0:0|St(e))}function Ct(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function yt(e){if(e>ht)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,mt.prototype),t}function St(e){if(e>=ht)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ht.toString(16)+" bytes");return 0|e}function bt(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!mt.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|At(e,t);let r=yt(n);const o=r.write(e,t);return o!==n&&(r=r.slice(0,o)),r}function At(e,t){if(mt.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Et(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let o=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return It(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Pt(e).length;default:if(o)return r?-1:It(e).length;t=(""+t).toLowerCase(),o=!0}}function Et(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function It(e,t){let n;t=t||1/0;const r=e.length;let o=null;const i=[];for(let a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function Pt(e){return pt.toByteArray(Ot(e))}mt.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),mt.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required"),mt.from=function(e,t,n){return vt(e,t,n)},Object.setPrototypeOf(mt.prototype,Uint8Array.prototype),Object.setPrototypeOf(mt,Uint8Array),mt.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},mt.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==mt.prototype};const Tt=/[^+/0-9A-Za-z-_]/g;function Ot(e){if((e=(e=e.split("=")[0]).trim().replace(Tt,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function Rt(e){if(Et(e,Uint8Array)){const t=new Uint8Array(e);return Ft(t.buffer,t.byteOffset,t.byteLength)}return kt(e)}function Ft(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,mt.prototype),r}function kt(e){const t=e.length<0?0:0|St(e.length),n=yt(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function Mt(e,t,n){n=Math.min(e.length,n);const r=[];let o=t;for(;o<n;){const t=e[o];let i=null,a=t>239?4:t>223?3:t>191?2:1;if(o+a<=n){let n,r,s,c;switch(a){case 1:t<128&&(i=t);break;case 2:n=e[o+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(i=c));break;case 3:n=e[o+1],r=e[o+2],128==(192&n)&&128==(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:n=e[o+1],r=e[o+2],s=e[o+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&s,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,a=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=a}return Dt(r)}function xt(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Ut(this,t,n);case"utf8":case"utf-8":return Mt(this,t,n);case"ascii":return Lt(this,t,n);case"latin1":case"binary":return Ht(this,t,n);case"base64":return _t(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Vt(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}mt.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?Mt(this,0,e):xt.apply(this,arguments)};const Nt=4096;function Dt(e){const t=e.length;if(t<=Nt)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Nt));return n}function Ut(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let o="";for(let r=t;r<n;++r)o+=Qt[e[r]];return o}function Lt(e,t,n){let r="";n=Math.min(e.length,n);for(let o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function Ht(e,t,n){let r="";n=Math.min(e.length,n);for(let o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function _t(e,t,n){return 0===t&&n===e.length?pt.fromByteArray(e):pt.fromByteArray(e.slice(t,n))}function Vt(e,t,n){const r=e.slice(t,n);let o="";for(let e=0;e<r.length-1;e+=2)o+=String.fromCharCode(r[e]+256*r[e+1]);return o}function Bt(e,t,n,r){n=Number(n)||0;const o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;const i=t.length;let a;for(r>i/2&&(r=i/2),a=0;a<r;++a){const r=parseInt(t.substr(2*a,2),16);if(Kt(r))return a;e[n+a]=r}return a}function Wt(e,t,n,r){return Jt(It(t,e.length-n),e,n,r)}function jt(e,t,n,r){return Jt($t(t),e,n,r)}function zt(e,t,n,r){return Jt(Pt(t),e,n,r)}function qt(e,t,n,r){return Jt(Gt(t,e.length-n),e,n,r)}function $t(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function Gt(e,t){let n,r,o;const i=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function Jt(e,t,n,r){let o;for(o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function Kt(e){return e!=e}mt.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return Bt(this,e,t,n);case"utf8":case"utf-8":return Wt(this,e,t,n);case"ascii":case"latin1":case"binary":return jt(this,e,t,n);case"base64":return zt(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return qt(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}};const Qt=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let o=0;o<16;++o)t[r+o]=e[n]+e[o]}return t}();function Zt(e){if(mt.isBuffer(e)){const t=0|St(e.length),n=yt(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||Kt(e.length)?yt(0):kt(e):"Buffer"===e.type&&Array.isArray(e.data)?kt(e.data):void 0}const Xt={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Yt;const en=new Uint8Array(16);function tn(){if(!Yt&&(Yt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Yt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Yt(en)}const nn=[];for(let e=0;e<256;++e)nn.push((e+256).toString(16).slice(1));function rn(e,t=0){return nn[e[t+0]]+nn[e[t+1]]+nn[e[t+2]]+nn[e[t+3]]+"-"+nn[e[t+4]]+nn[e[t+5]]+"-"+nn[e[t+6]]+nn[e[t+7]]+"-"+nn[e[t+8]]+nn[e[t+9]]+"-"+nn[e[t+10]]+nn[e[t+11]]+nn[e[t+12]]+nn[e[t+13]]+nn[e[t+14]]+nn[e[t+15]]}const on=function(e,t,n){if(Xt.randomUUID&&!t&&!e)return Xt.randomUUID();const r=(e=e||{}).random||(e.rng||tn)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return rn(r)},an=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const sn=function(e){return"string"==typeof e&&an.test(e)};var cn,un,ln,dn,fn,pn,gn,hn;!function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.visionOS="visionOS",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(cn||(cn={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.places="Places",e.teams="Teams",e.teamsModern="TeamsModern"}(un||(un={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(ln||(ln={})),function(e){e.copilotSidePanel="copilotSidePanel",e.copilotMainPane="copilotMainPane",e.copilotFullScreen="copilotFullScreen"}(dn||(dn={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(fn||(fn={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(pn||(pn={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(gn||(gn={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(hn||(hn={}));const mn={errorCode:Le.NOT_SUPPORTED_ON_PLATFORM},vn={majorVersion:1,minorVersion:5},wn={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},Cn=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),yn=new Error("Invalid response: Received more images than the specified max limit in the response.");function Sn(e){return(t,n)=>{if(!t)throw new Error(e||n)}}function bn(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;const n=e.split("."),r=t.split(".");function o(e){return/^\d+$/.test(e)}if(!n.every(o)||!r.every(o))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");for(let e=0;e<n.length;++e)if(Number(n[e])!=Number(r[e]))return Number(n[e])>Number(r[e])?1:-1;return 0}function An(){return on()}function En(e){return Object.keys(e).forEach((t=>{null!==e[t]&&void 0!==e[t]&&"object"==typeof e[t]&&En(e[t])})),Object.freeze(e)}function In(e,t,...n){const r=e(...n);return r.then((e=>{t&&t(void 0,e)})).catch((e=>{t&&t(e)})),r}function Pn(e,t,...n){const r=e(...n);return r.then((()=>{t&&t(null)})).catch((e=>{t&&t(e)})),r}function Tn(e,t,...n){const r=e(...n);return r.then((e=>{t&&t(null,e)})).catch((e=>{t&&t(e,null)})),r}function On(e,t,n){return new Promise(((r,o)=>{const i=setTimeout(o,t,n);e().then((e=>{clearTimeout(i),r(e)})).catch((e=>{clearTimeout(i),o(e)}))}))}function Rn(e){const t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId.toString())+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl.toString()),(e.chatId||e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({chatId:e.chatId,channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}function Fn(e){return!(bn(`${e.majorVersion}.${e.minorVersion}`,`${vn.majorVersion}.${vn.minorVersion}`)>=0)}function kn(e){return"https:"===e.protocol}function Mn(e,t){return new Promise(((n,r)=>{if(e||r("MimeType cannot be null or empty."),t||r("Base64 string cannot be null or empty."),e.startsWith("image/")){const r=atob(t),o=new Uint8Array(r.length);for(let e=0;e<r.length;e++)o[e]=r.charCodeAt(e);n(new Blob([o],{type:e}))}const o=gt.from(t,"base64").toString();n(new Blob([o],{type:e}))}))}function xn(e){return new Promise(((t,n)=>{0===e.size&&n(new Error("Blob cannot be empty."));const r=new FileReader;r.onloadend=()=>{r.result?t(r.result.toString().split(",")[1]):n(new Error("Failed to read the blob"))},r.onerror=()=>{n(r.error)},r.readAsDataURL(e)}))}function Nn(){if(Dn())throw new Error("window object undefined at SSR check");return window}function Dn(){return"undefined"==typeof window}function Un(e,t){if(_n(e)||!Vn(e)||!Bn(e))throw t||new Error("id is not valid.")}function Ln(e,t){const n=e.toString().toLocaleLowerCase();if(_n(n))throw t||new Error("Invalid Url");if(n.length>2048)throw t||new Error("Url exceeds the maximum size of 2048 characters");if(!kn(e))throw t||new Error("Url should be a valid https url")}function Hn(e){const t=document.createElement("a");return t.href=e,new URL(t.href)}function _n(e){return new RegExp(`${/<script[^>]*>|&lt;script[^&]*&gt;|%3Cscript[^%]*%3E/gi.source}|${/<\/script[^>]*>|&lt;\/script[^&]*&gt;|%3C\/script[^%]*%3E/gi.source}`,"gi").test(e)}function Vn(e){return e.length<256&&e.length>4}function Bn(e){for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n<32||n>126)return!1}return!0}function Wn(e){if(!e)throw new Error("id must not be empty");if(!1===sn(e))throw new Error("id must be a valid UUID")}const jn=!!performance&&"now"in performance;function zn(){return jn?performance.now()+performance.timeOrigin:void 0}function qn(e,t=0){if(t>1e3)return!1;if(void 0===e||"boolean"==typeof e||"number"==typeof e||"bigint"==typeof e||"string"==typeof e||null===e)return!0;if(Array.isArray(e))return e.every((e=>qn(e,t+1)));return!("object"!=typeof e||"[object Object]"!==Object.prototype.toString.call(e)||Object.getPrototypeOf(e)!==Object.prototype&&null!==Object.getPrototypeOf(e))&&Object.keys(e).every((n=>qn(e[n],t+1)))}function $n(e){var t,n;if(!(null===(n=null===(t=e.hostVersionsInfo)||void 0===t?void 0:t.appEligibilityInformation)||void 0===n?void 0:n.ageGroup))return e;const r=e.hostVersionsInfo.appEligibilityInformation.ageGroup;return"nonadult"!==(null==r?void 0:r.toLowerCase())?e:Object.assign(Object.assign({},e),{hostVersionsInfo:Object.assign(Object.assign({},e.hostVersionsInfo),{appEligibilityInformation:Object.assign(Object.assign({},e.hostVersionsInfo.appEligibilityInformation),{ageGroup:Be.NotAdult})})})}class Gn{constructor(e=An()){this.uuid=e,Wn(e)}toString(){return this.uuid}serialize(){return this.toString()}}function Jn(e){if(!(e instanceof Gn))throw new Error(`Potential id (${JSON.stringify(e)}) is invalid; it is not an instance of UUID class.`)}class Kn{}Kn.initializeCalled=!1,Kn.initializeCompleted=!1,Kn.additionalValidOrigins=[],Kn.initializePromise=void 0,Kn.isFramelessWindow=!1,Kn.frameContext=void 0,Kn.hostClientType=void 0,Kn.printCapabilityEnabled=!1,Kn.teamsJsInstanceId=(new Gn).toString();var Qn=n(815);const Zn=new Gn,Xn=Qn.debug.formatArgs;Qn.debug.formatArgs=function(e){e[0]=`(${(new Date).toISOString()}): ${e[0]} [${Zn.toString()}]`,Xn.call(this,e)};const Yn=(0,Qn.debug)("teamsJs");function er(e){return Yn.extend(e)}function tr(e,t){return`${e}_${t}`}function nr(e){return/^v\d+_[\w.]+$/.test(e)}var rr=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const or=er("runtime"),ir=4;function ar(e){return e.apiVersion===ir}const sr={apiVersion:-1,supports:{}};function cr(e){if(ar(e))return!0;throw-1===e.apiVersion?new Error(lt):new Error(dt)}let ur=sr;const lr={apiVersion:4,isNAAChannelRecommended:!1,isDeeplyNestedAuthSupported:!1,hostVersionsInfo:wn,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{},parentCommunication:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},dr=[cn.desktop,cn.web,cn.rigel,cn.surfaceHub,cn.teamsRoomsWindows,cn.teamsRoomsAndroid,cn.teamsPhones,cn.teamsDisplays],fr=[cn.android,cn.ios,cn.ipados,cn.visionOS],pr=[...dr,...fr];function gr(e){let t=e;if(t.apiVersion<ir&&hr.forEach((e=>{t.apiVersion===e.versionToUpgradeFrom&&(t=e.upgradeToNextVersion(t))})),ar(t))return t;throw new Error("Received a runtime that could not be upgraded to the latest version")}const hr=[{versionToUpgradeFrom:1,upgradeToNextVersion:e=>{var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null===(t=e.supports.dialog)||void 0===t?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:e=>{const t=e.supports,{appNotification:n}=t,r=rr(t,["appNotification"]);return Object.assign(Object.assign({},e),{apiVersion:3,supports:r})}},{versionToUpgradeFrom:3,upgradeToNextVersion:e=>{var t,n,r,o,i;return{apiVersion:4,hostVersionsInfo:e.hostVersionsInfo,isNAAChannelRecommended:e.isNAAChannelRecommended,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:null===(t=e.supports.dialog)||void 0===t?void 0:t.card,url:{bot:null===(r=null===(n=e.supports.dialog)||void 0===n?void 0:n.url)||void 0===r?void 0:r.bot,parentCommunication:(null===(o=e.supports.dialog)||void 0===o?void 0:o.url)?{}:void 0},update:null===(i=e.supports.dialog)||void 0===i?void 0:i.update}:void 0})}}}],mr="2.1.2",vr={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:dr}],"1.9.0":[{capability:{location:{}},hostClientTypes:pr}],"2.0.0":[{capability:{people:{}},hostClientTypes:pr},{capability:{sharing:{}},hostClientTypes:[cn.desktop,cn.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[cn.android,cn.desktop,cn.ios,cn.teamsRoomsAndroid,cn.teamsPhones,cn.teamsDisplays,cn.web]},{capability:{webStorage:{}},hostClientTypes:[cn.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[cn.android,cn.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[cn.android,cn.ios]}],"2.1.1":[{capability:{nestedAppAuth:{}},hostClientTypes:[cn.android,cn.ios,cn.ipados,cn.visionOS]}],"2.1.2":[]},wr=or.extend("generateBackCompatRuntimeConfig");function Cr(e,t){const n=Object.assign({},e);for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&("object"!=typeof t[r]||Array.isArray(t[r])?r in e||(n[r]=t[r]):n[r]=Cr(e[r]||{},t[r]));return n}function yr(e,t,n){wr("generating back compat runtime config for %s",e);let r=Object.assign({},t.supports);wr("Supported capabilities in config before updating based on highestSupportedVersion: %o",r),Object.keys(n).forEach((t=>{bn(e,t)>=0&&n[t].forEach((e=>{void 0!==Kn.hostClientType&&e.hostClientTypes.includes(Kn.hostClientType)&&(r=Cr(r,e.capability))}))}));const o={apiVersion:ir,hostVersionsInfo:wn,isLegacyTeams:!0,supports:r};return wr("Runtime config after updating based on highestSupportedVersion: %o",o),o}const Sr=or.extend("applyRuntimeConfig");function br(e){"string"==typeof e.apiVersion&&(Sr("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Object.assign(Object.assign({},e),{apiVersion:1})),Sr("Fast-forwarding runtime %o",e);const t=gr(e);Sr("Applying runtime %o",t),ur=En(t)}function Ar(e){return null!=e&&void 0!==e.serialize&&"function"==typeof e.serialize}const Er="2.48.0",Ir={childProxyingCommunication:!1};function Pr(){Ir.childProxyingCommunication=!0}function Tr(){return Ir.childProxyingCommunication}let Or={disableEnforceOriginMatchForChildResponses:!1};function Rr(){return Or}function Fr(e){Or=e}function kr(e){return Fr(Object.assign(Object.assign({},Or),e)),Rr()}var Mr=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const xr=e=>{const{uuid:t}=e,n=Mr(e,["uuid"]),r=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:r})},Nr=e=>{const{uuidAsString:t}=e,n=Mr(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:t?new Gn(t):void 0})},Dr=e=>{const{uuidAsString:t}=e,n=Mr(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:t?new Gn(t):void 0})},Ur=e=>{const{uuid:t}=e,n=Mr(e,["uuid"]),r=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:r})};function Lr(e){return void 0!==e.uuidAsString?`${e.uuidAsString} (legacy id: ${e.id})`:void 0!==e.uuid?`${e.uuid.toString()} (legacy id: ${e.id})`:`legacy id: ${e.id} (no uuid)`}const Hr=er("flushMessageQueue");function _r(e,t,n,r){if(e&&t&&0!==n.length)for(;n.length>0;){const o=n.shift();if(o){const n=xr(o);Hr("Flushing message %s from %s message queue via postMessage.",Lr(n),r),e.postMessage(n,t)}}}const Vr=er("internal"),Br=Vr.extend("ensureInitializeCalled"),Wr=Vr.extend("ensureInitialized");function jr(){if(!Kn.initializeCalled)throw Br(ut),new Error(ut)}function zr(e,...t){if(!Kn.initializeCompleted)throw Wr("%s. initializeCalled: %s",ut,Kn.initializeCalled.toString()),new Error(ut);if(t&&t.length>0){let e=!1;for(let n=0;n<t.length;n++)if(t[n]===Kn.frameContext){e=!0;break}if(!e)throw new Error(`This call is only allowed in following contexts: ${JSON.stringify(t)}. Current context: "${Kn.frameContext}".`)}return cr(e)}function qr(e=Ge){const t=bn(Kn.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function $r(){return Kn.hostClientType==cn.android||Kn.hostClientType==cn.ios||Kn.hostClientType==cn.ipados||Kn.hostClientType==cn.visionOS}function Gr(e=Ge){if(!$r()){throw{errorCode:Le.NOT_SUPPORTED_ON_PLATFORM}}if(!qr(e)){throw{errorCode:Le.OLD_PLATFORM}}}function Jr(e){let t=Kn.additionalValidOrigins.concat(e.filter((e=>"string"==typeof e&&at.test(e))));const n={};t=t.filter((e=>!n[e]&&(n[e]=!0,!0))),Kn.additionalValidOrigins=t}function Kr(e){if(!Yr(e))throw new Error(`Potential app id (${e}) is invalid; its length ${e.length} is not within the length limits (${Zr}-${Xr}).`)}function Qr(e){if(_n(e))throw new Error(`Potential app id (${e}) is invalid; it contains script tags.`);if(eo(e))throw new Error(`Potential app id (${e}) is invalid; it contains non-printable characters.`)}const Zr=4,Xr=256;function Yr(e){return e.length<Xr&&e.length>Zr}function eo(e){return[...e].some((e=>{const t=e.charCodeAt(0);return t<32||t>126}))}function to(e){if(!(e instanceof ro))throw new Error(`Potential app id (${e}) is invalid; it is not an instance of AppId class.`)}class no{constructor(e){this.idAsString=e,Qr(e)}serialize(){return this.toString()}toString(){return this.idAsString}}class ro extends no{constructor(e){super(e),Kr(e)}toJSON(){return{appIdAsString:this.toString()}}}function oo(e){return null==e}var io=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let ao;const so="v1",co=er("messageChannels.telemetry");function uo(){return io(this,void 0,void 0,(function*(){if(ao)return co("Returning telemetry port from cache"),ao;if(!lo())throw mn;return ao=yield bc(tr(so,"messageChannels.telemetry.getTelemetryPort"),"messageChannels.telemetry.getTelemetryPort"),ao}))}function lo(){var e;return!(!zr(ur)||!(null===(e=ur.supports.messageChannels)||void 0===e?void 0:e.telemetry))}function fo(){ao=void 0}var po=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let go;const ho="v1",mo=er("messageChannels.dataLayer");function vo(){return po(this,void 0,void 0,(function*(){if(go)return mo("Returning dataLayer port from cache"),go;if(!wo())throw mn;return go=yield bc(tr(ho,"messageChannels.dataLayer.getDataLayerPort"),"messageChannels.dataLayer.getDataLayerPort"),go}))}function wo(){var e;return!(!zr(ur)||!(null===(e=ur.supports.messageChannels)||void 0===e?void 0:e.dataLayer))}function Co(){go=void 0}function yo(e){if(!e)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");zr(ur),_s(e)}function So(e){if(!e)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");zr(ur),Vs(e)}const bo="v2",Ao=er("app"),Eo={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"};var Io,Po;function To(){return Kn.initializeCompleted}function Oo(){return Kn.frameContext}function Ro(e){return Xi(tr(bo,"app.initialize"),e)}function Fo(e){lc.currentWindow=e}function ko(){Kn.initializeCalled&&(Ss(),Kn.initializeCalled=!1,Kn.initializeCompleted=!1,Kn.initializePromise=void 0,Kn.additionalValidOrigins=[],Kn.frameContext=void 0,Kn.hostClientType=void 0,Kn.isFramelessWindow=!1,fo(),Co(),pc())}function Mo(){return new Promise((e=>{jr(),e(gc(tr(bo,"app.getContext"),"getContext"))})).then((e=>Bo(e)))}function xo(){jr(),Yi(tr(bo,"app.notifyAppLoaded"))}function No(){return na(tr(bo,"app.notifySuccess"))}function Do(e){jr(),ta(tr(bo,"app.notifyFailure"),e)}function Uo(e){jr(),ea(tr(bo,"app.notifyExpectedFailure"),e)}function Lo(e){sa(tr(bo,"app.registerOnThemeChangeHandler"),e)}function Ho(e){ca(tr(bo,"app.registerOnContextChangeHandler"),e)}function _o(e){Ms(e)}function Vo(e){return ua(tr(bo,"app.openLink"),e)}function Bo(e){var t;return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,messageId:e.messageId,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userClickTimeV2:e.userClickTimeV2,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:un.teams,clientType:e.hostClientType?e.hostClientType:cn.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId,ancestors:e.hostAncestors},appLaunchId:e.appLaunchId,appId:e.appId?new ro(e.appId):void 0,manifestVersion:e.manifestVersion},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:Kn.frameContext,renderingSurface:e.renderingSurface?e.renderingSurface:void 0,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,isBackgroundLoad:e.isBackgroundLoad,sourceOrigin:e.sourceOrigin},user:{id:null!==(t=e.userObjectId)&&void 0!==t?t:"",displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0,dialogParameters:e.dialogParameters||{}}}function Wo(e){ri(tr(ti,"dialog.update.resize"),e)}function jo(){return!(!zr(ur)||!ur.supports.dialog)&&!!ur.supports.dialog.update}function zo(e,t,n){ii(tr(ti,"dialog.url.bot.open"),e,t,n)}function qo(){return zr(ur)&&void 0!==(ur.supports.dialog&&ur.supports.dialog.url&&ur.supports.dialog.url.bot)}function $o(e){if(zr(ur,ln.task),!Ko())throw mn;Ic(tr(ti,"dialog.url.parentCommunication.sendMessageToParentFromDialog"),"messageForParent",[e])}function Go(e){if(zr(ur,ln.content,ln.sidePanel,ln.meetingStage),!Ko())throw mn;Ic(tr(ti,"dialog.url.parentCommunication.sendMessageToDialog"),"messageForChild",[e])}function Jo(e){if(zr(ur,ln.task),!Ko())throw mn;for(Is("messageForChild"),Es(tr(ti,"dialog.url.parentCommunication.registerMessageForChildHandler"),"messageForChild",e),ui.reverse();ui.length>0;){e(ui.pop())}}function Ko(){var e,t;return zr(ur)&&!!(null===(t=null===(e=ur.supports.dialog)||void 0===e?void 0:e.url)||void 0===t?void 0:t.parentCommunication)}function Qo(e,t,n){oi(tr(ti,"dialog.url.open"),e,t,n)}function Zo(e,t){ai(tr(ti,"dialog.url.submit"),e,t)}function Xo(){return zr(ur)&&void 0!==(ur.supports.dialog&&ur.supports.dialog.url)}function Yo(e){return{url:e.url,height:e.size?e.size.height:gn.Small,width:e.size?e.size.width:gn.Small,title:e.title,fallbackUrl:e.fallbackUrl}}function ei(e){const t=Yo(e);return t.completionBotId=e.completionBotId,t}!function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(Io||(Io={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(Po||(Po={})),Ao("teamsjs instance is version %s, starting at %s UTC (%s local)",Er,(new Date).toISOString(),(new Date).toLocaleString()),function(){if(Dn())return;const e=document.getElementsByTagName("script"),t=e&&e[e.length-1]&&e[e.length-1].src,n="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";t&&0!==t.length?Ao("teamsjs is being used from %s. %s",t,n):Ao("teamsjs is being used from a script tag embedded directly in your html. %s",n)}();const ti="v2",ni="dialog.submit should not be called from FrameContext.content.\nIf dialog.submit was called from inside the dialog, please disregard this message.\nThis issue occurs due to a bug in Teams mobile where the dialog is incorrectly identified as being in the content FrameContext.\nWe are working to resolve this.";function ri(e,t){if(zr(ur,ln.content,ln.sidePanel,ln.task,ln.meetingStage),!jo())throw mn;Ic(e,"tasks.updateTask",[t])}function oi(e,t,n,r){if(zr(ur,ln.content,ln.sidePanel,ln.meetingStage),!Xo())throw mn;r&&Es(tr(ti,"dialog.url.registerMessageForParentHandler"),"messageForParent",r);Ic(e,"tasks.startTask",[Yo(t)],((e,t)=>{null==n||n({err:e,result:t}),Is("messageForParent")}))}function ii(e,t,n,r){if(zr(ur,ln.content,ln.sidePanel,ln.meetingStage),!qo())throw mn;r&&Es(tr(ti,"dialog.url.bot.registerMessageForParentHandler"),"messageForParent",r);Ic(e,"tasks.startTask",[ei(t)],((e,t)=>{null==n||n({err:e,result:t}),Is("messageForParent")}))}function ai(e,t,n){if(zr(ur,ln.content,ln.task),!Xo())throw mn;Kn.frameContext===ln.content&&console.warn(ni),Ic(e,"tasks.completeTask",[t,n?Array.isArray(n)?n:[n]:[]])}function si(e){return{card:e.card,height:e.size?e.size.height:gn.Small,width:e.size?e.size.width:gn.Small,title:e.title}}function ci(e){const t=si(e);return t.completionBotId=e.completionBotId,t}const ui=[];function li(e){Kn.frameContext&&(Kn.frameContext===ln.task?ui.push(e):Is("messageForChild"))}function di(e,t){if(zr(ur,ln.content,ln.sidePanel,ln.meetingStage),!fi())throw mn;const n=ci(e);Ic(tr(ti,"dialog.adaptiveCard.bot.open"),"tasks.startTask",[n],((e,n)=>{null==t||t({err:e,result:n})}))}function fi(){const e=ur.hostVersionsInfo&&ur.hostVersionsInfo.adaptiveCardSchemaVersion&&!Fn(ur.hostVersionsInfo.adaptiveCardSchemaVersion);return zr(ur)&&void 0!==(e&&ur.supports.dialog&&ur.supports.dialog.card&&ur.supports.dialog.card.bot)}function pi(e,t){if(zr(ur,ln.content,ln.sidePanel,ln.meetingStage),!gi())throw mn;const n=si(e);Ic(tr(ti,"dialog.adaptiveCard.open"),"tasks.startTask",[n],((e,n)=>{null==t||t({err:e,result:n})}))}function gi(){const e=ur.hostVersionsInfo&&ur.hostVersionsInfo.adaptiveCardSchemaVersion&&!Fn(ur.hostVersionsInfo.adaptiveCardSchemaVersion);return zr(ur)&&void 0!==(e&&ur.supports.dialog&&ur.supports.dialog.card)}function hi(){Es(tr(ti,"dialog.registerMessageForChildHandler"),"messageForChild",li,!1)}function mi(){return!(!zr(ur)||!ur.supports.dialog)}const vi="v2";var wi,Ci;!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(wi||(wi={}));class yi{constructor(){this.enabled=!0,this.selected=!1}}let Si,bi,Ai,Ei,Ii;function Pi(){Es(tr(vi,"menus.registerNavBarMenuItemPressHandler"),"navBarMenuItemPress",Fi,!1),Es(tr(vi,"menus.registerActionMenuItemPressHandler"),"actionMenuItemPress",Mi,!1),Es(tr(vi,"menus.registerSetModuleViewHandler"),"setModuleView",Oi,!1)}function Ti(e,t){if(zr(ur),!xi())throw mn;Ai=t,Ic(tr(vi,"menus.setUpViews"),"setUpViews",[e])}function Oi(e){Ai&&Ai(e)||(zr(ur),Ic(tr(vi,"menus.handleViewConfigItemPress"),"viewConfigItemPress",[e]))}function Ri(e,t){if(zr(ur),!xi())throw mn;Si=t,Ic(tr(vi,"menus.setNavBarMenu"),"setNavBarMenu",[e])}function Fi(e){Si&&Si(e)||(zr(ur),Ic(tr(vi,"menus.handleNavBarMenuItemPress"),"handleNavBarMenuItemPress",[e]))}function ki(e,t){if(zr(ur),!xi())throw mn;bi=t,Ic(tr(vi,"menus.showActionMenu"),"showActionMenu",[e])}function Mi(e){bi&&bi(e)||(zr(ur),Ic(tr(vi,"menus.handleActionMenuItemPress"),"handleActionMenuItemPress",[e]))}function xi(){return!(!zr(ur)||!ur.supports.menus)}function Ni(){Es(tr(Xa,"pages.config.registerSettingsSaveHandler"),"settings.save",Bi,!1),Es(tr(Xa,"pages.config.registerSettingsRemoveHandler"),"settings.remove",zi,!1)}function Di(e){return ss(tr(Xa,"pages.config.setValidityState"),e)}function Ui(e){return us(tr(Xa,"pages.config.setConfig"),e)}function Li(e){Hi(tr(Xa,"pages.config.registerOnSaveHandler"),e,(()=>{if(!oo(e)&&!$i())throw mn}))}function Hi(e,t,n){!oo(t)&&zr(ur,ln.settings),n&&n(),Ei=t,!oo(t)&&Ic(e,"registerHandler",["save"])}function _i(e){Vi(tr(Xa,"pages.config.registerOnRemoveHandler"),e,(()=>{if(!oo(e)&&!$i())throw mn}))}function Vi(e,t,n){!oo(t)&&zr(ur,ln.remove,ln.settings),n&&n(),Ii=t,!oo(t)&&Ic(e,"registerHandler",["remove"])}function Bi(e){const t=new ji(e);Ei?Ei(t):qs()?Xs("settings.save",[e]):t.notifySuccess()}function Wi(e){Ts(tr(Xa,"pages.config.registerChangeConfigHandler"),"changeSettings",e,[ln.content],(()=>{if(!$i())throw mn}))}!function(e){e.dropDown="dropDown",e.popOver="popOver"}(Ci||(Ci={}));class ji{constructor(e){this.notified=!1,this.result=e||{}}notifySuccess(){this.ensureNotNotified(),Ic(tr(Xa,"pages.saveEvent.notifySuccess"),"settings.save.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),Ic(tr(Xa,"pages.saveEvent.notifyFailure"),"settings.save.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")}}function zi(){const e=new qi;Ii?Ii(e):qs()?Xs("settings.remove",[]):e.notifySuccess()}class qi{constructor(){this.notified=!1}notifySuccess(){this.ensureNotNotified(),Ic(tr(Xa,"pages.removeEvent.notifySuccess"),"settings.remove.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),Ic(tr(Xa,"pages.removeEvent.notifyFailure"),"settings.remove.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")}}function $i(){return!(!zr(ur)||!ur.supports.pages)&&!!ur.supports.pages.config}class Gi{}class Ji extends Gi{validate(e){return!0}deserialize(e){return e}}var Ki=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Qi=6e4,Zi=er("app");function Xi(e,t){if(Dn()){return Zi.extend("initialize")("window object undefined at initialization"),Promise.resolve()}return On((()=>aa(e,t)),Qi,new Error("SDK initialization timed out."))}function Yi(e){Ic(e,Eo.AppLoaded,[Er])}function ea(e,t){Ic(e,Eo.ExpectedFailure,[t.reason,t.message])}function ta(e,t){Ic(e,Eo.Failure,[t.reason,t.message])}function na(e){return Ki(this,void 0,void 0,(function*(){if(Kn.initializeCompleted)return oa(e);if(!Kn.initializePromise)throw new Error(ut);return Kn.initializePromise.then((()=>oa(e)))}))}function ra(){var e;return zr(ur)&&!!(null===(e=ur.supports.app)||void 0===e?void 0:e.notifySuccessResponse)}function oa(e){return Ki(this,void 0,void 0,(function*(){return ra()?yc(Eo.Success,[Er],new Ji,e).then((()=>({hasFinishedSuccessfully:!0}))):(Ic(e,Eo.Success,[Er]),{hasFinishedSuccessfully:"unknown"})}))}const ia=Zi.extend("initializeHelper");function aa(e,t){return new Promise((n=>{Kn.initializeCalled||(Kn.initializeCalled=!0,ys(),Kn.initializePromise=fc(t,e).then((({context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r=Ge})=>{Kn.frameContext=e,Kn.hostClientType=t,Kn.clientSupportedSDKVersion=r;try{ia("Parsing %s",n);let e=JSON.parse(n);if(ia("Checking if %o is a valid runtime object",null!=e?e:"null"),!e||!e.apiVersion)throw new Error("Received runtime config is invalid");e=$n(e),n&&br(e)}catch(e){if(!(e instanceof SyntaxError))throw e;try{ia("Attempting to parse %s as an SDK version",n),isNaN(bn(n,Ge))||(Kn.clientSupportedSDKVersion=n);let e=JSON.parse(r);if(ia("givenRuntimeConfig parsed to %o",null!=e?e:"null"),!e)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");e=$n(e),br(e)}catch(e){if(!(e instanceof SyntaxError))throw e;br(yr(Kn.clientSupportedSDKVersion,lr,vr))}}Kn.initializeCompleted=!0})),Pi(),Ni(),hi()),Array.isArray(t)&&Jr(t),void 0!==Kn.initializePromise?n(Kn.initializePromise):ia("GlobalVars.initializePromise is unexpectedly undefined")}))}function sa(e,t){!oo(t)&&jr(),Os(e,t)}function ca(e,t){!oo(t)&&jr(),Rs(e,t)}function ua(e,t){return new Promise((n=>{zr(ur,ln.content,ln.sidePanel,ln.settings,ln.task,ln.stage,ln.meetingStage),n(hc(e,"executeDeepLink",t))}))}var la=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let da=[];const fa=er("validateOrigin");let pa;function ga(){return la(this,void 0,void 0,(function*(){pa||(yield ma())}))}function ha(){return 0===da.length}function ma(e=!1){return la(this,void 0,void 0,(function*(){if(!ha()&&!e)return da;if(pa)return pa;if(Dn())return da=rt,rt;{fa("Initiating fetch call to acquire valid origins list from CDN");const e=new AbortController,t=setTimeout((()=>e.abort()),ot);return pa=fetch(it,{signal:e.signal}).then((e=>{if(clearTimeout(t),!e.ok)throw new Error("Invalid Response from Fetch Call");return fa("Fetch call completed and retrieved valid origins list from CDN"),e.json().then((e=>{if(va(JSON.stringify(e)))return da=e.validOrigins,da;throw new Error("Valid origins list retrieved from CDN is invalid")}))})).catch((e=>("AbortError"===e.name?fa(`validOrigins fetch call to CDN failed due to Timeout of ${ot} ms. Defaulting to fallback list`):fa("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",e),da=rt,da))),pa}}))}function va(e){let t=JSON.parse(e);try{t=JSON.parse(e)}catch(e){return!1}if(!t.validOrigins)return!1;for(const e of t.validOrigins)try{new URL("https://"+e)}catch(t){return fa("isValidOriginsFromCDN call failed to validate origin: %s",e),!1}return!0}function wa(e,t){if("*."===e.substring(0,2)){const n=e.substring(1);if(t.length>n.length&&t.split(".").length===n.split(".").length&&t.substring(t.length-n.length)===n)return!0}else if(e===t)return!0;return!1}function Ca(e,t){const n=t||ha()?rt:da;return ya(e,n)?Promise.resolve(!0):(fa("Origin %s is not in the local valid origins list, fetching from CDN",e),ma(t).then((t=>ya(e,t))))}function ya(e,t){if(!kn(e))return fa("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;const n=e.host;if(t.some((e=>wa(e,n))))return!0;for(const e of Kn.additionalValidOrigins){if(wa("https://"===e.substring(0,8)?e.substring(8):e,n))return!0}return fa("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",e,t,Kn.additionalValidOrigins),!1}function Sa(e){Ts(tr(Xa,"pages.appButton.onClick"),"appButtonClick",e,[ln.content],(()=>{if(!Ea())throw mn}))}function ba(e){Ts(tr(Xa,"pages.appButton.onHoverEnter"),"appButtonHoverEnter",e,[ln.content],(()=>{if(!Ea())throw mn}))}function Aa(e){Ts(tr(Xa,"pages.appButton.onHoverLeave"),"appButtonHoverLeave",e,[ln.content],(()=>{if(!Ea())throw mn}))}function Ea(){return!(!zr(ur)||!ur.supports.pages)&&!!ur.supports.pages.appButton}function Ia(){hs()}function Pa(){return es(tr(Xa,"pages.backStack.navigateBack"))}function Ta(e){Oa(tr(Xa,"pages.backStack.registerBackButtonHandler"),e,(()=>{if(!oo(e)&&!Ra())throw mn}))}function Oa(e,t,n){!oo(t)&&zr(ur),n&&n(),gs(t),!oo(t)&&Ic(e,"registerHandler",["backButton"])}function Ra(){return!(!zr(ur)||!ur.supports.pages)&&!!ur.supports.pages.backStack}function Fa(e){return new Promise((t=>{if(zr(ur,ln.content,ln.sidePanel,ln.settings,ln.task,ln.stage,ln.meetingStage),!Ma())throw mn;t(vc(tr(Xa,"pages.currentApp.navigateTo"),"pages.currentApp.navigateTo",e))}))}function ka(){return new Promise((e=>{if(zr(ur,ln.content,ln.sidePanel,ln.settings,ln.task,ln.stage,ln.meetingStage),!Ma())throw mn;e(vc(tr(Xa,"pages.currentApp.navigateToDefaultPage"),"pages.currentApp.navigateToDefaultPage"))}))}function Ma(){return!(!zr(ur)||!ur.supports.pages)&&!!ur.supports.pages.currentApp}function xa(){if(zr(ur,ln.content),!Da())throw mn;Ic(tr(Xa,"pages.fullTrust.enterFullscreen"),"enterFullscreen",[])}function Na(){if(zr(ur,ln.content),!Da())throw mn;Ic(tr(Xa,"pages.fullTrust.exitFullscreen"),"exitFullscreen",[])}function Da(){return!(!zr(ur)||!ur.supports.pages)&&!!ur.supports.pages.fullTrust}function Ua(e){return ts(tr(Xa,"pages.tabs.navigateToTab"),e)}function La(e){return rs(tr(Xa,"pages.tabs.getTabInstances"),e)}function Ha(e){return os(tr(Xa,"pages.tabs.getMruTabInstances"),e)}function _a(){return!(!zr(ur)||!ur.supports.pages)&&!!ur.supports.pages.tabs}var Va,Ba;function Wa(e){const t=tr(Xa,"pages.returnFocus");if(zr(ur),!Za())throw mn;if(void 0===e&&Ic(t,"returnFocus",[!1]),"boolean"==typeof e)Ic(t,"returnFocus",[e]);else switch(e){case Ba.PreviousLandmark:case Ba.GoToActivityFeed:Ic(t,"returnFocus",[!1,e]);break;case Ba.NextLandmark:Ic(t,"returnFocus",[!0,e])}}function ja(e){Ts(tr(Xa,"pages.registerFocusEnterHandler"),"focusEnter",e,[],(()=>{if(!Za())throw mn}))}function za(e){as(tr(Xa,"pages.setCurrentFrame"),e)}function qa(e,t,n){ga(),Xi(tr(Xa,"pages.initializeWithFrameContext"),n).then((()=>t&&t())),za(e)}function $a(){return cs(tr(Xa,"pages.getConfig."))}function Ga(e){return Ya(tr(Xa,"pages.navigateCrossDomain"),e)}function Ja(e){return new Promise((t=>{if(zr(ur,ln.content,ln.sidePanel,ln.settings,ln.task,ln.stage,ln.meetingStage),!Za())throw mn;const n=tr(Xa,"pages.navigateToApp");if(ur.isLegacyTeams){t(hc(n,"executeDeepLink",Rn(ls(e)?e:ds(e))))}else{t(hc(n,"pages.navigateToApp",ls(e)?fs(e):e))}}))}function Ka(e){return is(tr(Xa,"pages.shareDeepLink"),e)}function Qa(e){Ts(tr(Xa,"pages.registerFullScreenHandler"),"fullScreenChange",e,[],(()=>{if(!oo(e)&&!Za())throw mn}))}function Za(){return!(!zr(ur)||!ur.supports.pages)}ga(),function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.Read=2]="Read",e[e.Compose=3]="Compose"}(Va||(Va={})),function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.GoToActivityFeed=2]="GoToActivityFeed"}(Ba||(Ba={}));const Xa="v2";function Ya(e,t){return new Promise((n=>{if(zr(ur,ln.content,ln.sidePanel,ln.settings,ln.remove,ln.task,ln.stage,ln.meetingStage),!Za())throw mn;n(mc(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))}))}function es(e){return new Promise((t=>{if(zr(ur),!Ra())throw mn;t(mc(e,"navigateBack","Back navigation is not supported in the current client or context."))}))}function ts(e,t){return new Promise((n=>{if(zr(ur),!_a())throw mn;n(mc(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))}))}function ns(e,t){if(zr(ur),!Za())throw mn;Ic(e,"returnFocus",[t])}function rs(e,t){return new Promise((n=>{if(zr(ur),!_a())throw mn;n(gc(e,"getTabInstances",t))}))}function os(e,t){return new Promise((n=>{if(zr(ur),!_a())throw mn;n(gc(e,"getMruTabInstances",t))}))}function is(e,t){if(zr(ur,ln.content,ln.sidePanel,ln.meetingStage),!Za())throw mn;Ic(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function as(e,t){if(zr(ur,ln.content),!Za())throw mn;Ic(e,"setFrameContext",[t])}function ss(e,t){if(zr(ur,ln.settings,ln.remove),!$i())throw mn;Ic(e,"settings.setValidityState",[t])}function cs(e){return new Promise((t=>{if(zr(ur,ln.content,ln.settings,ln.remove,ln.sidePanel),!Za())throw mn;t(gc(e,"settings.getSettings"))}))}function us(e,t){return new Promise((n=>{if(zr(ur,ln.content,ln.settings,ln.sidePanel),!$i())throw mn;n(hc(e,"settings.setSettings",t))}))}function ls(e){return e.appId instanceof ro}function ds(e){return Object.assign(Object.assign({},e),{appId:new ro(e.appId),webUrl:e.webUrl?new URL(e.webUrl):void 0})}function fs(e){return Object.assign(Object.assign({},e),{appId:e.appId.toString(),webUrl:e.webUrl?e.webUrl.toString():void 0})}let ps;function gs(e){ps=e}function hs(){Es(tr(Xa,"pages.backStack.registerBackButtonPressHandler"),"backButtonPress",ms,!1)}function ms(){ps&&ps()||(qs()?Xs("backButtonPress",[]):Pa())}var vs=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const ws=er("handlers");class Cs{static initializeHandlers(){Cs.handlers.themeChange=Fs,Cs.handlers.contextChange=ks,Cs.handlers.load=Ds,Cs.handlers.beforeUnload=Hs,hs()}static uninitializeHandlers(){Cs.handlers={},Cs.themeChangeHandler=null,Cs.beforeUnloadHandler=null,Cs.beforeSuspendOrTerminateHandler=null,Cs.resumeHandler=null,Cs.contextChangeHandler=null}}function ys(){Cs.initializeHandlers()}function Ss(){Cs.uninitializeHandlers()}Cs.handlers={},Cs.themeChangeHandler=null,Cs.loadHandler=null,Cs.beforeUnloadHandler=null,Cs.beforeSuspendOrTerminateHandler=null,Cs.resumeHandler=null,Cs.hostToAppPerformanceMetricsHandler=null,Cs.contextChangeHandler=null;const bs=ws.extend("callHandler");function As(e,t){const n=Cs.handlers[e];if(n){bs("Invoking the registered handler for message %s with arguments %o",e,t);return[!0,n.apply(this,t)]}return qs()?(Xs(e,t),[!1,void 0]):(bs("Handler for action message %s not found.",e),[!1,void 0])}function Es(e,t,n,r=!0,o=[]){n?(Cs.handlers[t]=n,r&&Ic(e,"registerHandler",[t,...o])):delete Cs.handlers[t]}function Is(e){delete Cs.handlers[e]}function Ps(e){return null!=Cs.handlers[e]}function Ts(e,t,n,r,o){n&&zr(ur,...r),o&&o(),Es(e,t,n)}function Os(e,t){Cs.themeChangeHandler=t,!oo(t)&&Ic(e,"registerHandler",["themeChange"])}function Rs(e,t){Cs.contextChangeHandler=t,!oo(t)&&Ic(e,"registerHandler",["contextChange"])}function Fs(e){Cs.themeChangeHandler&&Cs.themeChangeHandler(e),qs()&&Xs("themeChange",[e])}function ks(e){Cs.contextChangeHandler&&Cs.contextChangeHandler(e),qs()&&Xs("contextChange",[e])}function Ms(e){Cs.hostToAppPerformanceMetricsHandler=e}function xs(e){Cs.hostToAppPerformanceMetricsHandler&&Cs.hostToAppPerformanceMetricsHandler(e)}function Ns(e,t){Cs.loadHandler=t,!oo(t)&&Ic(e,"registerHandler",["load"])}function Ds(e){const t=Us(e);Cs.resumeHandler?(Cs.resumeHandler(t),qs()&&Xs("load",[t])):Cs.loadHandler&&(Cs.loadHandler(e),qs()&&Xs("load",[e]))}function Us(e){return{entityId:e.entityId,contentUrl:new URL(e.contentUrl)}}function Ls(e,t){Cs.beforeUnloadHandler=t,!oo(t)&&Ic(e,"registerHandler",["beforeUnload"])}function Hs(){return vs(this,void 0,void 0,(function*(){const e=()=>{Ic(tr("v2","handleBeforeUnload"),"readyToUnload",[])};Cs.beforeSuspendOrTerminateHandler?(yield Cs.beforeSuspendOrTerminateHandler(),qs()?Xs("beforeUnload"):e()):Cs.beforeUnloadHandler&&Cs.beforeUnloadHandler(e)||(qs()?Xs("beforeUnload"):e())}))}function _s(e){Cs.beforeSuspendOrTerminateHandler=e,!oo(e)&&Ic(tr("v2","registerBeforeSuspendOrTerminateHandler"),"registerHandler",["beforeUnload"])}function Vs(e){Cs.resumeHandler=e,!oo(e)&&Ic(tr("v2","registerOnResumeHandler"),"registerHandler",["load"])}var Bs=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Ws=er("childProxyingCommunication");class js{}function zs(){js.window=null,js.origin=null,js.messageQueue=[]}function qs(){return!!Tr()&&!!js.window}function $s(e,t){return!!Tr()&&(js.window&&!js.window.closed&&e!==js.window||(js.window=e,js.origin=t),js.window&&js.window.closed?(js.window=null,js.origin=null,!1):js.window===e)}function Gs(e,t,n,r){return Bs(this,void 0,void 0,(function*(){js.window===t&&(_r(js.window,js.origin,js.messageQueue,"child"),Ks(e,n,r))}))}js.messageQueue=[];const Js=Ws.extend("handleIncomingMessageFromChild");function Ks(e,t,n){if(void 0===e.data.id||void 0===e.data.func)return;const r=Nr(e.data),[o,i]=As(r.func,r.args);if(o&&void 0!==i)return Js("Handler called in response to message %s from child. Returning response from handler to child, action: %s.",Lr(r),r.func),void Zs(r.id,r.uuid,Array.isArray(i)?i:[i]);Js("No handler for message %s from child found; relaying message on to parent, action: %s. Relayed message will have a new id.",Lr(r),r.func),Qs(r,t,n)}function Qs(e,t,n){const r=t(tr("v2","tasks.startTask"),e.func,e.args,!0,e.teamsJsInstanceId),o=js.origin;n(r.uuid,((...t)=>{if(!js.window)return;if(!Rr().disableEnforceOriginMatchForChildResponses&&o!==js.origin)return void Js("Origin of child window has changed, not sending response back to child window");const n=t.pop();Js("Message from parent being relayed to child, id: %s",Lr(e)),Zs(e.id,e.uuid,t,n)}))}function Zs(e,t,n,r){const o=js.window,i=Ys(e,t,n,r),a=Ur(i),s=js.origin;o&&s&&(Js("Sending message %s to %s via postMessage, args = %o",Lr(a),"child",a.args),o.postMessage(a,s))}function Xs(e,t){const n=js.window,r=ec(e,t),o=js.origin;n&&o?n.postMessage(r,o):js.messageQueue.push(r)}function Ys(e,t,n,r){return{id:e,uuid:t,args:n||[],isPartialResponse:r}}function ec(e,t){return{func:e,args:t||[]}}class tc{static storeCallbackInformation(e,t){tc.callbackInformation.set(e,t)}static clearMessages(){tc.callbackInformation.clear()}static deleteMessageInformation(e){tc.callbackInformation.delete(e)}static handleOneWayPerformanceMetrics(e,t,n){const r=e.monotonicTimestamp;r&&n?xs({actionName:e.func,messageDelay:n-r,requestStartedAt:r}):t("Unable to send performance metrics for event %s",e.func)}static handlePerformanceMetrics(e,t,n,r){const o=tc.callbackInformation.get(e);o&&t.monotonicTimestamp&&r?(xs({actionName:o.name,messageDelay:r-t.monotonicTimestamp,requestStartedAt:o.calledAt}),tc.deleteMessageInformation(e)):n("Unable to send performance metrics for callback %s with arguments %o",e.toString(),t.args)}}tc.callbackInformation=new Map;const nc=er("nestedAppAuthUtils"),rc=nc.extend("tryPolyfillWithNestedAppAuthBridge"),oc="v2";function ic(e,t,n){var r;const o=rc;if(Kn.isFramelessWindow)return void o("Cannot polyfill nestedAppAuthBridge as current window is frameless");if(!t)return void o("Cannot polyfill nestedAppAuthBridge as current window does not exist");if(t.parent!==t.top)return void o("Default NAA bridge injection not supported in nested iframe. Use standalone NAA bridge instead.");const i=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!i||!(null===(r=i.supports)||void 0===r?void 0:r.nestedAppAuth))return void o("Cannot polyfill nestedAppAuthBridge as current hub does not support nested app auth");const a=t;if(a.nestedAppAuthBridge)return void o("nestedAppAuthBridge already exists on current window, skipping polyfill");const s=sc(a,n);s&&(a.nestedAppAuthBridge=s)}const ac=nc.extend("createNestedAppAuthBridge");function sc(e,t){const n=ac;if(!e)return n("nestedAppAuthBridge cannot be created as current window does not exist"),null;const{onMessage:r,sendPostMessage:o}=t,i=e=>t=>r(t,e);return{addEventListener:(t,r)=>{"message"===t?e.addEventListener(t,i(r)):n(`Event ${t} is not supported by nestedAppAuthBridge`)},postMessage:e=>{const t=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!t||"object"!=typeof t||"NestedAppAuthRequest"!==t.messageType)return void n("Unrecognized data format received by app, message being ignored. Message: %o",e);const r=tr(oc,"nestedAppAuth.execute");o(e,r)},removeEventListener:(t,n)=>{e.removeEventListener(t,i(n))}}}var cc=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const uc=er("communication");class lc{}class dc{}function fc(e,t){if(dc.messageListener=e=>xc(e),lc.currentWindow=lc.currentWindow||Nn(),lc.parentWindow=lc.currentWindow.parent!==lc.currentWindow.self?lc.currentWindow.parent:lc.currentWindow.opener,lc.topWindow=lc.currentWindow.top,(lc.parentWindow||e)&&lc.currentWindow.addEventListener("message",dc.messageListener,!1),!lc.parentWindow){const e=lc.currentWindow;if(!e.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));Kn.isFramelessWindow=!0,e.onNativeMessage=jc}try{return lc.parentOrigin="*",wc(t,"initialize",[Er,ir,e]).then((([e,t,n,r])=>(ic(r,lc.currentWindow,{onMessage:Dc,sendPostMessage:Tc}),{context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r})))}finally{lc.parentOrigin=null}}function pc(){lc.currentWindow&&lc.currentWindow.removeEventListener("message",dc.messageListener,!1),lc.currentWindow=null,lc.parentWindow=null,lc.parentOrigin=null,dc.parentMessageQueue=[],dc.nextMessageId=0,dc.callbacks.clear(),dc.promiseCallbacks.clear(),dc.portCallbacks.clear(),dc.legacyMessageIdsToUuidMap={},tc.clearMessages(),zs()}function gc(e,t,...n){return wc(e,t,n).then((([e])=>e))}function hc(e,t,...n){return wc(e,t,n).then((([e,t])=>{if(!e)throw new Error(t)}))}function mc(e,t,n,...r){return wc(e,t,r).then((([e,t])=>{if(!e)throw new Error(t||n)}))}function vc(e,t,...n){return wc(e,t,n).then((([e,t])=>{if(e)throw e;return t}))}function wc(e,t,n=void 0){if(!nr(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return new Promise((r=>{r(Ec(kc(e,t,n).uuid))}))}function Cc(e){return e.map((e=>Ar(e)?e.serialize():e))}function yc(e,t,n,r,o){var i;return cc(this,void 0,void 0,(function*(){const a=Cc(t),[s]=yield wc(r,e,a);if(o&&o(s)||!o&&qe(s))throw new Error(`${s.errorCode}, message: ${null!==(i=s.message)&&void 0!==i?i:"None"}`);if(n.validate(s))return n.deserialize(s);throw new Error(`${Le.INTERNAL_ERROR}, message: Invalid response from host - ${JSON.stringify(s)}`)}))}function Sc(e,t,n,r){var o;return cc(this,void 0,void 0,(function*(){const i=Cc(t),[a]=yield wc(n,e,i);if(r&&r(a)||!r&&qe(a))throw new Error(`${a.errorCode}, message: ${null!==(o=a.message)&&void 0!==o?o:"None"}`);if(void 0!==a)throw new Error(`${Le.INTERNAL_ERROR}, message: Invalid response from host`)}))}function bc(e,t,n=void 0){if(!nr(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return Ac(kc(e,t,n).uuid)}function Ac(e){return new Promise(((t,n)=>{dc.portCallbacks.set(e,((e,r)=>{e instanceof MessagePort?t(e):n(r&&r.length>0?r[0]:new Error("Host responded without port or error details."))}))}))}function Ec(e){return new Promise((t=>{dc.promiseCallbacks.set(e,t)}))}function Ic(e,t,n,r){let o;if(n instanceof Function?r=n:n instanceof Array&&(o=n),!nr(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);const i=kc(e,t,o);r&&dc.callbacks.set(i.uuid,r)}dc.parentMessageQueue=[],dc.topMessageQueue=[],dc.nextMessageId=0,dc.callbacks=new Map,dc.promiseCallbacks=new Map,dc.portCallbacks=new Map,dc.legacyMessageIdsToUuidMap={};const Pc=uc.extend("sendNestedAuthRequestToTopWindow");function Tc(e,t){const n=Pc,r=lc.topWindow,o=Zc(e,t);return n("Message %s information: %o",Lr(o),{actionName:o.func}),Rc(r,o)}const Oc=uc.extend("sendRequestToTargetWindowHelper");function Rc(e,t){const n=Oc,r=Jc(e),o=xr(t);if(Kn.isFramelessWindow)lc.currentWindow&&lc.currentWindow.nativeInterface&&(n("Sending message %s to %s via framelessPostMessage interface",Lr(o),r),lc.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(o)));else{const i=Gc(e);e&&i?(n("Sending message %s to %s via postMessage",Lr(o),r),e.postMessage(o,i)):(n("Adding message %s to %s message queue",Lr(o),r),$c(e).push(t))}return t}const Fc=uc.extend("sendMessageToParentHelper");function kc(e,t,n,r,o){const i=Fc,a=lc.parentWindow,s=Qc(e,t,n,r,o);return tc.storeCallbackInformation(s.uuid,{name:t,calledAt:s.timestamp}),i("Message %s information: %o",Lr(s),{actionName:t,args:n}),Rc(a,s)}const Mc=uc.extend("processIncomingMessage");function xc(e){return cc(this,void 0,void 0,(function*(){if(!e||!e.data||"object"!=typeof e.data)return void Mc("Unrecognized message format received by app, message being ignored. Message: %o",e);const t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;return Lc(t,n).then((r=>{r?(Hc(t,n),t!==lc.parentWindow?$s(t,n)&&Gs(e,t,kc,((e,t)=>dc.callbacks.set(e,t))):jc(e)):Mc("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin, message: %o, source: %o, origin: %o",e,t,n)}))}))}const Nc=uc.extend("processAuthBridgeMessage");function Dc(e,t){var n,r;const o=Nc;if(!e||!e.data||"object"!=typeof e.data)return void o("Unrecognized message format received by app, message being ignored. Message: %o",e);const{args:i}=e.data,[,a]=null!=i?i:[],s=(()=>{try{return JSON.parse(a)}catch(e){return null}})();if(!s||"object"!=typeof s||"NestedAppAuthResponse"!==s.messageType)return void o("Unrecognized data format received by app, message being ignored. Message: %o",e);const c=e.source||(null===(n=null==e?void 0:e.originalEvent)||void 0===n?void 0:n.source),u=e.origin||(null===(r=null==e?void 0:e.originalEvent)||void 0===r?void 0:r.origin);c?Lc(c,u)?(lc.topWindow&&!lc.topWindow.closed&&c!==lc.topWindow||(lc.topWindow=c,lc.topOrigin=u),lc.topWindow&&lc.topWindow.closed&&(lc.topWindow=null,lc.topOrigin=null),_r(lc.topWindow,lc.topOrigin,dc.topMessageQueue,"top"),t(a)):o("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin"):o("Message being ignored by app because it is coming for a target that is null")}const Uc=uc.extend("shouldProcessIncomingMessage");function Lc(e,t){return cc(this,void 0,void 0,(function*(){if(lc.currentWindow&&e===lc.currentWindow)return Uc("Should not process message because it is coming from the current window"),!1;if(lc.currentWindow&&lc.currentWindow.location&&t&&t===lc.currentWindow.location.origin)return!0;{let e;try{e=new URL(t)}catch(e){return Uc("Message has an invalid origin of %s",t),!1}const n=yield Ca(e);return n||Uc("Message has an invalid origin of %s",t),n}}))}function Hc(e,t){Kn.isFramelessWindow||lc.parentWindow&&!lc.parentWindow.closed&&e!==lc.parentWindow||(lc.parentWindow=e,lc.parentOrigin=t),lc.parentWindow&&lc.parentWindow.closed&&(lc.parentWindow=null,lc.parentOrigin=null),_r(lc.parentWindow,lc.parentOrigin,dc.parentMessageQueue,"parent")}const _c=uc.extend("handleIncomingMessageFromParent");function Vc(e){const t=_c;if(!e.uuid)return dc.legacyMessageIdsToUuidMap[e.id];{const t=e.uuid,n=Bc(dc.callbacks,t);if(n)return n;const r=Bc(dc.promiseCallbacks,t);if(r)return r;const o=Bc(dc.portCallbacks,t);if(o)return o}t("Received message %s that failed to produce a callbackId",Lr(e))}function Bc(e,t){if(t){const n=[...e].find((([e,n])=>e.toString()===t.toString()));if(n)return n[0]}}function Wc(e,t){const n=Bc(t,e.uuid);n&&t.delete(n),e.uuid?dc.legacyMessageIdsToUuidMap={}:delete dc.legacyMessageIdsToUuidMap[e.id]}function jc(e){const t=_c,n=zn();if("id"in e.data&&"number"==typeof e.data.id){const r=e.data,o=Dr(r),i=Vc(o);if(i){const r=dc.callbacks.get(i);t("Received a response from parent for message %s",i.toString()),tc.handlePerformanceMetrics(i,o,t,n),r&&(t("Invoking the registered callback for message %s with arguments %o",i.toString(),o.args),r.apply(null,[...o.args,o.isPartialResponse]),zc(e)||(t("Removing registered callback for message %s",i.toString()),Wc(o,dc.callbacks)));const a=dc.promiseCallbacks.get(i);a&&(t("Invoking the registered promise callback for message %s with arguments %o",i.toString(),o.args),a(o.args),t("Removing registered promise callback for message %s",i.toString()),Wc(o,dc.promiseCallbacks));const s=dc.portCallbacks.get(i);if(s){let n;t("Invoking the registered port callback for message %s with arguments %o",i.toString(),o.args),e.ports&&e.ports[0]instanceof MessagePort&&(n=e.ports[0]),s(n,o.args),t("Removing registered port callback for message %s",i.toString()),Wc(o,dc.portCallbacks)}o.uuid&&(dc.legacyMessageIdsToUuidMap={})}}else if("func"in e.data&&"string"==typeof e.data.func){const r=e.data;tc.handleOneWayPerformanceMetrics(r,t,n),t('Received a message from parent %s, action: "%s"',Lr(r),r.func),As(r.func,r.args)}else t("Received an unknown message: %O",e)}function zc(e){return!0===e.data.isPartialResponse}function qc(){return lc.topWindow!==lc.parentWindow}function $c(e){return e===lc.topWindow&&qc()?dc.topMessageQueue:e===lc.parentWindow?dc.parentMessageQueue:[]}function Gc(e){return e===lc.topWindow&&qc()?lc.topOrigin:e===lc.parentWindow?lc.parentOrigin:null}function Jc(e){return e===lc.topWindow&&qc()?"top":e===lc.parentWindow?"parent":null}function Kc(e,t){let n;n=lc.currentWindow.setInterval((()=>{0===$c(e).length&&(clearInterval(n),t())}),100)}function Qc(e,t,n,r,o){const i=dc.nextMessageId++,a=new Gn;dc.legacyMessageIdsToUuidMap[i]=a;const s=!0===r?o:Kn.teamsJsInstanceId;return{id:i,uuid:a,func:t,timestamp:Date.now(),monotonicTimestamp:zn(),args:n||[],apiVersionTag:e,isProxiedFromChild:null!=r&&r,teamsJsInstanceId:s}}function Zc(e,t){const n=dc.nextMessageId++,r=new Gn;return dc.legacyMessageIdsToUuidMap[n]=r,{id:n,uuid:r,func:"nestedAppAuth.execute",timestamp:Date.now(),monotonicTimestamp:zn(),apiVersionTag:t,args:[],data:e}}const Xc="v1";function Yc(e){if(!oo(e)&&zr(ur),!oo(e)&&!eu())throw mn;e?Es(tr(Xc,"log.request"),"log.request",(()=>{const t=e();Ic(tr(Xc,"log.receive"),"log.receive",[t])})):Is("log.request")}function eu(){return!(!zr(ur)||!ur.supports.logs)}var tu,nu,ru;!function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(tu||(tu={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(nu||(nu={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(ru||(ru={}));const ou="v1";function iu(e,t){zr(ur),Ic(tr(ou,"uploadCustomApp"),"uploadCustomApp",[e],t||Sn())}function au(e,t,n){zr(ur),Ic(tr(ou,"sendCustomMessage"),e,t,n)}function su(e,t){if(zr(ur),!qs())throw new Error("The child window has not yet been initialized or is not present");Xs(e,t)}function cu(e,t){zr(ur),Es(tr(ou,"registerCustomHandler"),e,((...e)=>t.apply(this,e)))}function uu(e,t){zr(ur),Es(tr(ou,"registerUserSettingsChangeHandler"),"userSettingsChange",t,!0,[e])}function lu(e){zr(ur,ln.content,ln.sidePanel,ln.task);const t=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId,e.sizeInBytes];Ic(tr(ou,"openFilePreview"),"openFilePreview",t)}const du="v1";function fu(e){return new Promise((t=>{if(zr(ur,ln.content),!hu())throw mn;const n=hc(tr(du,"conversations.openConversation"),"conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&Es(tr(du,"conversations.registerStartConversationHandler"),"startConversation",((t,n,r,o)=>{var i;return null===(i=e.onStartConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:o})})),e.onCloseConversation&&Es(tr(du,"conversations.registerCloseConversationHandler"),"closeConversation",((t,n,r,o)=>{var i;return null===(i=e.onCloseConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:o})})),t(n)}))}function pu(){if(zr(ur,ln.content),!hu())throw mn;Ic(tr(du,"conversations.closeConversation"),"conversations.closeConversation"),Is("startConversation"),Is("closeConversation")}function gu(){return new Promise((e=>{if(zr(ur),!hu())throw mn;e(gc(tr(du,"conversations.getChatMember"),"getChatMembers"))}))}function hu(){return!(!zr(ur)||!ur.supports.conversations)}var mu=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const vu="v2",wu=er("copilot");function Cu(){var e;return zr(ur)&&!!(null===(e=ur.supports.copilot)||void 0===e?void 0:e.customTelemetry)}function yu(e,t){var n;return void 0===t&&(t=null!==(n=zn())&&void 0!==n?n:Date.now()),mu(this,void 0,void 0,(function*(){return zr(ur),wu("Sending custom telemetry data to host for stage: %s to record timestamp: %s",e,t),Sc("copilot.customTelemetry.sendCustomTelemetryData",[e.toString(),t],tr(vu,"copilot.customTelemetry.sendCustomTelemetryData"))}))}var Su=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const bu="v2",Au=er("copilot");function Eu(){var e,t;return zr(ur)&&(!!(null===(e=ur.hostVersionsInfo)||void 0===e?void 0:e.appEligibilityInformation)||!!(null===(t=ur.supports.copilot)||void 0===t?void 0:t.eligibility))}function Iu(e){var t,n,r;return Su(this,void 0,void 0,(function*(){if(zr(ur),!Eu())throw new Error(`Error code: ${mn.errorCode}, message: Not supported on platform`);if((null===(t=ur.hostVersionsInfo)||void 0===t?void 0:t.appEligibilityInformation)&&!e)return Au("Eligibility information is already available on runtime."),ur.hostVersionsInfo.appEligibilityInformation;Au("Eligibility information is not available on runtime. Requesting from host.");const o=yield gc(tr(bu,"copilot.eligibility.getEligibilityInfo"),"copilot.eligibility.getEligibilityInfo",e);if(qe(o))throw new Error(`Error code: ${o.errorCode}, message: ${null!==(n=o.message)&&void 0!==n?n:"Failed to get eligibility information from the host."}`);if(!Pu(o))throw new Error("Error deserializing eligibility information");return"nonadult"===(null===(r=o.ageGroup)||void 0===r?void 0:r.toLowerCase())&&(o.ageGroup=Be.NotAdult),o}))}function Pu(e){return void 0!==e.ageGroup&&void 0!==e.cohort&&void 0!==e.userClassification&&void 0!==e.isCopilotEligible&&void 0!==e.isCopilotEnabledRegion&&void 0!==e.isOptedOutByAdmin&&(!e.featureSet||void 0!==e.featureSet.serverFeatures&&void 0!==e.featureSet.uxFeatures)}var Tu,Ou,Ru,Fu,ku,Mu,xu,Nu,Du;!function(e){e.EMAIL="email",e.TEXT="text",e.MEDIA="media",e.CALENDAR_INVITE="calendarInvite",e.WEB_PAGE="webPage",e.MIXED="mixed",e.TEAMS="teams",e.FILE="file"}(Tu||(Tu={})),function(e){e.IMAGE="image",e.AUDIO="audio",e.VIDEO="video"}(Ou||(Ou={})),function(e){e.Private="Private",e.Shared="Shared",e.Recap="Recap",e.RecapCall="RecapCall",e.PrivateViewCall="PrivateViewCall",e.Chat="Chat",e.Compose="Compose"}(Ru||(Ru={})),function(e){e.ClientDeviceType="ClientDeviceType",e.ClientRing="ClientRing",e.ClientScenarioName="ClientScenarioName"}(Fu||(Fu={})),function(e){e.Enabled="enabled",e.Disabled="disabled",e.EnabledWithTranscript="enabledWithTranscript"}(ku||(ku={})),function(e){e.NotStarted="notStarted",e.Active="active",e.Inactive="inactive",e.UnknownFutureValue="unknownFutureValue"}(Mu||(Mu={})),function(e){e.Chat="Chat",e.Channel="Channel",e.Meeting="Meeting",e.MeetingChat="MeetingChat"}(xu||(xu={})),function(e){e.Accepted="accepted",e.NotAccepted="not_accepted"}(Nu||(Nu={})),function(e){e.ConsentNotAccepted="consent_not_accepted",e.PageContentBlockedPolicy="page_content_blocked_policy",e.PageContentBlockedDlp="page_content_blocked_dlp",e.PageContentTypeNotSupportedYet="page_content_type_not_supported_yet",e.PageContentSizeNotSupported="page_content_size_not_supported",e.PageContextChanged="page_context_changed",e.PageContentExtractionFailed="page_content_extraction_failed",e.PageContentSizeNotSupportedPDF="page_content_size_not_supported_pdf",e.NotSupportedOnPlatform="not_supported_on_platform",e.OtherError="other_error"}(Du||(Du={}));class Uu extends Error{constructor(e,t){super(t),this.errorCode=e,this.name="SidePanelError"}}var Lu=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Hu="v2";function _u(){var e;return zr(ur)&&!!(null===(e=ur.supports.copilot)||void 0===e?void 0:e.sidePanel)}function Vu(e){if("object"!=typeof e||null===e)return!1;const t=e;return Object.values(Du).includes(t.errorCode)&&(void 0===t.message||"string"==typeof t.message)||qe(e)}function Bu(e){return Lu(this,void 0,void 0,(function*(){zr(ur);return yc("copilot.sidePanel.getContent",e?[new Gu(e)]:[],new qu,tr(Hu,"copilot.sidePanel.getContent"),Vu)}))}function Wu(e){return Lu(this,void 0,void 0,(function*(){zr(ur);return yc("copilot.sidePanel.preCheckUserConsent",e?[new Ju(e)]:[],new $u,tr(Hu,"copilot.sidePanel.preCheckUserConsent"),Vu)}))}function ju(e){Ts(tr(Hu,"copilot.sidePanel.registerUserActionContentSelect"),"copilot.sidePanel.userActionContentSelect",e,[ln.content],(()=>{if(!_u())throw zu}))}const zu=new Uu(Du.NotSupportedOnPlatform,"This API is not supported on the current platform.");class qu extends Gi{validate(e){return null!==e&&"object"==typeof e}deserialize(e){return e}}class $u extends Gi{validate(e){return null!==e&&"object"==typeof e}deserialize(e){return e}}class Gu{constructor(e){this.contentRequest=e}serialize(){return this.contentRequest}}class Ju{constructor(e){this.userConsentRequest=e}serialize(){return this.userConsentRequest}}var Ku=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Qu="v2";function Zu(){var e;return zr(ur)&&!!(null===(e=ur.supports.copilot)||void 0===e?void 0:e.view)}function Xu(){return Ku(this,void 0,void 0,(function*(){zr(ur),yield yc("copilot.view.closeSidePanel",[],new Yu,tr(Qu,"copilot.view.closeSidePanel"))}))}class Yu extends Gi{validate(e){return!0}deserialize(e){return e}}const el="v2";class tl{constructor(e){this.invokeRequest=e}serialize(){return this.invokeRequest}}function nl(e){const t=e;return t.responseType===il.ActionExecuteInvokeResponse&&void 0!==t.value&&void 0!==t.statusCode&&void 0!==t.type}const rl="Action.Execute";var ol,il,al,sl;!function(e){e.ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",e.QueryMessageExtensionRequest="QueryMessageExtensionRequest"}(ol||(ol={})),function(e){e.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",e.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(il||(il={}));class cl extends Gi{validate(e){return nl(e)}deserialize(e){return e}}function ul(e){if("object"!=typeof e||null===e)return!1;const t=e;return Object.values(al).includes(t.errorCode)&&(void 0===t.message||"string"==typeof t.message)}function ll(e){e.requestType===ol.ActionExecuteInvokeRequest?dl(e):e.requestType===ol.QueryMessageExtensionRequest&&fl(e)}function dl(e){if(e.type!==rl){throw{errorCode:al.INTERNAL_ERROR,message:`Invalid action type ${e.type}. Action type must be "${rl}"`}}if(!qn(e.data)){throw{errorCode:al.INTERNAL_ERROR,message:`Invalid data type ${typeof e.data}. Data must be a primitive or a plain object.`}}}function fl(e){if(e.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(e.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(const t of e.parameters){if(t.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(t.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}function pl(e,t,n){if(zr(ur,ln.content),!Al())throw mn;const r=new ro(e);return ll(n),wc(tr(el,"externalAppAuthentication.authenticateAndResendRequest"),"externalAppAuthentication.authenticateAndResendRequest",[r.toString(),n,t.url.href,t.width,t.height,t.isExternal]).then((([e,t])=>{if(e&&null!=t.responseType)return t;throw t}))}function gl(e,t){if(zr(ur,ln.content),!Al())throw mn;const n=new ro(e);return wc(tr(el,"externalAppAuthentication.authenticateWithSSO"),"externalAppAuthentication.authenticateWithSSO",[n.toString(),t.claims,t.silent]).then((([e,t])=>{if(!e)throw t}))}function hl(e,t,n){if(zr(ur,ln.content),!Al())throw mn;const r=new ro(e);return ll(n),wc(tr(el,"externalAppAuthentication.authenticateWithSSOAndResendRequest"),"externalAppAuthentication.authenticateWithSSOAndResendRequest",[r.toString(),n,t.claims,t.silent]).then((([e,t])=>{if(e&&null!=t.responseType)return t;throw t}))}function ml(e,t,n){if(zr(ur,ln.content),!Al())throw mn;return Un(e,new Error("titleId is Invalid.")),Un(t,new Error("oauthConfigId is Invalid.")),wc(tr(el,"externalAppAuthentication.authenticateWithOauth2"),"externalAppAuthentication.authenticateWithOauth2",[e,t,n.width,n.height,n.isExternal]).then((([e,t])=>{if(!e)throw t}))}function vl(e,t,n){if(zr(ur,ln.content),!Al())throw mn;return Un(e,new Error("titleId is Invalid.")),t&&Ln(t),wc(tr(el,"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins"),"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins",[e,null==t?void 0:t.toString(),null==n?void 0:n.width,null==n?void 0:n.height,null==n?void 0:n.isExternal]).then((([e,t])=>{if(!e)throw t}))}!function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(al||(al={}));class wl{constructor(e){this.param=e}serialize(){var e,t,n;return{connectorId:this.param.connectorId,oAuthConfigId:this.param.oAuthConfigId,traceId:null!==(n=null===(t=null===(e=this.param.traceId)||void 0===e?void 0:e.toString)||void 0===t?void 0:t.call(e))&&void 0!==n?n:this.param.traceId,windowParameters:this.param.windowParameters?Object.assign({},this.param.windowParameters):void 0}}}function Cl(e){if(zr(ur,ln.content),!Al())throw mn;return Un(e.connectorId,new Error("connectorId is Invalid.")),Un(e.oAuthConfigId,new Error("oauthConfigId is Invalid.")),Sc("externalAppAuthentication.authenticateWithConnector",[new wl(e)],tr(el,"externalAppAuthentication.authenticateWithConnector"),ul)}!function(e){e.Invalid="Invalid",e.Valid="Valid",e.Expired="Expired"}(sl||(sl={}));class yl extends Gi{validate(e){return"string"==typeof e&&e in sl}deserialize(e){return e}}function Sl(e){if(zr(ur,ln.content),!Al())throw mn;return Un(e.connectorId,new Error("connectorId is Invalid.")),Un(e.oAuthConfigId,new Error("oAuthConfigId is Invalid.")),yc("externalAppAuthentication.getUserAuthenticationStateForConnector",[new wl(e)],new yl,tr(el,"externalAppAuthentication.getUserAuthenticationStateForConnector"),ul)}function bl(e){if(zr(ur,ln.content),!Al())throw mn;return Un(e.connectorId,new Error("connectorId is Invalid.")),Un(e.oAuthConfigId,new Error("oauthConfigId is Invalid.")),Sc("externalAppAuthentication.disconnectConnector",[new wl(e)],tr(el,"externalAppAuthentication.disconnectConnector"),ul)}function Al(){return!(!zr(ur)||!ur.supports.externalAppAuthentication)}var El=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Il="v2";function Pl(e,t,n){return El(this,void 0,void 0,(function*(){if(zr(ur,ln.content),!Fl())throw mn;return kl(e,t),Sc("externalAppAuthenticationForCEA.authenticateWithSSO",[e,t,n.authId,n.connectionName,n.claims,n.silent],tr(Il,"externalAppAuthenticationForCEA.authenticateWithSSO"),ul)}))}function Tl(e,t,n){return El(this,void 0,void 0,(function*(){if(zr(ur,ln.content),!Fl())throw mn;return kl(e,t),Sc("externalAppAuthenticationForCEA.authenticateWithOauth",[e,t,n.url.href,n.width,n.height,n.isExternal],tr(Il,"externalAppAuthenticationForCEA.authenticateWithOauth"),ul)}))}function Ol(e,t,n,r){return El(this,void 0,void 0,(function*(){if(zr(ur,ln.content),!Fl())throw mn;return kl(e,t),dl(r),yc("externalAppAuthenticationForCEA.authenticateAndResendRequest",[e,t,new tl(r),n.url.href,n.width,n.height,n.isExternal],new cl,tr(Il,"externalAppAuthenticationForCEA.authenticateAndResendRequest"),ul)}))}function Rl(e,t,n,r){return El(this,void 0,void 0,(function*(){if(zr(ur,ln.content),!Fl())throw mn;return kl(e,t),dl(r),yc("externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest",[e,t,new tl(r),n.authId,n.connectionName,n.claims,n.silent],new cl,tr(Il,"externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest"),ul)}))}function Fl(){return!(!zr(ur)||!ur.supports.externalAppAuthenticationForCEA)}function kl(e,t){Un(t,new Error("conversation id is not valid.")),to(e)}const Ml="v2";var xl,Nl;function Dl(e,t){if(zr(ur,ln.content),!Ll())throw mn;const n=new ro(e);return wc(tr(Ml,"externalAppCardActions.processActionSubmit"),"externalAppCardActions.processActionSubmit",[n.toString(),t]).then((([e,t])=>{if(!e)throw t}))}function Ul(e,t,n){if(zr(ur,ln.content),!Ll())throw mn;const r=new ro(e);return wc(tr(Ml,"externalAppCardActions.processActionOpenUrl"),"externalAppCardActions.processActionOpenUrl",[r.toString(),t.href,n]).then((([e,t])=>{if(e)throw e;return t}))}function Ll(){return!(!zr(ur)||!ur.supports.externalAppCardActions)}!function(e){e.DeepLinkDialog="DeepLinkDialog",e.DeepLinkOther="DeepLinkOther",e.DeepLinkStageView="DeepLinkStageView",e.GenericUrl="GenericUrl"}(xl||(xl={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.INVALID_LINK="INVALID_LINK",e.NOT_SUPPORTED="NOT_SUPPORTED"}(Nl||(Nl={}));var Hl=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const _l="v2";function Vl(e,t,n){return Hl(this,void 0,void 0,(function*(){if(zr(ur,ln.content),!Wl())throw mn;kl(e,t);const[r,o]=yield wc(tr(_l,"externalAppCardActionsForCEA.processActionOpenUrl"),"externalAppCardActionsForCEA.processActionOpenUrl",[e.toString(),t,n.href]);if(r)throw r;return o}))}function Bl(e,t,n){return Hl(this,void 0,void 0,(function*(){if(zr(ur,ln.content),!Wl())throw mn;kl(e,t);const r=yield gc(tr(_l,"externalAppCardActionsForCEA.processActionSubmit"),"externalAppCardActionsForCEA.processActionSubmit",e.toString(),t,n);if(r)throw r}))}function Wl(){return!(!zr(ur)||!ur.supports.externalAppCardActionsForCEA)}var jl;function zl(e){if("object"!=typeof e||null===e)return!1;const t=e;return Object.values(jl).includes(t.errorCode)&&(void 0===t.message||"string"==typeof t.message)}!function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(jl||(jl={}));var ql=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const $l="v2";function Gl(e,t,n){return ql(this,void 0,void 0,(function*(){if(zr(ur,ln.content),!Jl())throw mn;return Kl(e,n),Sc("externalAppCardActionsForDA.processActionOpenUrlDialog",[e,new Ql(t),n],tr($l,"externalAppCardActionsForDA.processActionOpenUrlDialog"),zl)}))}function Jl(){return!(!zr(ur)||!ur.supports.externalAppCardActionsForDA)}function Kl(e,t){to(e),Jn(t)}class Ql{constructor(e){this.info=e}serialize(){const{url:e,title:t,size:n}=this.info;return{url:e.href,title:t,size:n}}}var Zl=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Xl="v2";function Yl(e,t,n){return Zl(this,void 0,void 0,(function*(){if(zr(ur,ln.content),!ed())throw mn;const r=new ro(e),[o,i]=yield wc(tr(Xl,"externalAppCommands.processActionCommand"),"externalAppCommands.processActionCommand",[r.toString(),t,n]);if(o)throw o;return i}))}function ed(){return!(!zr(ur)||!ur.supports.externalAppCommands)}const td="v1";var nd,rd,od,id,ad,sd;function cd(e,t){if(zr(ur,ln.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");Ic(tr(td,"files.getCloudStorageFolders"),"files.getCloudStorageFolders",[e],t)}function ud(e,t){if(zr(ur,ln.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");Ic(tr(td,"files.addCloudStorageFolder"),"files.addCloudStorageFolder",[e],t)}function ld(e,t,n){if(zr(ur,ln.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");Ic(tr(td,"files.deleteCloudStorageFolder"),"files.deleteCloudStorageFolder",[e,t],n)}function dd(e,t,n){if(zr(ur,ln.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");Ic(tr(td,"files.getCloudStorageFolderContents"),"files.getCloudStorageFolderContents",[e,t],n)}function fd(e,t,n){if(zr(ur,ln.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");Ic(tr(td,"files.openCloudStorageFile"),"files.openCloudStorageFile",[e,t,n])}function pd(e=!1,t){if(zr(ur,ln.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");Ic(tr(td,"files.getExternalProviders"),"files.getExternalProviders",[e],t)}function gd(e,t,n,r,o=!1,i){if(zr(ur,ln.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!r)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!i)throw new Error("[files.copyMoveFiles] callback cannot be null");Ic(tr(td,"files.copyMoveFiles"),"files.copyMoveFiles",[e,t,n,r,o],i)}function hd(e){if(zr(ur,ln.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");Ic(tr(td,"files.getFileDownloads"),"files.getFileDownloads",[],e)}function md(e=void 0,t){if(zr(ur,ln.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");Ic(tr(td,"files.openDownloadFolder"),"files.openDownloadFolder",[e],t)}function vd(e){if(zr(ur,ln.content),!e)throw Pd(Le.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");Ic(tr(td,"files.addCloudStorageProvider"),"files.addCloudStorageProvider",[],e)}function wd(e,t){if(zr(ur,ln.content),!t)throw Pd(Le.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw Pd(Le.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");Ic(tr(td,"files.removeCloudStorageProvider"),"files.removeCloudStorageProvider",[e],t)}function Cd(e,t){if(zr(ur,ln.content),!t)throw Pd(Le.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw Pd(Le.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");Ic(tr(td,"files.addCloudStorageProviderFile"),"files.addCloudStorageProviderFile",[e],t)}function yd(e,t){if(zr(ur,ln.content),!t)throw Pd(Le.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw Pd(Le.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");Ic(tr(td,"files.renameCloudStorageProviderFile"),"files.renameCloudStorageProviderFile",[e],t)}function Sd(e,t){if(zr(ur,ln.content),!t)throw Pd(Le.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw Pd(Le.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");Ic(tr(td,"files.deleteCloudStorageProviderFile"),"files.deleteCloudStorageProviderFile",[e],t)}function bd(e,t){if(zr(ur,ln.content),!t)throw Pd(Le.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw Pd(Le.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");Ic(tr(td,"files.downloadCloudStorageProviderFile"),"files.downloadCloudStorageProviderFile",[e],t)}function Ad(e,t){if(zr(ur,ln.content),!t)throw Pd(Le.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw Pd(Le.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw Pd(Le.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");Ic(tr(td,"files.uploadCloudStorageProviderFile"),"files.uploadCloudStorageProviderFile",[e],t)}function Ed(e){if(zr(ur),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");Es(tr(td,"files.registerCloudStorageProviderListChangeHandler"),"files.cloudStorageProviderListChange",e)}function Id(e){if(zr(ur),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");Es(tr(td,"files.registerCloudStorageProviderContentChangeHandler"),"files.cloudStorageProviderContentChange",e)}function Pd(e,t){return{errorCode:e,message:t}}!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"}(nd||(nd={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(rd||(rd={})),function(e){e.ClassMaterials="classMaterials"}(od||(od={})),function(e){e.Readonly="readonly"}(id||(id={})),function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}(ad||(ad={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}(sd||(sd={}));const Td="v1";function Od(){return new Promise((e=>{if(zr(ur),!Md())throw mn;e(vc(tr(Td,"meetingRoom.getPairedMeetingRoomInfo"),"meetingRoom.getPairedMeetingRoomInfo"))}))}function Rd(e){return new Promise((t=>{if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(zr(ur),!Md())throw mn;t(vc(tr(Td,"meetingRoom.sendCommandToPairedMeetingRoom"),"meetingRoom.sendCommandToPairedMeetingRoom",e))}))}function Fd(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(zr(ur),!Md())throw mn;Es(tr(Td,"meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler"),"meetingRoom.meetingRoomCapabilitiesUpdate",(t=>{zr(ur),e(t)}))}function kd(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(zr(ur),!Md())throw mn;Es(tr(Td,"meetingRoom.registerMeetingRoomStatesUpdateHandler"),"meetingRoom.meetingRoomStatesUpdate",(t=>{zr(ur),e(t)}))}function Md(){return!(!zr(ur)||!ur.supports.meetingRoom)}function xd(){return!(!zr(ur)||!ur.supports.messageChannels)}const Nd="1.0.1",Dd={onMessage:function(e,t){if(!e||!e.data||"object"!=typeof e.data||null===e.data)return void jd("Invalid message format, ignoring. Message: %o",e);if(!Vd(e.source,e.origin))return void jd("Message source/origin not allowed, ignoring.");const{args:n}=e.data,[,r]=null!=n?n:[],o=(()=>{try{return JSON.parse(r)}catch(e){return zd("Failed to parse response message:",e),null}})();if(!o||"NestedAppAuthResponse"!==o.messageType)return void jd("Invalid response format, ignoring. Message: %o",e);t(r)}};let Ud=null,Ld=!1;function Hd(e,t,n=!1){if(Ld=n,!e)throw new Error("Cannot polyfill nestedAppAuthBridge as the current window does not exist");if(!t)throw new Error("Top origin is required to initialize the Nested App Auth Bridge");try{const e=new URL(t);if("https:"!==e.protocol)throw new Error(`Invalid top origin: ${t}. Only HTTPS origins are allowed.`);Ud=e.origin}catch(e){throw new Error(`Failed to initialize bridge: invalid top origin: ${t}`)}const r=e;if(r.nestedAppAuthBridge)return void jd("Nested App Auth Bridge is already present");const o=_d(r);o&&(r.nestedAppAuthBridge=o)}function _d(e){const t=new WeakMap,{onMessage:n}=Dd,r=e=>t=>n(t,e);return{addEventListener:(n,o)=>{if("message"===n){const i=r(o);t.set(o,i),e.addEventListener(n,i)}else jd(`Event ${n} is not supported by nestedAppAuthBridge`)},postMessage:t=>{if(!e.top)throw new Error("window.top is not available for posting messages");try{const n=JSON.parse(t);if("object"==typeof n&&"NestedAppAuthRequest"===n.messageType){const n=Bd(t);if(e===e.top||!Ud)return void zd("Not in an embedded iframe; skipping postMessage.");e.top.postMessage(n,Ud)}}catch(e){return void zd("Failed to parse message:",e,"Original message:",t)}},removeEventListener:(n,r)=>{const o=t.get(r);o&&(e.removeEventListener(n,o),t.delete(r))}}}function Vd(e,t){if(t===Ud)try{return"https:"===new URL(t).protocol}catch(e){return zd("Invalid message origin URL:",e),!1}return!1}function Bd(e){const t=Date.now();return{id:Wd(),uuid:on(),func:"nestedAppAuth.execute",timestamp:t,apiVersionTag:"v2_nestedAppAuth.execute",monotonicTimestamp:t,args:[],data:e}}function Wd(){return"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).substring(2,11)}function jd(...e){Ld&&console.log(...e)}function zd(...e){Ld&&console.error(...e)}const qd="v1";function $d(e){if(zr(ur,ln.content),!Gd())throw mn;Ic(tr(qd,"notifications.showNotification"),"notifications.showNotification",[e])}function Gd(){return!(!zr(ur)||!ur.supports.notifications)}const Jd="v2";function Kd(e){if(!Xd())throw new Error(Le.NOT_SUPPORTED_ON_PLATFORM.toString());if(oo(e))throw new Error(Le.INVALID_ARGUMENTS.toString());Es(tr(Jd,"otherApp.install"),"otherApp.install",e)}function Qd(){if(!Xd())throw new Error(Le.NOT_SUPPORTED_ON_PLATFORM.toString());Ic(tr(Jd,"otherApp.unregisterInstall"),"otherApp.unregisterInstall"),Is("otherApp.install")}function Zd(e){if(!Xd())throw new Error(Le.NOT_SUPPORTED_ON_PLATFORM.toString());return Sc("otherApp.notifyInstallCompleted",[e.toString()],tr(Jd,"otherApp.notifyInstallCompleted"))}function Xd(){return!(!zr(ur)||!ur.supports.otherAppStateChange)}const Yd="v1";var ef,tf,nf;function rf(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(zr(ur,ln.sidePanel),!ff())throw mn;Ic(tr(Yd,"remoteCamera.getCapableParticipants"),"remoteCamera.getCapableParticipants",e)}function of(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(zr(ur,ln.sidePanel),!ff())throw mn;Ic(tr(Yd,"remoteCamera.requestControl"),"remoteCamera.requestControl",[e],t)}function af(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(zr(ur,ln.sidePanel),!ff())throw mn;Ic(tr(Yd,"remoteCamera.sendControlCommand"),"remoteCamera.sendControlCommand",[e],t)}function sf(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(zr(ur,ln.sidePanel),!ff())throw mn;Ic(tr(Yd,"remoteCamera.terminateSession"),"remoteCamera.terminateSession",e)}function cf(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(zr(ur,ln.sidePanel),!ff())throw mn;Es(tr(Yd,"remoteCamera.registerOnCapableParticipantsChangeHandler"),"remoteCamera.capableParticipantsChange",e)}function uf(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(zr(ur,ln.sidePanel),!ff())throw mn;Es(tr(Yd,"remoteCamera.registerOnErrorHandler"),"remoteCamera.handlerError",e)}function lf(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(zr(ur,ln.sidePanel),!ff())throw mn;Es(tr(Yd,"remoteCamera.registerOnDeviceStateChangeHandler"),"remoteCamera.deviceStateChange",e)}function df(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(zr(ur,ln.sidePanel),!ff())throw mn;Es(tr(Yd,"remoteCamera.registerOnSessionStatusChangeHandler"),"remoteCamera.sessionStatusChange",e)}function ff(){return!(!zr(ur)||!ur.supports.remoteCamera)}!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(ef||(ef={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(tf||(tf={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(nf||(nf={}));const pf="v1";function gf(e,t,n,r){if(zr(ur,ln.content),!hf())throw mn;if(!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!r)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");Ic(tr(pf,"appEntity.selectAppEntity"),"appEntity.selectAppEntity",[e,t,n],r)}function hf(){return!(!zr(ur)||!ur.supports.appEntity)}const mf="v1";function vf(e){return new Promise((t=>{if(zr(ur),!wf())throw mn;if((Kn.hostClientType===cn.android||Kn.hostClientType===cn.teamsRoomsAndroid||Kn.hostClientType===cn.teamsPhones||Kn.hostClientType===cn.teamsDisplays)&&!qr(Ze)){const e={errorCode:Le.OLD_PLATFORM};throw new Error(JSON.stringify(e))}t(gc(tr(mf,"teams.fullTrust.joinedTeams.getUserJoinedTeams"),"getUserJoinedTeams",e))}))}function wf(){return!(!zr(ur)||!ur.supports.teams)&&(!!ur.supports.teams.fullTrust&&!!ur.supports.teams.fullTrust.joinedTeams)}var Cf=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const yf="v1";function Sf(e){return Cf(this,void 0,void 0,(function*(){if(zr(ur),!bf())throw mn;return yc("getConfigSetting",[e],new Ji,tr(yf,"teams.fullTrust.getConfigSetting"))}))}function bf(){return!(!zr(ur)||!ur.supports.teams)&&!!ur.supports.teams.fullTrust}const Af="v1";var Ef;function If(e,t){if(zr(ur,ln.content),!Tf())throw mn;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");Ic(tr(Af,"teams.getTeamChannels"),"teams.getTeamChannels",[e],t)}function Pf(e,t){if(zr(ur),!Tf())throw mn;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");Ic(tr(Af,"teams.refreshSiteUrl"),"teams.refreshSiteUrl",[e],t)}function Tf(){return!(!zr(ur)||!ur.supports.teams)}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(Ef||(Ef={}));class Of{static setTimeout(e,t){const n=performance.now(),r=An();return Of.setTimeoutCallbacks[r]={callback:e,timeoutInMs:t,startedAtInMs:n},r}static clearTimeout(e){delete Of.setTimeoutCallbacks[e]}static setInterval(e,t){Of.setTimeout((function n(){e(),Of.setTimeout(n,t)}),t)}static tick(){const e=performance.now(),t=[];for(const n in Of.setTimeoutCallbacks){const r=Of.setTimeoutCallbacks[n];e-r.startedAtInMs>=r.timeoutInMs&&t.push(n)}for(const e of t){Of.setTimeoutCallbacks[e].callback(),delete Of.setTimeoutCallbacks[e]}}}Of.setTimeoutCallbacks={};class Rf{constructor(e,t){this.reportStatisticsResult=t,this.sampleCount=0,this.distributionBins=new Uint32Array(e)}processStarts(e,t,n,r){Of.tick(),this.suitableForThisSession(e,t,n,r)||this.reportAndResetSession(this.getStatistics(),e,r,t,n),this.start()}processEnds(){const e=performance.now()-this.frameProcessingStartedAt,t=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,e)));this.distributionBins[t]+=1,this.sampleCount+=1}getStatistics(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null}start(){this.frameProcessingStartedAt=performance.now()}suitableForThisSession(e,t,n,r){return this.currentSession&&this.currentSession.effectId===e&&this.currentSession.effectParam===r&&this.currentSession.frameWidth===t&&this.currentSession.frameHeight===n}reportAndResetSession(e,t,n,r,o){e&&this.reportStatisticsResult(e),this.resetCurrentSession(this.getNextTimeout(t,this.currentSession),t,n,r,o),this.timeoutId&&Of.clearTimeout(this.timeoutId),this.timeoutId=Of.setTimeout((()=>this.reportAndResetSession(this.getStatistics(),t,n,r,o)).bind(this),this.currentSession.timeoutInMs)}resetCurrentSession(e,t,n,r,o){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:e,effectId:t,effectParam:n,frameWidth:r,frameHeight:o},this.sampleCount=0,this.distributionBins.fill(0)}getNextTimeout(e,t){return t&&t.effectId===e?Math.min(Rf.maxSessionTimeoutInMs,2*t.timeoutInMs):Rf.initialSessionTimeoutInMs}}Rf.initialSessionTimeoutInMs=1e3,Rf.maxSessionTimeoutInMs=3e4;const Ff="v2";class kf{constructor(e){this.reportPerformanceEvent=e,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new Rf(kf.distributionBinSize,(e=>this.reportPerformanceEvent(tr(Ff,"videoPerformanceMonitor.performanceDataGenerated"),"video.performance.performanceDataGenerated",[e])))}startMonitorSlowFrameProcessing(){Of.setInterval((()=>{if(0===this.processedFrameCount)return;const e=this.frameProcessingTimeCost/this.processedFrameCount;e>this.frameProcessTimeLimit&&this.reportPerformanceEvent(tr(Ff,"videoPerformanceMonitor.startMonitorSlowFrameProcessing"),"video.performance.frameProcessingSlow",[e]),this.frameProcessingTimeCost=0,this.processedFrameCount=0}),kf.calculateFPSInterval)}setFrameProcessTimeLimit(e){this.frameProcessTimeLimit=e}reportApplyingVideoEffect(e,t){var n,r;(null===(n=this.applyingEffect)||void 0===n?void 0:n.effectId)===e&&(null===(r=this.applyingEffect)||void 0===r?void 0:r.effectParam)===t||(this.applyingEffect={effectId:e,effectParam:t},this.appliedEffect=void 0)}reportVideoEffectChanged(e,t){void 0===this.applyingEffect||this.applyingEffect.effectId!==e&&this.applyingEffect.effectParam!==t||(this.appliedEffect={effectId:e,effectParam:t},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)}reportStartFrameProcessing(e,t){Of.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,e,t,this.appliedEffect.effectParam))}reportFrameProcessed(){var e;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent(tr(Ff,"videoPerformanceMonitor.reportFrameProcessed"),"video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(e=this.appliedEffect)||void 0===e?void 0:e.effectParam])))}reportGettingTextureStream(e){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=e}reportTextureStreamAcquired(){if(void 0!==this.gettingTextureStreamStartedAt){const e=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent(tr(Ff,"videoPerformanceMonitor.reportTextureStreamAcquired"),"video.performance.textureStreamAcquired",[this.currentStreamId,e])}}}kf.distributionBinSize=1e3,kf.calculateFPSInterval=1e3;var Mf=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},xf=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const Nf="v2",Df=Dn()?void 0:new kf(Ic);var Uf,Lf,Hf;function _f(e){if(zr(ur,ln.sidePanel),!zf())throw mn;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Es(tr(Nf,"videoEffects.setFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",(e=>null==Df?void 0:Df.setFrameProcessTimeLimit(e.timeLimit)),!1),Kf())qf(e.videoFrameHandler,e.config);else{if(!Zf())throw mn;Gf(e.videoBufferHandler,e.config)}null==Df||Df.startMonitorSlowFrameProcessing()}function Vf(e,t){if(zr(ur,ln.sidePanel),!zf())throw mn;Ic(tr(Nf,"videoEffects.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t])}function Bf(e){if(zr(ur,ln.sidePanel),!zf())throw mn;Es(tr(Nf,"videoEffects.registerEffectParameterChangeHandler"),"video.effectParameterChange",up(e,Df),!1),Ic(tr(Nf,"videoEffects.registerForVideoEffect"),"video.registerForVideoEffect")}function Wf(e){Ic(tr(Nf,"videoEffects.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])}function jf(e){Ic(tr(Nf,"videoEffects.notifyError"),"video.notifyError",[e])}function zf(){return zr(ur)&&!!ur.supports.video&&(!!ur.supports.video.mediaStream||!!ur.supports.video.sharedFrame)}function qf(e,t){if(zr(ur,ln.sidePanel),!zf()||!Kf())throw mn;Es(tr(Nf,"videoEffects.startVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",(t=>Mf(this,void 0,void 0,(function*(){const{streamId:n}=t,r=$f(e,Df);yield ep(n,r,jf,Df)}))),!1),Ic(tr(Nf,"videoEffects.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[t])}function $f(e,t){return n=>Mf(this,void 0,void 0,(function*(){const r=n.videoFrame;null==t||t.reportStartFrameProcessing(r.codedWidth,r.codedHeight);const o=yield e(n);return null==t||t.reportFrameProcessed(),o}))}function Gf(e,t){if(zr(ur,ln.sidePanel),!zf()||!Zf())throw mn;Es(tr(Nf,"videoEffects.registerForVideoBufferHandler"),"video.newVideoFrame",(t=>{if(t){const n=t.timestamp;null==Df||Df.reportStartFrameProcessing(t.width,t.height),e(Jf(t),(()=>{null==Df||Df.reportFrameProcessed(),Wf(n)}),jf)}}),!1),Ic(tr(Nf,"videoEffects.registerForVideoFrame"),"video.registerForVideoFrame",[t])}function Jf(e){if("videoFrameBuffer"in e)return e;{const{data:t}=e,n=xf(e,["data"]);return Object.assign(Object.assign({},n),{videoFrameBuffer:t})}}function Kf(){var e;return zr(ur,ln.sidePanel)&&Qf()&&!!(null===(e=ur.supports.video)||void 0===e?void 0:e.mediaStream)}function Qf(){var e,t,n,r;return!(!(null===(t=null===(e=Nn().chrome)||void 0===e?void 0:e.webview)||void 0===t?void 0:t.getTextureStream)||!(null===(r=null===(n=Nn().chrome)||void 0===n?void 0:n.webview)||void 0===r?void 0:r.registerTextureStream))}function Zf(){var e;return zr(ur,ln.sidePanel)&&!!(null===(e=ur.supports.video)||void 0===e?void 0:e.sharedFrame)}!function(e){e.NV12="NV12"}(Uf||(Uf={})),function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(Lf||(Lf={})),function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"}(Hf||(Hf={}));var Xf=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Yf="v2";function ep(e,t,n,r){var o,i;return Xf(this,void 0,void 0,(function*(){const a=rp();!Dn()&&(null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a)),op(yield np(e,n,r),new ip(n,t),a.writable)}))}function tp(e,t,n,r){var o,i;return Xf(this,void 0,void 0,(function*(){const a=rp();!Dn()&&(null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a)),op(yield np(e,n,r),new cp(n,t),a.writable)}))}function np(e,t,n){return Xf(this,void 0,void 0,(function*(){if(Dn())throw mn;const r=Nn().chrome;try{null==n||n.reportGettingTextureStream(e);const t=(yield r.webview.getTextureStream(e)).getVideoTracks();if(0===t.length)throw new Error(`No video track in stream ${e}`);return null==n||n.reportTextureStreamAcquired(),t[0]}catch(n){throw t(`Failed to get video track from stream ${e}, error: ${n}`),new Error(`Internal error: can't get video track from stream ${e}`)}}))}function rp(){if(Dn())throw mn;const e=window.MediaStreamTrackGenerator;if(!e)throw mn;return new e({kind:"video"})}function op(e,t,n){new(0,Nn().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(n)}class ip{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.transform=(e,t)=>Xf(this,void 0,void 0,(function*(){const n=e.timestamp;if(null!==n)try{const r=yield this.videoFrameHandler({videoFrame:e}),o=new VideoFrame(r,{timestamp:n});t.enqueue(o),e.close(),r.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")}))}}class ap{constructor(e,t){if(this.headerBuffer=e,this.notifyError=t,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(e),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}get oneTextureLayoutId(){return this.headerDataView[0]}get version(){return this.headerDataView[1]}get frameRowOffset(){return this.headerDataView[2]}get frameFormat(){return this.headerDataView[3]}get frameWidth(){return this.headerDataView[4]}get frameHeight(){return this.headerDataView[5]}get multiStreamHeaderRowOffset(){return this.headerDataView[6]}get multiStreamCount(){return this.headerDataView[7]}}class sp{constructor(e,t){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161,this.ATTRIBUTE_ID_MAP_STREAM_ID=1296320833;const n=new Uint32Array(e);for(let r=0,o=0;r<t;r++){const t=n[o++],r=n[o++],i=n[o++],a=new Uint8Array(e,r,i);this.metadataMap.set(t,a)}}get audioInferenceResult(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}get attributes(){const e=this.metadataMap.get(this.ATTRIBUTE_ID_MAP_STREAM_ID);if(void 0===e)return;const t=new Map,n=new TextDecoder("utf-8");let r=0;const o=e[r]+(e[++r]<<8)+(e[++r]<<16)+(e[++r]<<24);for(let i=0;i<o&&r<e.length-1;i++){const o=e[++r]+(e[++r]<<8)+(e[++r]<<16)+(e[++r]<<24),i=e.findIndex(((e,t,n)=>0==e&&t>r)),a=n.decode(e.slice(++r,i)),s=this.metadataMap.get(o);void 0!==s&&t.set(a,s);r=i+(4-(i-r)%4-1)}return t}}class cp{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.shouldDiscardAudioInferenceResult=!1,this.transform=(e,t)=>Xf(this,void 0,void 0,(function*(){const n=e.timestamp;if(null!==n)try{const{videoFrame:r,metadata:{audioInferenceResult:o,attributes:i}={}}=yield this.extractVideoFrameAndMetadata(e),a=yield this.videoFrameHandler({videoFrame:r,audioInferenceResult:o,attributes:i}),s=new VideoFrame(a,{timestamp:n});t.enqueue(s),r.close(),e.close(),a.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")})),this.extractVideoFrameAndMetadata=e=>Xf(this,void 0,void 0,(function*(){if(Dn())throw mn;if("NV12"!==e.format)throw this.notifyError("Unsupported video frame pixel format"),new Error("Unsupported video frame pixel format");const t={x:0,y:0,width:e.codedWidth,height:2},n=new ArrayBuffer(t.width*t.height*3/2);yield e.copyTo(n,{rect:t});const r=new ap(n,this.notifyError),o={x:0,y:r.multiStreamHeaderRowOffset,width:e.codedWidth,height:e.codedHeight-r.multiStreamHeaderRowOffset},i=new ArrayBuffer(o.width*o.height*3/2);yield e.copyTo(i,{rect:o});const a=new sp(i,r.multiStreamCount);return{videoFrame:new VideoFrame(e,{timestamp:e.timestamp,visibleRect:{x:0,y:r.frameRowOffset,width:r.frameWidth,height:r.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:a.audioInferenceResult,attributes:a.attributes}}})),Es(tr(Yf,"videoEffectsUtils.transformerWithMetadata.constructor"),"video.mediaStream.audioInferenceDiscardStatusChange",(({discardAudioInferenceResult:e})=>{this.shouldDiscardAudioInferenceResult=e}))}}function up(e,t){return(n,r)=>{null==t||t.reportApplyingVideoEffect(n||"",r),e(n,r).then((()=>{null==t||t.reportVideoEffectChanged(n||"",r),Ic(tr(Yf,"videoEffectsUtils.reportVideoEffectChanged"),"video.videoEffectReadiness",[!0,n,void 0,r])})).catch((e=>{const t=e in Hf?e:Hf.InitializationFailure;Ic(tr(Yf,"videoEffectsUtils.effectFailure"),"video.videoEffectReadiness",[!1,n,t,r])}))}}var lp=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const dp="v2",fp=2e3,pp=Dn()?void 0:new kf(Ic);var gp;function hp(e){var t,n;if(!bp())throw mn;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(zr(ur,ln.sidePanel)){if(Es(tr(dp,"videoEffectsEX.registerSetFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",(e=>null==pp?void 0:pp.setFrameProcessTimeLimit(e)),!1),null===(t=ur.supports.video)||void 0===t?void 0:t.mediaStream)Es(tr(dp,"videoEffectsEX.registerStartVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",(t=>lp(this,void 0,void 0,(function*(){const{streamId:n,metadataInTexture:r}=t,o=pp?vp(e.videoFrameHandler,pp):e.videoFrameHandler;r?yield tp(n,o,Ep,pp):yield ep(n,o,Ep,pp)}))),!1),Ic(tr(dp,"videoEffectsEX.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(null===(n=ur.supports.video)||void 0===n?void 0:n.sharedFrame))throw mn;Es(tr(dp,"videoEffectsEx.registerNewVideoFrameHandler"),"video.newVideoFrame",(t=>{if(t){null==pp||pp.reportStartFrameProcessing(t.width,t.height);const n=mp(),r=t.timestamp;e.videoBufferHandler(wp(t),(()=>{n(),null==pp||pp.reportFrameProcessed(),Ap(r)}),Ep)}}),!1),Ic(tr(dp,"videoEffectsEx.registerForVideoFrame"),"video.registerForVideoFrame",[e.config])}null==pp||pp.startMonitorSlowFrameProcessing()}}function mp(){const e=setTimeout((()=>{Ep(`Frame not processed in ${fp}ms`,gp.Warn)}),fp);return function(){clearTimeout(e)}}function vp(e,t){return n=>lp(this,void 0,void 0,(function*(){const r=n.videoFrame;t.reportStartFrameProcessing(r.codedWidth,r.codedHeight);const o=mp(),i=yield e(n);return o(),t.reportFrameProcessed(),i}))}function wp(e){return e.videoFrameBuffer=e.videoFrameBuffer||e.data,delete e.data,e}function Cp(e,t,n){if(zr(ur,ln.sidePanel),!bp())throw mn;Ic(tr(dp,"videoEffectsEx.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t,n])}function yp(e){if(zr(ur,ln.sidePanel),!bp())throw mn;Es(tr(dp,"videoEffectsEx.registerEffectParamterChangeHandler"),"video.effectParameterChange",up(e,pp),!1),Ic(tr(dp,"videoEffectsEx.registerForVideoEffect"),"video.registerForVideoEffect")}function Sp(e){if(zr(ur,ln.sidePanel),!zf())throw mn;Ic(tr(dp,"videoEffectsEx.updatePersonalizedEffects"),"video.personalizedEffectsChanged",[e])}function bp(){return zr(ur),zf()}function Ap(e){Ic(tr(dp,"videoEffectsEx.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])}function Ep(e,t=gp.Warn){Ic(tr(dp,"videoEffectsEx.notifyError"),"video.notifyError",[e,t])}function Ip(e){if(zr(ur),!zf())throw mn;Ep(e,gp.Fatal)}!function(e){e.Fatal="fatal",e.Warn="warn"}(gp||(gp={}));const Pp="v2";class Tp extends Gi{validate(e){return"ConfigurableTab"===e.tabType}deserialize(e){return e}}class Op{constructor(e){this.configurableTabInstance=e}serialize(){return this.configurableTabInstance}}class Rp{constructor(e){this.hostEntityId=e}serialize(){return this.hostEntityId}}class Fp extends Gi{validate(e){return"ConfigurableTab"===e.tabType||"StaticTab"===e.tabType}deserialize(e){return e}}class kp{constructor(e){this.hostEntityTabInstance=e}serialize(){return this.hostEntityTabInstance}}class Mp extends Gi{validate(e){const t=new Fp;let n=!0;return e.allTabs&&e.allTabs.forEach((e=>{n||(n=t.validate(e))})),n}deserialize(e){return e}}function xp(e,t){if(zr(ur),!Hp())throw new Error(`Error code: ${Le.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);if(_p(e.threadId),t&&0===t.length)throw new Error(`Error code: ${Le.INVALID_ARGUMENTS}, message: App types cannot be an empty array`);return yc("hostEntity.tab.addAndConfigure",[new Rp(e),t],new Fp,tr(Pp,"hostEntity.tab.addAndConfigure"))}function Np(e){if(zr(ur),!Hp())throw new Error(`Error code: ${Le.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return _p(e.threadId),yc("hostEntity.tab.getAll",[new Rp(e)],new Mp,tr(Pp,"hostEntity.tab.getAll"))}function Dp(e,t){if(zr(ur),!Hp())throw new Error(`Error code: ${Le.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return Vp(e),_p(t.threadId),yc("hostEntity.tab.reconfigure",[new Op(e),new Rp(t)],new Tp,tr(Pp,"hostEntity.tab.reconfigure"))}function Up(e,t){if(zr(ur),!Hp())throw new Error(`Error code: ${Le.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return Vp(e),_p(t.threadId),yc("hostEntity.tab.rename",[new Op(e),new Rp(t)],new Tp,tr(Pp,"hostEntity.tab.rename"))}function Lp(e,t){if(zr(ur),!Hp())throw new Error(`Error code: ${Le.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return _p(t.threadId),Vp(e),yc("hostEntity.tab.remove",[new kp(e),new Rp(t)],new Ji,tr(Pp,"hostEntity.tab.remove"))}function Hp(){var e;return!!(zr(ur)&&Wp()&&(null===(e=ur.supports.hostEntity)||void 0===e?void 0:e.tab))}function _p(e){if(!e||0==e.length)throw new Error(`Error code: ${Le.INVALID_ARGUMENTS}, message: ThreadId cannot be null or empty`)}function Vp(e){if(!(null==e?void 0:e.internalTabInstanceId)||0===e.internalTabInstanceId.length)throw new Error(`Error code: ${Le.INVALID_ARGUMENTS}, message: TabId cannot be null or empty`)}var Bp;function Wp(){return!(!zr(ur)||!ur.supports.hostEntity)}!function(e){e.edu="EDU",e.baseTownhall="BASE_TOWNHALL",e.streamingTownhall="STREAMING_TOWNHALL"}(Bp||(Bp={}));var jp=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const zp="v2",qp="Invalid store dialog size",$p="No App Id present, but AppId needed to open AppDetail store",Gp="No Collection Id present, but CollectionId needed to open a store specific to a collection";function Jp(e){return jp(this,void 0,void 0,(function*(){Yp();const{size:t}=null!=e?e:{};return Sc("store.openFullStore",[eg(t)],tr(zp,"store.openFullStore"))}))}function Kp(e){return jp(this,void 0,void 0,(function*(){Yp();const{size:t,appId:n}=e;if(!(n instanceof ro))throw new Error($p);return Sc("store.openAppDetail",[eg(t),n],tr(zp,"store.openAppDetail"))}))}function Qp(e){return jp(this,void 0,void 0,(function*(){Yp();const{size:t,appCapability:n,appMetaCapabilities:r,installationScope:o,filteredOutAppIds:i}=null!=e?e:{};return Sc("store.openInContextStore",[eg(t),n,r,o,null==i?void 0:i.map((e=>e.toString()))],tr(zp,"store.openInContextStore"))}))}function Zp(e){return jp(this,void 0,void 0,(function*(){Yp();const{size:t,collectionId:n}=e;if(void 0===n)throw new Error(Gp);return Sc("store.openSpecificStore",[eg(t),n],tr(zp,"store.openSpecificStore"))}))}function Xp(){return zr(ur)&&!!ur.supports.store}function Yp(){if(zr(ur,ln.content,ln.sidePanel,ln.meetingStage),!Xp())throw mn}function eg(e){if(void 0===e)return;const{width:t,height:n}=e;if(void 0!==t&&"number"==typeof t&&t<0)throw new Error(qp);if(void 0!==n&&"number"==typeof n&&n<0)throw new Error(qp);return JSON.stringify(e)}var tg=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const ng="v1",rg=er("widgetHosting");function og(){return zr(ur)&&!!ur.supports.widgetHosting}function ig(e,t){return tg(this,void 0,void 0,(function*(){return jr(),rg("Calling tool with widgetId and input: ",{widgetId:e,input:t}),yc("widgetHosting.callTool",[new mg(e,t)],new gg,tr(ng,"widgetHosting.callTool"),qe)}))}function ag(e,t){return tg(this,void 0,void 0,(function*(){return jr(),rg("Sending follow-up message with widgetId and prompt: ",{widgetId:e,prompt:t.prompt}),Sc("widgetHosting.sendFollowUpMessage",[new vg(e,t)],tr(ng,"widgetHosting.sendFollowUpMessage"))}))}function sg(e,t){return tg(this,void 0,void 0,(function*(){return jr(),rg("Requesting display mode with widgetId: ",{widgetId:e,mode:t.mode}),Sc("widgetHosting.requestDisplayMode",[new wg(e,t)],tr(ng,"widgetHosting.requestDisplayMode"))}))}function cg(e,t){return tg(this,void 0,void 0,(function*(){return jr(),rg("Requesting modal with widgetId and options: ",{widgetId:e,options:t}),yc("widgetHosting.requestModal",[new bg(e,t)],new hg,tr(ng,"widgetHosting.requestModal"),qe)}))}function ug(e,t){jr(),rg("Notifying intrinsic height with widgetId: ",{widgetId:e,height:t}),Sc("widgetHosting.notifyIntrinsicHeight",[new Sg(e,t)],tr(ng,"widgetHosting.notifyIntrinsicHeight"))}function lg(e,t,n){jr(),rg("Content size changed with widgetId: ",{widgetId:e,width:t,height:n}),Sc("widgetHosting.contentSizeChanged",[new Ag(e,t,n)],tr(ng,"widgetHosting.contentSizeChanged"))}function dg(e,t){return tg(this,void 0,void 0,(function*(){return jr(),rg("Setting widget state with widgetId: ",{widgetId:e,state:t}),Sc("widgetHosting.setWidgetState",[new yg(e,t)],tr(ng,"widgetHosting.setWidgetState"))}))}function fg(e,t){jr(),rg("Opening external URL with widgetId: ",{widgetId:e,href:t.href}),Sc("widgetHosting.openExternal",[new Cg(e,t)],tr(ng,"widgetHosting.openExternal"))}function pg(e){Ts(tr(ng,"widgetHosting.registerModalCloseHandler"),"widgetHosting.closeWidgetModal",e,[],(()=>{if(!og())throw new Error("Widget Hosting is not supported on this platform")}))}class gg extends Gi{validate(e){return null!==e&&"object"==typeof e}deserialize(e){return e}}class hg extends Gi{validate(e){return null!==e&&"object"==typeof e}deserialize(e){return e}}class mg{constructor(e,t){this.widgetId=e,this.toolInput=t}serialize(){return{widgetId:this.widgetId,name:this.toolInput.name,arguments:this.toolInput.arguments}}}class vg{constructor(e,t){this.widgetId=e,this.args=t}serialize(){return{widgetId:this.widgetId,prompt:this.args.prompt}}}class wg{constructor(e,t){this.widgetId=e,this.args=t}serialize(){return{widgetId:this.widgetId,mode:this.args.mode}}}class Cg{constructor(e,t){this.widgetId=e,this.payload=t}serialize(){return{widgetId:this.widgetId,href:this.payload.href}}}class yg{constructor(e,t){this.widgetId=e,this.state=t}serialize(){return{widgetId:this.widgetId,state:this.state}}}class Sg{constructor(e,t){this.widgetId=e,this.height=t}serialize(){return{widgetId:this.widgetId,height:this.height}}}class bg{constructor(e,t){this.widgetId=e,this.options=t}serialize(){return{widgetId:this.widgetId,id:this.options.id,title:this.options.title,content:this.options.content,width:this.options.width,height:this.options.height}}}class Ag{constructor(e,t,n){this.widgetId=e,this.width=t,this.height=n}serialize(){return{widgetId:this.widgetId,width:this.width,height:this.height}}}var Eg=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Ig="v1",Pg="v2";let Tg;function Og(e){Tg=e}function Rg(e){const t=void 0!==e,n=t?e:Tg;if(!n)throw new Error("No parameters are provided for authentication");zr(ur,ln.content,ln.sidePanel,ln.settings,ln.remove,ln.task,ln.stage,ln.meetingStage);return Fg(n.successCallback||n.failureCallback?tr(Ig,"authentication.authenticate"):tr(Pg,"authentication.authenticate"),n).then((e=>{try{return n&&n.successCallback?(n.successCallback(e),""):e}finally{t||(Tg=void 0)}})).catch((e=>{try{if(n&&n.failureCallback)return n.failureCallback(e.message),"";throw e}finally{t||(Tg=void 0)}}))}function Fg(e,t){return Eg(this,void 0,void 0,(function*(){const n=Hn(t.url);return Ln(n),wc(e,"authentication.authenticate",[n.href,t.width,t.height,t.isExternal]).then((([e,t])=>{if(e)return t;throw new Error(t)}))}))}function kg(e){jr();return Mg(e&&(e.successCallback||e.failureCallback)?tr(Ig,"authentication.getAuthToken"):tr(Pg,"authentication.getAuthToken"),e).then((t=>e&&e.successCallback?(e.successCallback(t),""):t)).catch((t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t}))}function Mg(e,t){return new Promise((n=>{n(wc(e,"authentication.getAuthToken",[null==t?void 0:t.resources,null==t?void 0:t.claims,null==t?void 0:t.silent,null==t?void 0:t.tenantId]))})).then((([e,t])=>{if(e)return t;throw new Error(t)}))}function xg(e){jr();return Ng(e&&(e.successCallback||e.failureCallback)?tr(Ig,"authentication.getUser"):tr(Pg,"authentication.getUser")).then((t=>e&&e.successCallback?(e.successCallback(t),null):t)).catch((t=>{const n=`Error returned, code = ${t.errorCode}, message = ${t.message}`;if(e&&e.failureCallback)return e.failureCallback(n),null;throw new Error(n)}))}function Ng(e){return new Promise((t=>{t(wc(e,"authentication.getUser"))})).then((([e,t])=>{if(e)return t;throw t}))}function Dg(e,t){zr(ur,ln.authentication);Ic(tr(t?Ig:Pg,"authentication.notifySuccess"),"authentication.authenticate.success",[e]),Kc(lc.parentWindow,(()=>setTimeout((()=>lc.currentWindow.close()),200)))}function Ug(e,t){zr(ur,ln.authentication);Ic(tr(t?Ig:Pg,"authentication.notifyFailure"),"authentication.authenticate.failure",[e]),Kc(lc.parentWindow,(()=>setTimeout((()=>lc.currentWindow.close()),200)))}var Lg;function Hg(){return zr(ur)&&!!ur.supports.appPerformanceMetrics}function _g(e){zr(ur),Es(tr("v2","appPerformanceMetrics.memoryUsageHeartbeat"),"appPerformanceMetrics.memoryUsageHeartbeat",e)}function Vg(e){const t=!e||e.length<=0,n=null==e?void 0:e.indexOf("@"),r=null==e?void 0:e.indexOf(".",n);if(t||-1===n||-1===r)throw new Error("Input email address does not have the correct format.")}!function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(Lg||(Lg={}));class Bg{constructor(e){this.val=e,Vg(e)}toString(){return this.val}}const Wg="/l/app/",jg="/l/meeting/new",zg="attendees",qg="startTime",$g="endTime",Gg="subject",Jg="content",Kg="/l/call/0/0",Qg="source",Zg="withVideo",Xg="/l/chat/0/0",Yg="users",eh="topicName",th="message";function nh(e,t,n){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");const r=`${Yg}=`+e.map((e=>encodeURIComponent(e))).join(","),o=void 0===t?"":`&${eh}=${encodeURIComponent(t)}`,i=void 0===n?"":`&${th}=${encodeURIComponent(n)}`;return`${st}://${ct}${Xg}?${r}${o}${i}`}function rh(e,t,n){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");const r=`${Yg}=`+e.map((e=>encodeURIComponent(e))).join(","),o=void 0===t?"":`&${Zg}=${encodeURIComponent(t)}`,i=void 0===n?"":`&${Qg}=${encodeURIComponent(n)}`;return`${st}://${ct}${Kg}?${r}${o}${i}`}function oh(e,t,n,r,o){const i=void 0===e?"":`${zg}=`+e.map((e=>encodeURIComponent(e))).join(","),a=void 0===t?"":`&${qg}=${encodeURIComponent(t)}`,s=void 0===n?"":`&${$g}=${encodeURIComponent(n)}`,c=void 0===r?"":`&${Gg}=${encodeURIComponent(r)}`,u=void 0===o?"":`&${Jg}=${encodeURIComponent(o)}`;return`${st}://${ct}${jg}?${i}${a}${s}${c}${u}`}function ih(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return`${st}://${ct}${Wg}${encodeURIComponent(e)}`}const ah="v1";function sh(e){return new Promise((t=>{if(zr(ur,ln.content,ln.sidePanel,ln.settings,ln.task,ln.stage,ln.meetingStage),!ch())throw new Error("Not supported");const n=tr(ah,"appInstallDialog.openAppInstallDialog");ur.isLegacyTeams?t(hc(n,"executeDeepLink",ih(e.appId))):(Ic(n,"appInstallDialog.openAppInstallDialog",[e]),t())}))}function ch(){return!(!zr(ur)||!ur.supports.appInstallDialog)}const uh="v1",lh=er("media");var dh,fh,ph,gh,hh,mh,vh;!function(e){e.Base64="base64",e.ID="id"}(dh||(dh={}));class wh{}function Ch(e){if(!e)throw new Error("[captureImage] Callback cannot be null");if(zr(ur,ln.content,ln.task),Kn.isFramelessWindow)if(qr(et))Ic(tr(uh,"media.captureImage"),"captureImage",e);else{e({errorCode:Le.OLD_PLATFORM},[])}else{e({errorCode:Le.NOT_SUPPORTED_ON_PLATFORM},[])}}function yh(){if(zr(ur,ln.content,ln.task),!bh())throw mn;const e=He.Media;return new Promise((t=>{t(vc(tr(uh,"media.hasPermission"),"permissions.has",e))}))}function Sh(){if(zr(ur,ln.content,ln.task),!bh())throw mn;const e=He.Media;return new Promise((t=>{t(vc(tr(uh,"media.requestPermission"),"permissions.request",e))}))}function bh(){return!(!zr(ur)||!ur.supports.permissions)}class Ah extends wh{constructor(e){super(),e&&(this.content=e.content,this.format=e.format,this.mimeType=e.mimeType,this.name=e.name,this.preview=e.preview,this.size=e.size)}getMedia(e){if(!e)throw new Error("[get Media] Callback cannot be null");if(zr(ur,ln.content,ln.task),qr(tt))if(Lh(this.mimeType,this.format,this.content))qr("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e);else{e({errorCode:Le.INVALID_ARGUMENTS},new Blob)}else{e({errorCode:Le.OLD_PLATFORM},new Blob)}}getMediaViaCallback(e){const t={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[this.content];Ic(tr(uh,"media.getMedia"),"getMedia",n,(function(n){if(e)if(n&&n.error)e(n.error,new Blob);else if(n&&n.mediaChunk)if(n.mediaChunk.chunkSequence<=0){const r=Rh(t.assembleAttachment,t.mediaMimeType);e(n.error,null!=r?r:new Blob)}else{const e=Fh(n.mediaChunk,t.mediaMimeType);e?t.assembleAttachment.push(e):lh(`Received a null assemble attachment for when decoding chunk sequence ${n.mediaChunk.chunkSequence}; not including the chunk in the assembled file.`)}else e({errorCode:Le.INTERNAL_ERROR,message:"data received is null"},new Blob)}))}getMediaViaHandler(e){const t=An(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},r=[t,this.content];this.content&&!oo(e)&&Ic(tr(uh,"media.getMedia"),"getMedia",r),Es(tr(uh,"media.registerGetMediaRequestHandler"),"getMedia"+t,(function(r){if(e){const o=JSON.parse(r);if(o.error)e(o.error,new Blob),Is("getMedia"+t);else if(o.mediaChunk)if(o.mediaChunk.chunkSequence<=0){const r=Rh(n.assembleAttachment,n.mediaMimeType);e(o.error,null!=r?r:new Blob),Is("getMedia"+t)}else{const e=Fh(o.mediaChunk,n.mediaMimeType);e&&n.assembleAttachment.push(e)}else e({errorCode:Le.INTERNAL_ERROR,message:"data received is null"},new Blob),Is("getMedia"+t)}}))}}class Eh{constructor(e){this.controllerCallback=e}notifyEventToHost(e,t){zr(ur,ln.content,ln.task);try{Gr(Ke)}catch(e){return void(t&&t(e))}const n={mediaType:this.getMediaType(),mediaControllerEvent:e};Ic(tr(uh,"media.controller"),"media.controller",[n],(e=>{t&&t(e)}))}stop(e){this.notifyEventToHost(fh.StopRecording,e)}}class Ih extends Eh{getMediaType(){return hh.Video}notifyEventToApp(e){if(this.controllerCallback)switch(e){case fh.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}}}function Ph(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if(zr(ur,ln.content,ln.task),!qr(tt)){const e={errorCode:Le.OLD_PLATFORM};return void t(e,[])}try{kh(e)}catch(e){return void t(e,[])}if(!xh(e)){const e={errorCode:Le.INVALID_ARGUMENTS};return void t(e,[])}const n=[e];Ic(tr(uh,"media.selectMedia"),"selectMedia",n,((n,r,o)=>{var i,a;if(o)return void(Mh(e)&&(null===(a=null===(i=null==e?void 0:e.videoProps)||void 0===i?void 0:i.videoController)||void 0===a||a.notifyEventToApp(o)));if(!r)return void t(n,[]);const s=[];for(const e of r)s.push(new Ah(e));t(n,s)}))}function Th(e,t){if(!t)throw new Error("[view images] Callback cannot be null");if(zr(ur,ln.content,ln.task),!qr(tt)){return void t({errorCode:Le.OLD_PLATFORM})}if(!Hh(e)){return void t({errorCode:Le.INVALID_ARGUMENTS})}const n=[e];Ic(tr(uh,"media.viewImages"),"viewImages",n,t)}function Oh(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");if(zr(ur,ln.content,ln.task),Kn.hostClientType!==cn.desktop&&Kn.hostClientType!==cn.web&&Kn.hostClientType!==cn.rigel&&Kn.hostClientType!==cn.teamsRoomsWindows&&Kn.hostClientType!==cn.teamsRoomsAndroid&&Kn.hostClientType!==cn.teamsPhones&&Kn.hostClientType!==cn.teamsDisplays)if(qr(nt))if(_h(t))Ic(tr(uh,"media.scanBarCode"),"media.scanBarCode",[t],e);else{e({errorCode:Le.INVALID_ARGUMENTS},"")}else{e({errorCode:Le.OLD_PLATFORM},"")}else{e({errorCode:Le.NOT_SUPPORTED_ON_PLATFORM},"")}}function Rh(e,t){if(null==e||null==t||e.length<=0)return null;let n=null,r=1;return e.sort(((e,t)=>e.sequence>t.sequence?1:-1)),e.forEach((e=>{e.sequence==r&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),r++)})),n}function Fh(e,t){if(null==e||null==t)return null;const n=atob(e.chunk),r=new Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);const o=new Uint8Array(r),i=new Blob([o],{type:t});return{sequence:e.chunkSequence,file:i}}function kh(e){Dh(e)?Gr(Je):Uh(e)?Gr(Ke):Nh(e)&&Gr(Qe)}function Mh(e){return!(e.mediaType!=hh.Video||!e.videoProps||!e.videoProps.videoController)}function xh(e){return!(null==e||e.maxMediaCount>10)}function Nh(e){var t;return!((null==e?void 0:e.mediaType)!=hh.Image||!(null===(t=null==e?void 0:e.imageProps)||void 0===t?void 0:t.imageOutputFormats))}function Dh(e){return!(!e||e.mediaType!=hh.VideoAndImage&&!e.videoAndImageProps)}function Uh(e){return!(!e||e.mediaType!=hh.Video||!e.videoProps||e.videoProps.isFullScreenMode)}function Lh(e,t,n){return null!=e&&null!=t&&t==dh.ID&&null!=n}function Hh(e){return!(null==e||e.length<=0||e.length>10)}function _h(e){return!e||!(null===e.timeOutIntervalInSec||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec<=0||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec>60)}function Vh(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}!function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"}(fh||(fh={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(ph||(ph={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(gh||(gh={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(hh||(hh={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(mh||(mh={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(vh||(vh={}));const Bh="v2";function Wh(e){return new Promise((t=>{if(zr(ur,ln.content,ln.task),!qh())throw mn;if(!_h(e))throw{errorCode:Le.INVALID_ARGUMENTS};t(vc(tr(Bh,"barCode.scanBarCode"),"media.scanBarCode",e))}))}function jh(){if(zr(ur,ln.content,ln.task),!qh())throw mn;const e=He.Media;return new Promise((t=>{t(vc(tr(Bh,"barCode.hasPermission"),"permissions.has",e))}))}function zh(){if(zr(ur,ln.content,ln.task),!qh())throw mn;const e=He.Media;return new Promise((t=>{t(vc(tr(Bh,"barCode.requestPermission"),"permissions.request",e))}))}function qh(){return!!(zr(ur)&&ur.supports.barCode&&ur.supports.permissions)}const $h="v2";function Gh(e){return Jh(tr($h,"chat.openChat"),e)}function Jh(e,t){return new Promise((n=>{if(zr(ur,ln.content,ln.task),!Qh())throw mn;if(ur.isLegacyTeams)n(hc(e,"executeDeepLink",nh([t.user],void 0,t.message)));else{n(hc(e,"chat.openChat",{members:[t.user],message:t.message}))}}))}function Kh(e){const t=tr($h,"chat.openGroupChat");return new Promise((n=>{if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length){const r={user:e.users[0],message:e.message};n(Jh(t,r))}else{if(zr(ur,ln.content,ln.task),!Qh())throw mn;if(ur.isLegacyTeams)n(hc(t,"executeDeepLink",nh(e.users,e.topic,e.message)));else{n(hc(t,"chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}}}))}function Qh(){return!(!zr(ur)||!ur.supports.chat)}var Zh=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Xh="v2";function Yh(e){return Zh(this,void 0,void 0,(function*(){if(zr(ur,ln.content,ln.meetingStage,ln.task,ln.settings,ln.stage,ln.sidePanel),!tm())throw mn;if(!e.type||!Object.values(je).includes(e.type))throw new Error(`Blob type ${e.type} is not supported. Supported blob types are ${Object.values(je)}`);const t=yield xn(e),n={mimeType:e.type,content:t};return vc(tr(Xh,"clipboard.write"),"clipboard.writeToClipboard",n)}))}function em(){return Zh(this,void 0,void 0,(function*(){zr(ur,ln.content,ln.meetingStage,ln.task,ln.settings,ln.stage,ln.sidePanel);const e=tr(Xh,"clipboard.read");if(!tm())throw mn;const t=yield vc(e,"clipboard.readFromClipboard");if("string"==typeof t){const e=JSON.parse(t);return Mn(e.mimeType,e.content)}return t}))}function tm(){return Kn.isFramelessWindow?!(!zr(ur)||!ur.supports.clipboard):!!(zr(ur)&&navigator&&navigator.clipboard&&ur.supports.clipboard)}var nm=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const rm="v2",om={validate:e=>Array.isArray(e)||"object"==typeof e,deserialize:e=>e};var im;function am(){var e;return null!==(e=zr(ur)&&(ur.isNAAChannelRecommended||dm()))&&void 0!==e&&e}function sm(){return zr(ur),lc.parentOrigin}function cm(){var e;return null!==(e=zr(ur)&&ur.canParentManageNAATrustedOrigins)&&void 0!==e&&e}function um(){var e;return null!==(e=zr(ur)&&(ur.isDeeplyNestedAuthSupported||lm()))&&void 0!==e&&e}function lm(){return!!(zr(ur)&&fm()&&ur.isLegacyTeams&&qr(mr))}function dm(){return!!(zr(ur)&&fm()&&ur.isLegacyTeams&&ur.supports.nestedAppAuth)}function fm(){return Kn.hostClientType===cn.android||Kn.hostClientType===cn.ios||Kn.hostClientType===cn.ipados||Kn.hostClientType===cn.visionOS}function pm(e){return nm(this,void 0,void 0,(function*(){if(!cm())throw mn;const t=e.map(mm);return hm(im.ADD,t)}))}function gm(e){return nm(this,void 0,void 0,(function*(){if(!cm())throw mn;const t=e.map(mm);return hm(im.DELETE,t)}))}function hm(e,t){return nm(this,void 0,void 0,(function*(){if(window.parent!==window.top)throw new Error("This API is only available in the top-level parent.");if(!Array.isArray(t)||0===t.length)throw new Error(`The '${t}' parameter is required and must be a non-empty array.`);return yc("nestedAppAuth.manageNAATrustedOrigins",[new vm(e,t)],om,tr(rm,"nestedAppAuth.manageNAATrustedOrigins"))}))}function mm(e){try{return new URL(e).origin.toLowerCase()}catch(t){throw new Error(`Invalid origin provided: ${e}`)}}!function(e){e.ADD="ADD",e.DELETE="DELETE"}(im||(im={}));class vm{constructor(e,t){this.action=e,this.appOrigins=t}serialize(){return{action:this.action,appOrigins:this.appOrigins}}}const wm="v2";function Cm(){if(zr(ur,ln.content,ln.task),!Sm())throw mn;return vc(tr(wm,"geoLocation.map.chooseLocation"),"location.getLocation",{allowChooseLocation:!0,showMap:!0})}function ym(e){if(zr(ur,ln.content,ln.task),!Sm())throw mn;if(!e)throw{errorCode:Le.INVALID_ARGUMENTS};return vc(tr(wm,"geoLocation.showLocation"),"location.showLocation",e)}function Sm(){return!!(zr(ur)&&ur.supports.geoLocation&&ur.supports.geoLocation.map&&ur.supports.permissions)}const bm="v2";function Am(){if(zr(ur,ln.content,ln.task),!Pm())throw mn;return vc(tr(bm,"geoLocation.getCurrentLocation"),"location.getLocation",{allowChooseLocation:!1,showMap:!1})}function Em(){if(zr(ur,ln.content,ln.task),!Pm())throw mn;const e=He.GeoLocation;return new Promise((t=>{t(vc(tr(bm,"geoLocation.hasPermission"),"permissions.has",e))}))}function Im(){if(zr(ur,ln.content,ln.task),!Pm())throw mn;const e=He.GeoLocation;return new Promise((t=>{t(vc(tr(bm,"geoLocation.requestPermission"),"permissions.request",e))}))}function Pm(){return!!(zr(ur)&&ur.supports.geoLocation&&ur.supports.permissions)}function Tm(){return ur.hostVersionsInfo?ur.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}const Om="v1";class Rm{postMessage(e,t){zr(ur),Ic(tr(Om,"appWindow.childAppWindow.postMessage"),"messageForChild",[e],t||Sn())}addEventListener(e,t){zr(ur),"message"===e&&Es(tr(Om,"appWindow.childAppWindow.addEventListener"),"messageForParent",t)}}class Fm{static get Instance(){return this._instance||(this._instance=new this)}postMessage(e,t){zr(ur,ln.task),Ic(tr(Om,"appWindow.parentAppWindow.postMessage"),"messageForParent",[e],t||Sn())}addEventListener(e,t){zr(ur,ln.task),"message"===e&&Es(tr(Om,"appWindow.parentAppWindow.addEventListener"),"messageForChild",t)}}const km="v2";function Mm(e){if(zr(ur,ln.content),!xm())throw mn;if(!e||!kn(e))throw{errorCode:Le.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return vc(tr(km,"secondaryBrowser.openUrl"),"secondaryBrowser.open",e.toString())}function xm(){return!(!zr(ur)||!ur.supports.secondaryBrowser)}const Nm="v1";function Dm(e,t){if(!t)throw new Error("[location.getLocation] Callback cannot be null");if(zr(ur,ln.content,ln.task),!qr(Xe))throw{errorCode:Le.OLD_PLATFORM};if(!e)throw{errorCode:Le.INVALID_ARGUMENTS};if(!Lm())throw mn;Ic(tr(Nm,"location.getLocation"),"location.getLocation",[e],t)}function Um(e,t){if(!t)throw new Error("[location.showLocation] Callback cannot be null");if(zr(ur,ln.content,ln.task),!qr(Xe))throw{errorCode:Le.OLD_PLATFORM};if(!e)throw{errorCode:Le.INVALID_ARGUMENTS};if(!Lm())throw mn;Ic(tr(Nm,"location.showLocation"),"location.showLocation",[e],t)}function Lm(){return!(!zr(ur)||!ur.supports.location)}const Hm="v1";function _m(e){zr(ur,ln.sidePanel),e.contentUrl&&new URL(e.contentUrl),Ic(tr(Hm,"meeting.appShareButton.setOptions"),"meeting.appShareButton.setOptions",[e])}var Vm=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Bm="v1";var Wm,jm,zm,qm,$m,Gm;function Jm(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");zr(ur,ln.sidePanel,ln.meetingStage),Ic(tr(Bm,"meeting.getIncomingClientAudioState"),"getIncomingClientAudioState",e)}function Km(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");zr(ur,ln.sidePanel,ln.meetingStage),Ic(tr(Bm,"meeting.toggleIncomingClientAudio"),"toggleIncomingClientAudio",e)}function Qm(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");zr(ur,ln.sidePanel,ln.meetingStage,ln.settings,ln.content),Ic(tr(Bm,"meeting.getMeetingDetails"),"meeting.getMeetingDetails",e)}function Zm(){var e,t,n;return Vm(this,void 0,void 0,(function*(){let r;zr(ur,ln.sidePanel,ln.meetingStage,ln.settings,ln.content);try{const e=!0;r=yield vc(tr("v2","meeting.getMeetingDetailsVerbose"),"meeting.getMeetingDetails",e)}catch(t){throw new Error(null===(e=null==t?void 0:t.errorCode)||void 0===e?void 0:e.toString())}if(((null===(t=r.details)||void 0===t?void 0:t.type)==qm.GroupCall||(null===(n=r.details)||void 0===n?void 0:n.type)==qm.OneOnOneCall)&&!r.details.originalCallerInfo)throw new Error(Le.NOT_SUPPORTED_ON_PLATFORM.toString());return r}))}function Xm(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");zr(ur,ln.sidePanel,ln.meetingStage,ln.task),Ic(tr(Bm,"meeting.getAuthenticationTokenForAnonymousUser"),"meeting.getAuthenticationTokenForAnonymousUser",e)}function Ym(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");zr(ur,ln.sidePanel),Ic(tr(Bm,"meeting.getLiveStreamState"),"meeting.getLiveStreamState",e)}function ev(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");zr(ur,ln.sidePanel),Ic(tr(Bm,"meeting.requestStartLiveStreaming"),"meeting.requestStartLiveStreaming",[t,n],e)}function tv(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");zr(ur,ln.sidePanel),Ic(tr(Bm,"meeting.requestStopLiveStreaming"),"meeting.requestStopLiveStreaming",e)}function nv(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");zr(ur,ln.sidePanel),Es(tr(Bm,"meeting.registerLiveStreamChangedHandler"),"meeting.liveStreamChanged",e)}function rv(e,t,n={sharingProtocol:$m.Collaborative}){if(!e)throw new Error("[share app content to stage] Callback cannot be null");zr(ur,ln.sidePanel,ln.meetingStage),Ic(tr(Bm,"meeting.shareAppContentToStage"),"meeting.shareAppContentToStage",[t,n],e)}function ov(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");zr(ur,ln.sidePanel,ln.meetingStage),Ic(tr(Bm,"meeting.getAppContentStageSharingCapabilities"),"meeting.getAppContentStageSharingCapabilities",e)}function iv(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");zr(ur,ln.sidePanel,ln.meetingStage),Ic(tr(Bm,"meeting.stopSharingAppContentToStage"),"meeting.stopSharingAppContentToStage",e)}function av(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");zr(ur,ln.sidePanel,ln.meetingStage),Ic(tr(Bm,"meeting.getAppContentStageSharingState"),"meeting.getAppContentStageSharingState",e)}function sv(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");zr(ur,ln.sidePanel,ln.meetingStage),Es(tr(Bm,"meeting.registerSpeakingStateChangeHandler"),"meeting.speakingStateChanged",e)}function cv(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");zr(ur,ln.sidePanel,ln.meetingStage),Es(tr(Bm,"meeting.registerRaiseHandStateChangedHandler"),"meeting.raiseHandStateChanged",e)}function uv(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");zr(ur,ln.sidePanel,ln.meetingStage),Es(tr(Bm,"meeting.registerMeetingReactionReceivedHandler"),"meeting.meetingReactionReceived",e)}function lv(e){if(void 0===(null==e?void 0:e.joinWebUrl)||null===(null==e?void 0:e.joinWebUrl))return Promise.reject(new Error("Invalid joinMeetingParams"));zr(ur);const t={joinWebUrl:e.joinWebUrl.href,source:e.source||Gm.Other};return vc(tr("v2","meeting.joinMeeting"),"meeting.joinMeeting",t)}function dv(e,t){if(!t)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");zr(ur,ln.sidePanel,ln.meetingStage),e.isAppHandlingAudio?fv(e,t):pv(e,t)}function fv(e,t){Ic(tr(Bm,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],((n,r)=>{if(n&&null!=r)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(n)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${n.errorCode} ${n.message}`);if("boolean"!=typeof r)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Es(tr(Bm,"meeting.registerMicStateChangeHandler"),"meeting.micStateChanged",(t=>Vm(this,void 0,void 0,(function*(){try{const n=yield e.micMuteStateChangedCallback(t);hv(n,n.isMicMuted===t.isMicMuted?Wm.HostInitiated:Wm.AppDeclinedToChange)}catch(e){hv(t,Wm.AppFailedToChange)}}))));Es(tr(Bm,"meeting.registerAudioDeviceSelectionChangedHandler"),"meeting.audioDeviceSelectionChanged",(t=>{var n;null===(n=e.audioDeviceSelectionChangedCallback)||void 0===n||n.call(e,t)})),t(r)}))}function pv(e,t){Ic(tr(Bm,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],((e,n)=>{if(e&&null!=n)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${e.errorCode} ${e.message}`);if("boolean"!=typeof n)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Ps("meeting.micStateChanged")&&Is("meeting.micStateChanged"),Ps("meeting.audioDeviceSelectionChanged")&&Is("meeting.audioDeviceSelectionChanged"),t(n)}))}function gv(e){hv(e,Wm.AppInitiated)}function hv(e,t){zr(ur,ln.sidePanel,ln.meetingStage),Ic(tr(Bm,"meeting.setMicStateWithReason"),"meeting.updateMicState",[e,t])}!function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"}(Wm||(Wm={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(jm||(jm={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(zm||(zm={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(qm||(qm={})),function(e){e.Collaborative="Collaborative",e.ScreenShare="ScreenShare"}($m||($m={})),function(e){e.M365CalendarGridContextMenu="m365_calendar_grid_context_menu",e.M365CalendarGridPeek="m365_calendar_grid_peek",e.M365CalendarGridEventCardJoinButton="m365_calendar_grid_event_card_join_button",e.M365CalendarFormRibbonJoinButton="m365_calendar_form_ribbon_join_button",e.M365CalendarFormJoinTeamsMeetingButton="m365_calendar_form_join_teams_meeting_button",e.Other="other"}(Gm||(Gm={}));const mv="v1",vv="v2";function wv(e,t){let n,r,o="";"function"==typeof e?(n=e,r=t,o=tr(mv,"monetization.openPurchaseExperience")):(r=e,o=tr(vv,"monetization.openPurchaseExperience"));return zr(ur,ln.content),Tn((()=>new Promise((e=>{if(!Cv())throw mn;e(vc(o,"monetization.openPurchaseExperience",r))}))),n)}function Cv(){return!(!zr(ur)||!ur.supports.monetization)}const yv="v2";function Sv(e){return new Promise((t=>{if(zr(ur,ln.content),!Av())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");t(hc(tr(yv,"calendar.openCalendarItem"),"calendar.openCalendarItem",e))}))}function bv(e){return new Promise((t=>{if(zr(ur,ln.content),!Av())throw new Error("Not supported");const n=tr(yv,"calendar.composeMeeting");ur.isLegacyTeams?t(hc(n,"executeDeepLink",oh(e.attendees,e.startTime,e.endTime,e.subject,e.content))):t(hc(n,"calendar.composeMeeting",e))}))}function Av(){return!(!zr(ur)||!ur.supports.calendar)}const Ev="v2";function Iv(e){e&&0!==e.length&&e.forEach((e=>{Vg(e)}))}function Pv(e){if(!e.handoffId||0==e.handoffId.trim().length||""===e.handoffId.trim())throw new Error("handoffId should not be null or empty string.");const t=e.composeMailParams;t.type===Nv.New&&(Iv(t.toRecipients),Iv(t.ccRecipients),Iv(t.bccRecipients))}function Tv(e){if(zr(ur,ln.content),!Ov())throw new Error("Not supported");return Pv(e),Sc("mail.handoff.composeMail",[new Rv(e)],tr(Ev,"mail.handoff.composeMail"))}function Ov(){return!!(zr(ur)&&ur.supports.mail&&ur.supports.mail.handoff)}class Rv{constructor(e){this.composeMailParamsWithHandoff=e}serialize(){return this.composeMailParamsWithHandoff}}const Fv="v2";function kv(e){return new Promise((t=>{if(zr(ur,ln.content),!xv())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");t(hc(tr(Fv,"mail.openMailItem"),"mail.openMailItem",e))}))}function Mv(e){return new Promise((t=>{if(zr(ur,ln.content),!xv())throw new Error("Not supported");t(hc(tr(Fv,"mail.composeMail"),"mail.composeMail",e))}))}function xv(){return!(!zr(ur)||!ur.supports.mail)}var Nv;!function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(Nv||(Nv={}));const Dv="v2";function Uv(){if(!Kn.printCapabilityEnabled){if(zr(ur),!Wv())throw mn;Kn.printCapabilityEnabled=!0,document.addEventListener("keydown",(e=>{(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(Lv(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}}function Lv(){Nn().print()}function Hv(e){_v(tr(Dv,"teamsAPIs_registerOnLoadHandler"),e,(()=>{if(!oo(e)&&!Wv())throw mn}))}function _v(e,t,n){!oo(t)&&zr(ur),!oo(t)&&n&&n(),Ns(e,t)}function Vv(e){Bv(tr(Dv,"teamsAPIs_registerBeforeUnloadHandler"),e,(()=>{if(!oo(e)&&!Wv())throw mn}))}function Bv(e,t,n){!oo(t)&&zr(ur),!oo(t)&&n&&n(),Ls(e,t)}function Wv(){return!(!zr(ur)||!ur.supports.teamsCore)}const jv="v1",zv="v2";function qv(e,t){let n,r;zr(ur,ln.content,ln.task,ln.settings);let o="";return"function"==typeof e?([n,r]=[e,t],o=tr(jv,"people.selectPeople")):(r=e,o=tr(zv,"people.selectPeople")),In($v,n,o,r)}function $v(e,t){return new Promise((n=>{if(!qr(Ye))throw{errorCode:Le.OLD_PLATFORM};if(!Vh(t))throw{errorCode:Le.INVALID_ARGUMENTS};if(!Gv())throw mn;n(vc(e,"people.selectPeople",t))}))}function Gv(){return!(!zr(ur)||!ur.supports.people)}function Jv(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?Kv(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}function Kv(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}const Qv="v2";function Zv(e){return zr(ur,ln.content),new Promise((t=>{const[n,r]=Jv(e);if(!n)throw{errorCode:Le.INVALID_ARGUMENTS,message:r};const o={modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}};t(vc(tr(Qv,"profile.showProfile"),"profile.showProfile",o))}))}function Xv(){return!(!zr(ur)||!ur.supports.profile)}const Yv="v2",ew="search.queryChange",tw="search.queryClose",nw="search.queryExecute";function rw(e,t,n){if(zr(ur,ln.content),!iw())throw mn;Es(tr(Yv,"search.registerOnClosedHandler"),tw,e),Es(tr(Yv,"search.registerOnExecutedHandler"),nw,t),n&&Es(tr(Yv,"search.registerOnChangeHandler"),ew,n)}function ow(){if(zr(ur,ln.content),!iw())throw mn;Ic(tr(Yv,"search.unregisterHandlers"),"search.unregister"),Is(ew),Is(tw),Is(nw)}function iw(){return!(!zr(ur)||!ur.supports.search)}function aw(){return new Promise((e=>{if(zr(ur,ln.content),!iw())throw new Error("Not supported");e(hc(tr(Yv,"search.closeSearch"),"search.closeSearch"))}))}var sw=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const cw="v2";function uw(){return sw(this,void 0,void 0,(function*(){if(zr(ur,ln.sidePanel,ln.meetingStage),!lw())throw mn;return yield vc(tr(cw,"sharing.history.getContent"),"sharing.history.getContent")}))}function lw(){var e;return zr(ur)&&void 0!==(null===(e=ur.supports.sharing)||void 0===e?void 0:e.history)}const dw="v1",fw="v2",pw={shareWebContent:"sharing.shareWebContent"};function gw(e,t){try{mw(e),vw(e),ww(e)}catch(e){return Pn((()=>Promise.reject(e)),t)}zr(ur,ln.content,ln.sidePanel,ln.task,ln.stage,ln.meetingStage);return Pn(hw,t,tr(t?dw:fw,"sharing.shareWebContent"),e)}function hw(e,t){return new Promise((n=>{if(!Cw())throw mn;n(vc(e,pw.shareWebContent,t))}))}function mw(e){if(!(e&&e.content&&e.content.length)){throw{errorCode:Le.INVALID_ARGUMENTS,message:"Shared content is missing"}}}function vw(e){let t;if(e.content.some((e=>!e.type)))throw t={errorCode:Le.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"},t;if(e.content.some((t=>t.type!==e.content[0].type)))throw t={errorCode:Le.INVALID_ARGUMENTS,message:"Shared content must be of the same type"},t}function ww(e){let t;if("URL"!==e.content[0].type)throw t={errorCode:Le.INVALID_ARGUMENTS,message:"Content type is unsupported"},t;if(e.content.some((e=>!e.url)))throw t={errorCode:Le.INVALID_ARGUMENTS,message:"URLs are required for URL content types"},t}function Cw(){return!(!zr(ur)||!ur.supports.sharing)}const yw="v2";function Sw(){return new Promise((e=>{if(zr(ur,ln.content),!bw())throw mn;e(vc(tr(yw,"stageView.self.close"),"stageView.self.close"))}))}function bw(){var e;return zr(ur)&&void 0!==(null===(e=ur.supports.stageView)||void 0===e?void 0:e.self)}const Aw="v2";var Ew;function Iw(e){return new Promise((t=>{if(zr(ur,ln.content),!Pw())throw mn;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");t(vc(tr(Aw,"stageView.open"),"stageView.open",e))}))}function Pw(){return!(!zr(ur)||!ur.supports.stageView)}!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(Ew||(Ew={}));const Tw=10;var Ow=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Rw="v2";function Fw(e){return Ow(this,void 0,void 0,(function*(){zr(ur,ln.content,ln.task),xw(),Nw(e);const t=yield vc(tr(Rw,"visualMedia.image.captureImages"),"visualMedia.image.captureImages",e);return Dw(e.maxVisualMediaCount,t),t}))}function kw(e){return Ow(this,void 0,void 0,(function*(){zr(ur,ln.content,ln.task),xw(),Nw(e);const t=yield vc(tr(Rw,"visualMedia.image.retrieveImages"),"visualMedia.image.retrieveImages",e);return Dw(e.maxVisualMediaCount,t),t}))}function Mw(){return!!(zr(ur)&&ur.supports.visualMedia&&ur.supports.visualMedia.image&&ur.supports.permissions)}function xw(){if(!Mw())throw mn}function Nw(e){if(!e||e.maxVisualMediaCount>Tw||e.maxVisualMediaCount<1)throw Cn}function Dw(e,t){if(t.length>e)throw yn}const Uw="v2";var Lw,Hw;function _w(){if(zr(ur,ln.content,ln.task),!Mw())throw mn;const e=He.Media;return vc(tr(Uw,"visualMedia.hasPermission"),"permissions.has",e)}function Vw(){if(zr(ur,ln.content,ln.task),!Mw())throw mn;const e=He.Media;return vc(tr(Uw,"visualMedia.requestPermission"),"permissions.request",e)}!function(e){e[e.FrontOrRear=1]="FrontOrRear",e[e.FrontOnly=2]="FrontOnly",e[e.RearOnly=3]="RearOnly"}(Lw||(Lw={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(Hw||(Hw={}));var Bw=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let Ww=null;function jw(){return Bw(this,void 0,void 0,(function*(){return null===Ww&&(Ww=(yield Mo()).app.host.name),Ww}))}var zw=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function qw(){return zw(this,void 0,void 0,(function*(){if(zr(ur),!Gw())throw mn;return!(!ur.isLegacyTeams||Kn.hostClientType!==cn.android&&Kn.hostClientType!==cn.ios&&Kn.hostClientType!==cn.ipados&&Kn.hostClientType!==cn.visionOS||(yield $w())!==un.teams)||(yield gc(tr("v2","webStorage.isWebStorageClearedOnUserLogOut"),"webStorage.isWebStorageClearedOnUserLogOut"))}))}function $w(){return zw(this,void 0,void 0,(function*(){return jw()}))}function Gw(){return zr(ur)&&void 0!==ur.supports.webStorage}const Jw="v2";var Kw;function Qw(e){const t=tr(Jw,"call.startCall");return new Promise((n=>{var r;if(zr(ur,ln.content,ln.task),!Zw())throw mn;if(!ur.isLegacyTeams)return Ic(t,"call.startCall",[e],n);n(gc(t,"executeDeepLink",rh(e.targets,null===(r=e.requestedModalities)||void 0===r?void 0:r.includes(Kw.Video),e.source)).then((e=>{if(!e)throw new Error(ft);return e})))}))}function Zw(){return!(!zr(ur)||!ur.supports.call)}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(Kw||(Kw={}));const Xw="v1";function Yw(){Yi(tr(Xw,"appInitialization.notifyAppLoaded"))}function eC(){Ic(tr(Xw,"appInitialization.notifySuccess"),Eo.Success,[Er])}function tC(e){ta(tr(Xw,"appInitialization.notifyFailure"),e)}function nC(e){ea(tr(Xw,"appInitialization.notifyExpectedFailure"),e)}const rC=er("thirdPartyCloudStorage"),oC="v2";class iC{constructor(e,t){this.fileType=e,this.assembleAttachment=t}}let aC=[],sC=null,cC=!0,uC=null;function lC(e,t){if(!t)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(e&&""!==e){if(zr(ur,ln.content,ln.task),!fC())throw mn;if(uC)throw uC=null,new Error("getDragAndDropFiles cannot be called twice");uC=t,cC=!0,Ic(tr(oC,"thirdPartyCloudStorage.getDragAndDropFiles"),"thirdPartyCloudStorage.getDragAndDropFiles",[e],dC)}else{t([],{errorCode:Le.INVALID_ARGUMENTS})}}function dC(e){if(uC)if(e&&e.error)uC([],e.error),uC=null;else if(e&&e.fileChunk)try{cC||0!==e.fileChunk.chunkSequence||(rC("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),cC=!0,uC([],{errorCode:Le.INTERNAL_ERROR,message:"error occurred while receiving data"}),aC=[],uC=null);const t=Fh(e.fileChunk,e.fileType);if(t?(sC||(sC=new iC(e.fileType,[])),sC.assembleAttachment.push(t)):(rC(`Received a null assemble attachment for when decoding chunk sequence ${e.fileChunk.chunkSequence}; not including the chunk in the assembled file.`),uC?uC([],{errorCode:Le.INTERNAL_ERROR,message:"error occurred while receiving data"}):uC=null,aC=[],uC=null,cC=!0),cC=e.fileChunk.endOfFile,e.fileChunk.endOfFile&&sC){const t=Rh(sC.assembleAttachment,sC.fileType);if(t){const n=new File([t],e.fileName,{type:t.type});aC.push(n)}e.isLastFile&&uC&&(uC(aC,e.error),aC=[],uC=null,cC=!0),sC=null}}catch(e){uC&&(uC([],{errorCode:Le.INTERNAL_ERROR,message:e}),aC=[],uC=null,cC=!0)}else uC([],{errorCode:Le.INTERNAL_ERROR,message:"data received is null"}),aC=[],uC=null,cC=!0}function fC(){return!(!zr(ur)||!ur.supports.thirdPartyCloudStorage)}const pC="v1";function gC(e,t){Xi(tr(pC,"initialize"),t).then((()=>{e&&e()}))}function hC(){Uv()}function mC(){Lv()}function vC(e){jr(),Ic(tr(pC,"getContext"),"getContext",(t=>{t.frameContext||(t.frameContext=Kn.frameContext),e(t)}))}function wC(e){sa(tr(pC,"registerOnThemeChangeHandlerHelper"),e)}function CC(e){Ts(tr(pC,"registerFullScreenHandler"),"fullScreenChange",e,[])}function yC(e){Ts(tr(pC,"registerAppButtonClickHandler"),"appButtonClick",e,[ln.content])}function SC(e){Ts(tr(pC,"registerAppButtonHoverEnterHandler"),"appButtonHoverEnter",e,[ln.content])}function bC(e){Ts(tr(pC,"registerAppButtonHoverLeaveHandler"),"appButtonHoverLeave",e,[ln.content])}function AC(e){Oa(tr(pC,"registerBackButtonHandler"),e)}function EC(e){_v(tr(pC,"registerOnLoadHandler"),e)}function IC(e){Bv(tr(pC,"registerBeforeUnloadHandler"),e)}function PC(e){Ts(tr(pC,"registerFocusEnterHandler"),"focusEnter",e,[])}function TC(e){Ts(tr(pC,"registerChangeSettingsHandler"),"changeSettings",e,[ln.content])}function OC(e,t){zr(ur),rs(tr(pC,"getTabInstances"),t).then((t=>{e(t)}))}function RC(e,t){zr(ur),os(tr(pC,"getMruTabInstances"),t).then((t=>{e(t)}))}function FC(e){is(tr(pC,"shareDeepLink"),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function kC(e,t){zr(ur,ln.content,ln.sidePanel,ln.settings,ln.task,ln.stage,ln.meetingStage);const n=null!=t?t:Sn();ua(tr(pC,"executeDeepLink"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function MC(e){as(tr(pC,"setFrameContext"),e)}function xC(e,t,n){Xi(tr(pC,"initializeWithFrameContext"),n).then((()=>t&&t())),as(tr(pC,"setFrameContext"),e)}const NC="v1";function DC(e){ns(tr(NC,"navigation.returnFocus"),e)}function UC(e,t){zr(ur);const n=null!=t?t:Sn();ts(tr(NC,"navigation.navigateToTab"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function LC(e,t){zr(ur,ln.content,ln.sidePanel,ln.settings,ln.remove,ln.task,ln.stage,ln.meetingStage);const n=null!=t?t:Sn();Ya(tr(NC,"navigation.navigateCrossDomain"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function HC(e){zr(ur);const t=null!=e?e:Sn();es(tr(NC,"navigation.navigateBack")).then((()=>{t(!0)})).catch((e=>{t(!1,e.message)}))}const _C="v1";function VC(e){ss(tr(_C,"settings.setValidityState"),e)}function BC(e){zr(ur,ln.content,ln.settings,ln.remove,ln.sidePanel),cs(tr(_C,"settings.getSettings")).then((t=>{e(t)}))}function WC(e,t){zr(ur,ln.content,ln.settings,ln.sidePanel);const n=null!=t?t:Sn();us(tr(_C,"settings.setSettings"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function jC(e){Hi(tr(_C,"settings.registerOnSaveHandler"),e)}function zC(e){Vi(tr(_C,"settings.registerOnRemoveHandler"),e)}var qC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const $C="v1";function GC(e,t){const n=tr($C,"tasks.startTask"),r=t?e=>{var n,r;return t(null!==(n=e.err)&&void 0!==n?n:"",null!==(r=e.result)&&void 0!==r?r:"")}:void 0;return void 0===e.card&&void 0===e.url||e.card?(zr(ur,ln.content,ln.sidePanel,ln.meetingStage),Ic(n,"tasks.startTask",[e],t)):void 0!==e.completionBotId?ii(n,ZC(e),r):oi(n,QC(e),r),new Rm}function JC(e){e=XC(e);const{width:t,height:n}=e,r=qC(e,["width","height"]);if(Object.keys(r).length)throw new Error("resize requires a TaskInfo argument containing only width and height");ri(tr($C,"tasks.updateTask"),e)}function KC(e,t){ai(tr($C,"tasks.submitTask"),e,t)}function QC(e){if(void 0===e.url)throw new Error("url property of taskInfo object can't be undefined");return{url:e.url,size:{height:e.height?e.height:gn.Small,width:e.width?e.width:gn.Small},title:e.title,fallbackUrl:e.fallbackUrl}}function ZC(e){if(void 0===e.url||void 0===e.completionBotId)throw new Error(`Both url ${e.url} and completionBotId ${e.completionBotId} are required for bot url dialog. At least one is undefined.`);return{url:e.url,size:{height:e.height?e.height:gn.Small,width:e.width?e.width:gn.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}function XC(e){return e.height=e.height?e.height:gn.Small,e.width=e.width?e.width:gn.Small,e}const YC="v2";var ey,ty;function ny(){return!(!zr(ur,ln.meetingStage,ln.sidePanel,ln.content)||!ur.supports.interactive)}!function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"}(ey||(ey={})),function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"}(ty||(ty={}));class ry{getFluidTenantInfo(){return oy(),new Promise((e=>{e(vc(tr(YC,"interactive.getFluidTenantInfo"),"interactive.getFluidTenantInfo"))}))}getFluidToken(e){return oy(),new Promise((t=>{t(vc(tr(YC,"interactive.getFluidToken"),"interactive.getFluidToken",e))}))}getFluidContainerId(){return oy(),new Promise((e=>{e(vc(tr(YC,"interactive.getFluidContainerId"),"interactive.getFluidContainerId"))}))}setFluidContainerId(e){return oy(),new Promise((t=>{t(vc(tr(YC,"interactive.setFluidContainerId"),"interactive.setFluidContainerId",e))}))}getNtpTime(){return oy(),new Promise((e=>{e(vc(tr(YC,"interactive.getNtpTime"),"interactive.getNtpTime"))}))}registerClientId(e){return oy(),new Promise((t=>{t(vc(tr(YC,"interactive.registerClientId"),"interactive.registerClientId",e))}))}getClientRoles(e){return oy(),new Promise((t=>{t(vc(tr(YC,"interactive.getClientRoles"),"interactive.getClientRoles",e))}))}getClientInfo(e){return oy(),new Promise((t=>{t(vc(tr(YC,"interactive.getClientInfo"),"interactive.getClientInfo",e))}))}static create(){return oy(),new ry}}function oy(){if(!ny())throw new Error("LiveShareHost Not supported")}var iy=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function ay(e){try{return e.cartItems=sy(e.cartItems),e}catch(e){throw new Error("Error deserializing cart")}}function sy(e){return e.map((e=>{if(e.imageURL){const t=new URL(e.imageURL);e.imageURL=t}return e.accessories&&(e.accessories=sy(e.accessories)),e}))}const cy=e=>{try{return e.map((e=>{const{imageURL:t,accessories:n}=e,r=iy(e,["imageURL","accessories"]),o=Object.assign({},r);return t&&(o.imageURL=t.href),n&&(o.accessories=cy(n)),o}))}catch(e){throw new Error("Error serializing cart items")}};function uy(e){if(!Array.isArray(e)||0===e.length)throw new Error("cartItems must be a non-empty array");for(const t of e)dy(t),ly(t.accessories)}function ly(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw new Error("CartItem.accessories must be a non-empty array");for(const t of e){if(t.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");dy(t)}}}function dy(e){if(!e.id)throw new Error("cartItem.id must not be empty");if(!e.name)throw new Error("cartItem.name must not be empty");py(e.price),gy(e.quantity)}function fy(e){if(null!=e){if(!e)throw new Error("id must not be empty");if(!1===sn(e))throw new Error("id must be a valid UUID")}}function py(e){if("number"!=typeof e||e<0)throw new Error(`price ${e} must be a number not less than 0`);if(parseFloat(e.toFixed(3))!==e)throw new Error(`price ${e} must have at most 3 decimal places`)}function gy(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw new Error(`quantity ${e} must be an integer greater than 0`)}function hy(e){if(!Object.values(Cy).includes(e))throw new Error(`cartStatus ${e} is not valid`)}const my="v2",vy={majorVersion:1,minorVersion:1};var wy,Cy;function yy(){if(zr(ur,ln.content,ln.task),!Ey())throw mn;return vc(tr(my,"marketplace.getCart"),"marketplace.getCart",vy).then(ay)}function Sy(e){if(zr(ur,ln.content,ln.task),!Ey())throw mn;if(!e)throw new Error("addOrUpdateCartItemsParams must be provided");return fy(null==e?void 0:e.cartId),uy(null==e?void 0:e.cartItems),vc(tr(my,"marketplace.addOrUpdateCartItems"),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},e),{cartItems:cy(e.cartItems),cartVersion:vy})).then(ay)}function by(e){if(zr(ur,ln.content,ln.task),!Ey())throw mn;if(!e)throw new Error("removeCartItemsParams must be provided");if(fy(null==e?void 0:e.cartId),!Array.isArray(null==e?void 0:e.cartItemIds)||0===(null==e?void 0:e.cartItemIds.length))throw new Error("cartItemIds must be a non-empty array");return vc(tr(my,"marketplace.removeCartItems"),"marketplace.removeCartItems",Object.assign(Object.assign({},e),{cartVersion:vy})).then(ay)}function Ay(e){if(zr(ur,ln.content,ln.task),!Ey())throw mn;if(!e)throw new Error("updateCartStatusParams must be provided");return fy(null==e?void 0:e.cartId),hy(null==e?void 0:e.cartStatus),vc(tr(my,"marketplace.updateCartStatus"),"marketplace.updateCartStatus",Object.assign(Object.assign({},e),{cartVersion:vy})).then(ay)}function Ey(){return!(!zr(ur)||!ur.supports.marketplace)}!function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"}(wy||(wy={})),function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"}(Cy||(Cy={}));var Iy=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};class Py{constructor(e){this.event=e}serialize(){return{altKey:this.event.altKey,bubbles:this.event.bubbles,cancelBubble:this.event.cancelBubble,charCode:this.event.charCode,code:this.event.code,composed:this.event.composed,ctrlKey:this.event.ctrlKey,defaultPrevented:this.event.defaultPrevented,detail:this.event.detail,eventPhase:this.event.eventPhase,isComposing:this.event.isComposing,isTrusted:this.event.isTrusted,key:this.event.key,keyCode:this.event.keyCode,location:this.event.location,metaKey:this.event.metaKey,repeat:this.event.repeat,returnValue:this.event.returnValue,shiftKey:this.event.shiftKey,timeStamp:this.event.timeStamp,type:this.event.type,which:this.event.which}}}function Ty(e){return e.toLowerCase().split("+").sort().join("+")}function Oy(e){return[e.ctrlKey&&"ctrl",e.shiftKey&&"shift",e.altKey&&"alt",e.metaKey&&"meta",e.key.toLowerCase()].filter(Boolean).sort().join("+")}function Ry(e){return e.ctrlKey||e.shiftKey||e.altKey||e.metaKey||!!e.key&&"escape"===e.key.toLowerCase()}function Fy(e,t){if(Ry(t)){const n=Oy(t);if(e.has(n))return{matchedShortcut:n,isOverridable:Dy.has(n)}}return{matchedShortcut:void 0,isOverridable:!1}}function ky(e){Uy.clear(),e.shortcuts.forEach((e=>{Uy.add(Ty(e))})),Dy.clear(),e.overridableShortcuts.forEach((e=>{Dy.add(Ty(e))}))}class My extends Gi{validate(e){return e&&Array.isArray(e.shortcuts)&&Array.isArray(e.overridableShortcuts)}deserialize(e){return e}}function xy(e){Es(tr("v2","shortcutRelay.hostShortcutChanged"),"shortcutRelay.hostShortcutChanged",e)}function Ny(e){if(e.target.closest(`[${jy}]`))return;const{matchedShortcut:t,isOverridable:n}=Fy(Uy,e);if(!t)return;if(n&&Ly){if(Ly(e,{matchedShortcut:t}))return}Sc("shortcutRelay.forwardShortcutEvent",[new Py(e)],tr("v2","shortcutRelay.forwardShortcutEvent")),e.preventDefault(),e.stopImmediatePropagation()}const Dy=new Set,Uy=new Set;let Ly,Hy=!1;function _y(e){if(!Wy())throw mn;const t=Ly;return Ly=e,t}function Vy(){if(!Wy())throw mn;Hy=!1,Uy.clear(),Dy.clear(),Ly=void 0,document.removeEventListener("keydown",Ny,{capture:!0})}function By(){return Iy(this,void 0,void 0,(function*(){if(!Wy())throw mn;ky(yield yc("shortcutRelay.getHostShortcuts",[],new My,tr("v2","shortcutRelay.getHostShortcuts"))),Hy||document.addEventListener("keydown",Ny,{capture:!0}),Hy=!0,xy((e=>{ky(e)}))}))}function Wy(){return!(!zr(ur)||!ur.supports.shortcutRelay)}const jy="data-disable-shortcuts-forwarding"})(),r})()));
//# sourceMappingURL=MicrosoftTeams.min.js.map